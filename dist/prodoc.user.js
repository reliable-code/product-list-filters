// ==UserScript==
// @name         Prodoc enhancer
// @description  Hide doctor cards by filter, enhance doctor page
// @grant        GM_addValueChangeListener
// @grant        GM_setValue
// @grant        GM_getValue
// @match        https://prodoctorov.ru/*
// @namespace    https://github.com/reliable-code/product-list-filters
// @version      2.0.73897347
// @icon         https://www.google.com/s2/favicons?sz=64&domain=prodoctorov.ru
// @author       reliable-code
// ==/UserScript==

(()=>{(()=>{"use strict";var ee={5467:(S,h,e)=>{e.d(h,{E2:()=>i});var d=e(9928);function i(C,m={},t=null){const o=(0,d.Sw)(m,t);return o.append(C),o}function u(C,m=null,t={},o={}){const r=createActionLink(C,m,o);return i(r,t)}function a(C,m=null,t=null,o={},r={}){const v=createActionLinkWithIcon(C,t,m,r);return i(v,o)}},9928:(S,h,e)=>{e.d(h,{S:()=>C,Sw:()=>L,d:()=>o,kU:()=>u,o5:()=>a});var d=e(4921),i=e(5539);function u(l,c,O){const p=m(l,"text",c);return p.value=O,p}function a(l,c,O,p,b,s){const g=m(l,"number",c);return g.value=O,g.step=p,g.min=b,g.max=s,g}function C(l,c,O){const p=m(l,"checkbox",c);return p.checked=O,p}function m(l={},c=null,O=null){const p=E("input",l);return c&&(p.type=c),O&&(p.addEventListener("keyup",(0,d.sg)(O,200)),p.addEventListener("change",(0,d.sg)(O,100))),p}function t(l={},c=null){return E("span",l,c)}function o(l={},c=null,O=null){const p=E("a",l,c);return O&&(p.href=O),p}function r(l,c=null,O={}){O.cursor||="pointer";const p=o(O,c);return l&&p.addEventListener("click",l),p}function v(l,c,O=null,p={}){p.display||="inline-flex",p.alignItems||="center",p.gap||="0.25em";const b=r(l,O,p);return b.prepend(n(c)),b}function N(l={},c=null,O=null){const p=E("button",l,c);return O&&p.addEventListener("click",O),p}function L(l={},c=null){return E("div",l,c)}function F(l={}){return E("i",l)}function n(l,c={}){c.width||="1em",c.height||="1em",c.paddingBottom||="1px";const O=F(c);return O.setAttribute("data-lucide",l),O}function E(l,c,O=null){if(typeof c!="object"||c===null)throw new TypeError("styles should be an object");const p=document.createElement(l);return(0,i.ZM)(p,c),O&&(p.innerHTML=O),p}},573:(S,h,e)=>{e.d(h,{Fi:()=>u,YA:()=>t,fI:()=>a});var d=e(4214);function i(n,E=document){return!!E.querySelector(n)}function u(n,E=document,l=!1){const c=E.querySelector(n);return l&&!c&&console.log(`No element found for selector: ${n}`),c}function a(n,E=document,l=!1){const c=E.querySelectorAll(n);return l&&!c.length&&console.log(`No elements found for selector: ${n}`),c}function C(n,E,l){return[...n.querySelectorAll(E)].find(c=>c.textContent.trim().includes(l))}function m(n,E,l=!1,c=!1){const O=u(E,n,!0);return t(O,l,c)}function t(n,E=!1,l=!1,c=null){if(!n)return c===null?(console.log("No element found"),null):c;const O=n.innerText;return v(O,E,l)}function o(n,E,l=!1){const c=n[E];return t(c,l)}function r(n,E=!1,l=!1){const c=n.textContent;return v(c,E,l)}function v(n,E,l){E&&(n=(0,d.zr)(n)),l&&(n=n.replace(",","."));const c=Number(n);return Number.isNaN(c)?(console.log(`Invalid number: ${n}`),0):c}function N(n){return[...n.childNodes].find(E=>E.nodeType===Node.TEXT_NODE)}function L(n){const E=l=>l.nodeType===Node.TEXT_NODE&&l.textContent.trim()!==""?[l]:[...l.childNodes].flatMap(E);return E(n)}function F(n){return normalizeSpacing(n.textContent)}},5539:(S,h,e)=>{e.d(h,{Bt:()=>i,UC:()=>t,WH:()=>d,ZM:()=>M,kl:()=>C});function d(f,R){f.parentNode.insertBefore(R,f.nextSibling)}function i(f){f.style.display="none"}function u(f){v(f),i(f)}function a(f){f.intersectionObserver||runOnceOnIntersection(f,()=>i(f))}function C(f){f.style.display=""}function m(f){const R=r(f);f.style.display=R}function t(f,R){R?i(f):C(f)}function o(f,R){R?a(f):(clearIntersectionObserver(f),C(f))}function r(f){return v(f),f.defaultDisplay}function v(f){if(f.defaultDisplay)return;const{display:R}=getComputedStyle(f);f.defaultDisplay=R}function N(){return{show:[],hide:[]}}function L(f,R,_){f?R.hide.push(_):R.show.push(_)}function F(f){f.show.forEach(C),f.hide.forEach(i)}function n(f,R,_=.3){R?l(f,_):E(f)}function E(f){f.style.opacity=""}function l(f,R=.3){f.style.opacity=R}function c(f){f.style.order=""}function O(f,R){f.style.order=R}function p(f,R){f.style.background=R}function b(f,R){const _=getFirstElement(R);if(!_)return;const U=createLink();U.href=f,_.parentNode.append(U),U.append(_)}function s(f,R){const _=getFirstElement(R);_&&g(f,_)}function g(f,R){const _=createLink();_.href=f,_.append(...R.childNodes),R.append(_)}function I(){const f=getURLQueryParam("scrollTo");if(!f)return;const R=document.getElementById(f);R?R.scrollIntoView():console.log(`Element with ID "${f}" was not found.`)}function x(f,R="custom-global-style"){let _=document.getElementById(R);_||(_=document.createElement("style"),_.id=R,_.type="text/css",document.head.appendChild(_)),_.textContent=f}function M(f,R){Object.assign(f.style,R)}function G(f){return Object.entries(f).map(([R,_])=>`${R.replace(/([A-Z])/g,"-$1").toLowerCase()}: ${_};`).join(" ")}function j(f){return f?f.split(";").filter(R=>R.trim()!=="").reduce((R,_)=>{const[U,K]=_.split(":").map(P=>P.trim()),w=U.replace(/-([a-z])/g,(P,k)=>k.toUpperCase());return R[w]=K,R},{}):{}}function H(f,R,_="text/plain"){const U=new Blob([f],{type:_}),K=URL.createObjectURL(U),w=document.createElement("a");w.href=K,w.download=R,document.body.appendChild(w),w.click(),document.body.removeChild(w),requestAnimationFrame(()=>URL.revokeObjectURL(K))}},4921:(S,h,e)=>{e.d(h,{sg:()=>a,xk:()=>d});function d(t,o,r=null){const v=t.querySelector(o);return v?Promise.resolve(v):new Promise(N=>{const L=new MutationObserver(n);L.observe(t,{childList:!0,subtree:!0});let F;r&&(F=setTimeout(()=>{L.disconnect(),console.log(`No element found for selector: ${o}`),N(null)},r));function n(){const E=t.querySelector(o);E&&(F&&clearTimeout(F),L.disconnect(),N(E))}})}function i(t,o){return t.querySelector(o)?new Promise(v=>{const N=new MutationObserver(L);N.observe(t,{childList:!0,subtree:!0});function L(){t.querySelector(o)||(N.disconnect(),v())}}):Promise.resolve()}function u(t,o=400){return new Promise(r=>{let v;const N=new MutationObserver(()=>{clearTimeout(v),L()});function L(){v=setTimeout(()=>{N.disconnect(),r()},o)}L(),N.observe(t,{childList:!0,subtree:!0})})}function a(t,o=250){let r;return(...v)=>{clearTimeout(r),r=setTimeout(()=>t(...v),o)}}function C(t,o){const r=new IntersectionObserver(v=>{v.forEach(N=>{N.isIntersecting&&(o(),m(t))})});t.intersectionObserver=r,r.observe(t)}function m(t){t.intersectionObserver&&(t.intersectionObserver.disconnect(),t.intersectionObserver=null)}},3829:(S,h,e)=>{e.d(h,{Ay:()=>i,JE:()=>a,iG:()=>C});var d=e(8355);function i(t,o){return!u(t,o)}function u(t,o){if(!o.value)return!0;const r=t.toLowerCase(),v=(0,d.R)(o),N=[],L=[];return v.forEach(F=>{if(F.startsWith("!")){const n=F.substring(1);n&&L.push(n)}else N.push(F)}),N.every(F=>r.includes(F))&&L.every(F=>!r.includes(F))}function a(t,o){return o.value!=null&&t<o.value}function C(t,o){return o.value!=null&&t>o.value}function m(t,o){return o.value&&t!==o.value}},4521:(S,h,e)=>{e.d(h,{z:()=>i});var d=e(3048);function i(u,a=null){return{createGlobalFilter(C,m=null,t=u){return d.V.create(C,m,t)},createSectionFilter(C,m=null,t=u){if(!a)throw new Error("sectionId must be provided to use createSectionFilter.");return d.V.createWithCompositeKey(a,C,m,t)}}}},5884:(S,h,e)=>{e.d(h,{Hw:()=>C,Nm:()=>u,nW:()=>a});var d=e(9928),i=e(5467);function u(m,t,o={},r={}){const v=(0,d.kU)(r,t.updateValueFromEvent,t.value);return(0,i.E2)(v,o,m)}function a(m,t,o,r,v,N={},L={}){const F=(0,d.o5)(L,t.updateValueFromEvent,t.value,o,r,v);return(0,i.E2)(F,N,m)}function C(m,t,o={},r={}){const v=(0,d.S)(r,t.updateValueFromEvent,t.value);return(0,i.E2)(v,o,m)}},7877:(S,h,e)=>{e.d(h,{E9:()=>i,FR:()=>a,HX:()=>u,X0:()=>C,pW:()=>b});var d=e(5884);function i(s,g={},I={}){return(0,d.Nm)("\u041F\u043E\u0438\u0441\u043A: ",s,g,I)}function u(s,g={},I={},x=.1,M=3){return(0,d.nW)("\u041C\u0438\u043D. \u0440\u0435\u0439\u0442\u0438\u043D\u0433: ",s,x,M,5,g,I)}function a(s,g={},I={},x=.1,M=3){return(0,d.nW)("\u041C\u0430\u043A\u0441. \u0440\u0435\u0439\u0442\u0438\u043D\u0433: ",s,x,M,5,g,I)}function C(s,g={},I={}){return t("\u041C\u0438\u043D. \u043E\u0442\u0437\u044B\u0432\u043E\u0432: ",s,g,I)}function m(s,g={},I={}){return t("\u041C\u0430\u043A\u0441. \u043E\u0442\u0437\u044B\u0432\u043E\u0432: ",s,g,I)}function t(s,g,I={},x={}){return(0,d.nW)(s,g,"1","1","999999",I,x)}function o(s,g={},I={}){return r("\u041C\u0438\u043D. \u0441\u043A\u0438\u0434\u043A\u0430: ",s,g,I)}function r(s,g,I={},x={}){return createNumberFilterControl(s,g,"5","0","100",I,x)}function v(s,g={},I={}){return createNumberFilterControl("\u041C\u0438\u043D. \u043A\u0435\u0448\u0431\u0435\u043A: ",s,"5","0","100",g,I)}function N(s,g,I={},x={},M="250"){return createNumberFilterControl(s,g,M,"0","1000000",I,x)}function L(s,g={},I={},x="25"){return N("\u041C\u0438\u043D. \u0446\u0435\u043D\u0430: ",s,g,I,x)}function F(s,g={},I={},x="25"){return N("\u041C\u0430\u043A\u0441. \u0446\u0435\u043D\u0430: ",s,g,I,x)}function n(s,g={},I={}){return E("\u041C\u0438\u043D. \u043B\u0430\u0438\u0306\u043A\u043E\u0432: ",s,g,I)}function E(s,g,I={},x={}){return createNumberFilterControl(s,g,"1","0","99999",I,x)}function l(s,g={},I={}){return createNumberFilterControl("\u041A\u043E\u043B\u043E\u043D\u043E\u043A: ",s,"1","2","6",g,I)}function c(s,g={},I={}){return createCheckboxFilterControl("\u0411\u0435\u0437 \u0440\u0435\u0439\u0442\u0438\u043D\u0433\u0430: ",s,g,I)}function O(s,g={},I={}){return createCheckboxFilterControl("\u0421 \u0444\u043E\u0442\u043E: ",s,g,I)}function p(s,g={},I={}){return createCheckboxFilterControl("\u041F\u0440\u043E\u0433\u0440\u0443\u0437\u043A\u0430: ",s,g,I)}function b(s,g={},I={}){return(0,d.Hw)("\u0412\u043A\u043B: ",s,g,I)}},8355:(S,h,e)=>{e.d(h,{R:()=>d,f:()=>i});function d(u){return u.value.toLowerCase().split(",").map(a=>a.trim()).filter(a=>a!=="")}function i(u){return d(u).filter(a=>!a.startsWith("!"))}},5213:(S,h,e)=>{e.d(h,{b:()=>u});var d=e(9928),i=e(573);function u(a,C,m=!1,t="customFiltersContainer"){let o=(0,i.Fi)(`#${t}`,a);if(o)if(m)o.remove();else return;o=(0,d.Sw)(),o.id=t,C(o,a)}},8200:(S,h,e)=>{e.d(h,{s:()=>d});function d(i){const{target:u}=i,{type:a}=u;switch(a){case"text":return`"${u.value}"`;case"number":return u.value;case"checkbox":return u.checked;default:return console.log(`Unknown input type: ${a}`),null}}},157:(S,h,e)=>{e.d(h,{Fg:()=>d,IC:()=>a,vx:()=>u});const d=window.GM_setValue,i=window.GM.setValue,u=window.GM_getValue,a=window.GM_addValueChangeListener},1870:(S,h,e)=>{e.d(h,{j:()=>d});class d{constructor(u,a){this.value=u,this.onChange=a}onChangeIfDefined=()=>{this.onChange&&this.onChange()}}},3048:(S,h,e)=>{e.d(h,{V:()=>C});var d=e(1870),i=e(8200),u=e(3976),a=e(157);class C extends d.j{constructor(t,o=null,r=null){super((0,a.vx)(t,o),r),this.storageKey=t,this.defaultValue=o}static create(t,o=null,r=null){return new C(t,o,r)}static createWithCompositeKey(t,o,r=null,v=null){const N=`${t}-${o}`;return new C(N,r,v)}updateValueFromEvent=t=>{const o=(0,i.s)(t),r=(0,u.$)(o);this.updateValue(r)};updateValue(t,o=!0){this.value!==t&&((0,a.Fg)(this.storageKey,t),this.value=t,o&&this.onChangeIfDefined())}clearValue(t=!1){this.updateValue(null,t)}resetValue(t=!1){this.updateValue(this.defaultValue,t)}}},3976:(S,h,e)=>{e.d(h,{$:()=>d});function d(i){return i===""?null:JSON.parse(i)}},4214:(S,h,e)=>{e.d(h,{$z:()=>d,zr:()=>i});function d(m){return m.replace(/\D/g,"")}function i(m){return m.replace(/[^\d.,-]/g,"")}function u(m){return m.replace(/\s/g,"")}function a(m){return m.charAt(0).toUpperCase()+m.slice(1)}function C(m){return m.replace(/\s+/g," ").trim()}},5406:(S,h,e)=>{e.d(h,{$F:()=>m,Fc:()=>d,bn:()=>i,z2:()=>v});function d(n,E="common",l=!1){const{pathname:c}=window.location;return i(c,n,E,l)}function i(n,E,l,c=!1){const p=n.split("/")[E]||l;return c&&console.log(`Pathname element: ${p}`),p}function u(n,E="common",l=!1){const c=d(n,"",l);return a(c,E,l)}function a(n,E,l){if(!n)return E;const c=n.split("-").at(-1);return l&&console.log(`Pathname element ending: ${c}`),c}function C(n,E,l="common",c=!1){const O=i(n,E,"",c);return a(O,l,c)}function m(n){return new URLSearchParams(window.location.search).get(n)}function t(n){return n.split("?")[0]}function o(n){return window.location.pathname.includes(n)}function r(n){return n.some(E=>o(E))}function v(n){return window.location.pathname.split("/").some(l=>l===n)}function N(n){try{const E=new URL(window.location.href);Object.entries(n).forEach(([l,c])=>{E.searchParams.set(l,c)}),window.location.href=E.toString()}catch(E){console.error("Failed to redirect:",E)}}function L(n,E){return function(...l){n.apply(this,l),E()}}function F(n,E){return async function(...l){n.apply(this,l),await E()}}},2524:(S,h,e)=>{e.d(h,{d5:()=>u,vX:()=>t,ft:()=>a});var d=e(157);class i{constructor(v=Date.now(),N=[]){this.lastCheckDate=v,this.reviewsData=N}updateLastCheckDate=()=>{this.lastCheckDate=Date.now()};static fromObject(v){const{lastCheckDate:N,reviewsData:L}=v;return new i(N,L)}}const u={LAST_DOCTOR_UPDATE:"last-doctor-update"};function a(r,v){const N=C(r),L=(0,d.vx)(N),F=m(L);F.reviewsData=v,F.updateLastCheckDate(),(0,d.Fg)(N,F),(0,d.Fg)(u.LAST_DOCTOR_UPDATE,Date.now())}function C(r){return`doctor-${r}`}function m(r){return r?i.fromObject(r):new i}function t(r){return o(r)?.reviewsData??null}function o(r){const v=C(r);return(0,d.vx)(v)}},1753:(S,h,e)=>{e.a(S,async(d,i)=>{try{var u=e(573),a=e(7858),C=e(4231),m=e(5406),t=e(5072);const r=(0,u.Fi)(".appointments_page");r?(0,C.$)(r):(0,m.z2)("otzivi")?await(0,t.N)():(0,m.z2)("vrach")&&(0,a.O)(),i()}catch(o){i(o)}},1)},7653:(S,h,e)=>{e.d(h,{NI:()=>r,z1:()=>L,Np:()=>l,pR:()=>F,sp:()=>O,rd:()=>c});var d=e(9928),i=e(573);const u={DOCTOR_CARD_NAME:'.b-doctor-intro__title-first-line [itemprop="name"]',DOCTOR_INTRO_LEFT:".b-doctor-intro__left-side",NAME_SPAN_HOLDER:".b-doctor-intro__title-first-line",NAME_SPAN:'[itemprop="name"]'};var a=e(8586),C=e(5406),m=e(4214);const t="additionalLinksAppended",o=["\u042F\u043D\u0434\u0435\u043A\u0441","\u041D\u0430\u041F\u043E\u043F\u0440\u0430\u0432\u043A\u0443","DocDoc","\u0414\u043E\u043A\u0442\u0443"];function r(p,b){b.classList.contains(t)||(o.forEach(s=>{v(p,b,s)}),b.classList.add(t))}function v(p,b,s){const g=N(p,s),I=(0,d.d)({},s,g),x=document.createElement("br");b.append(x,I)}function N(p,b){const s=`${p} ${b}`;return`https://www.google.com/search?q=${encodeURIComponent(s)}&btnI`}function L(){const p=(0,i.Fi)(u.DOCTOR_CARD_NAME,document,!0);if(!p)return;const b=p.innerText.trim(),s=(0,d.Sw)();s.style.textAlign="center",(0,i.Fi)(u.DOCTOR_INTRO_LEFT).append(s),r(b,s)}function F(p,b,s=!1){const g=(0,d.Sw)(a.r.REVIEWS_INFO);s&&(g.style.justifyContent="center"),g.classList.add("v-application");const I=(0,d.Sw)(a.r.REVIEWS_INFO_BLOCK);return I.style.height=s?"10px":"23px",I.append(g),p.slice(s?1:0).forEach(x=>{const{category:M,title:G,count:j,bgClassSuffix:H}=x,f=`${b}?rates_category=${M}`,R=s?j:`${G} ${j}`,_=(0,d.d)(a.r.REVIEW_INFO,R,f);_.classList=n(H),g.append(_),s&&E(_,G)}),I}function n(p){return`text-caption ui-kit-color-text px-2 py-1 rounded ui-kit-bg-bg-${p}`}function E(p,b){let s=null;p.addEventListener("mouseenter",()=>{s=(0,d.Sw)(a.r.REVIEW_INFO_TOOLTIP,b),document.body.appendChild(s);const g=p.getBoundingClientRect();s.style.left=`${(g.left+g.right)/2-s.offsetWidth/2+window.scrollX+2}px`,s.style.top=`${g.top+window.scrollY-s.offsetHeight-4}px`}),p.addEventListener("mouseleave",()=>{s&&(s.remove(),s=null)})}function l(p){const b=(0,i.Fi)(u.NAME_SPAN_HOLDER,document,!0);if(!b)return;const s=(0,i.Fi)(u.NAME_SPAN,b,!0);s&&s.append(p)}function c(){const p=(0,C.Fc)(3,"unknown");return(0,m.$z)(p)}function O(p){const b=(0,C.bn)(p,5,"");return(0,m.$z)(b)}},8586:(S,h,e)=>{e.d(h,{r:()=>i});const d={INPUT:{border:"1px solid #c7d3d9",borderRadius:"10px",padding:"7px 14px",marginLeft:"6px"}},i={FILTERS_CONTAINER:{display:"flex",gridGap:"15px",flexFlow:"wrap"},CONTROL:{display:"flex",alignItems:"center"},TEXT_INPUT:{...d.INPUT,width:"195px"},NUMBER_INPUT:{...d.INPUT,width:"70px"},CHECKBOX_INPUT:{...d.INPUT,width:"20px",height:"20px"},REVIEWS_INFO:{gridGap:"6px"},REVIEWS_INFO_BLOCK:{marginTop:"5px"},REVIEW_INFO:{textDecoration:"none",flexShrink:0},REVIEW_INFO_TOOLTIP:{position:"absolute",backgroundColor:"#333",color:"#fff",padding:"4px 8px",borderRadius:"8px",fontSize:"12px",zIndex:"1000",pointerEvents:"none",boxShadow:"0 2px 4px rgba(0, 0, 0, 0.2)"}}},4231:(S,h,e)=>{e.d(h,{$:()=>M});var d=e(5406),i=e(573),u=e(5539),a=e(3829),C=e(7653),m=e(5213),t=e(5884),o=e(7877);const r={LIST_HEADER:".h2_rating",DOCTOR_FILTERS:".doctor-filters",DOCTOR_CARD:".b-doctor-card",DOCTOR_CARD_NAME:".b-doctor-card__name-surname",PROFILE_CARD:".b-profile-card",REVIEWS_LINK:":scope > a",EXPERIENCE_WRAP:".b-doctor-card__experience .mr-2 .ui-text",SPEC_WRAP:".b-doctor-card__spec",CLINIC_CONTAINER:"div.b-doctor-card__lpu-select",CLINIC_WRAP:".b-select__trigger-main-text"};var v=e(4521),N=e(2524),L=e(4921),F=e(157),n=e(8586);const E=(0,d.Fc)(2),{createGlobalFilter:l,createSectionFilter:c}=(0,v.z)(H,E),O=c("spec-filter"),p=c("clinic-filter"),b=c("min-reviews-filter",10),s=c("min-experience-filter",5,K),g=c("max-experience-filter",40),I=l("filter-enabled",!0),x={doctorCardsCache:new WeakMap};function M(w){K(),G();const P=(0,i.Fi)(r.DOCTOR_FILTERS);(0,m.b)(P,j),H(),(0,F.IC)(N.d5.LAST_DOCTOR_UPDATE,H),new MutationObserver((0,L.sg)(H)).observe(w,{childList:!0})}function G(){const w=(0,i.Fi)(r.LIST_HEADER);w&&w.remove()}function j(w,P){(0,u.ZM)(w,n.r.FILTERS_CONTAINER),w.style.marginTop="6px";const k=(0,t.Nm)("\u0421\u043F\u0435\u0446\u0438\u0430\u043B\u0438\u0437\u0430\u0446\u0438\u044F:",O,n.r.CONTROL,n.r.TEXT_INPUT),z=(0,t.Nm)("\u041A\u043B\u0438\u043D\u0438\u043A\u0430:",p,n.r.CONTROL,n.r.TEXT_INPUT),T=(0,o.X0)(b,n.r.CONTROL,n.r.NUMBER_INPUT),D=(0,t.nW)("\u041C\u0438\u043D. \u043E\u043F\u044B\u0442: ",s,"1","0","100",n.r.CONTROL,n.r.NUMBER_INPUT),A=(0,t.nW)("\u041C\u0430\u043A\u0441. \u043E\u043F\u044B\u0442: ",g,"1","0","100",n.r.CONTROL,n.r.NUMBER_INPUT),y=(0,o.pW)(I,n.r.CONTROL,n.r.CHECKBOX_INPUT);w.append(k,z,T,D,A,y),P.append(w)}function H(){(0,i.fI)(r.DOCTOR_CARD).forEach(f)}function f(w){if(!I.value){(0,u.kl)(w);return}let P=x.doctorCardsCache.get(w);if(!P){const z=(0,i.Fi)(r.PROFILE_CARD,w),T=(0,i.Fi)(r.REVIEWS_LINK,z),D=(0,i.Fi)(r.EXPERIENCE_WRAP,w);if(!T||!D){(0,u.Bt)(w);return}const y=(0,i.Fi)(r.SPEC_WRAP,w,!0).innerText.trim(),W=(0,i.Fi)(r.CLINIC_CONTAINER,w,!0),B=(0,i.Fi)(r.CLINIC_WRAP,W,!0).innerText.trim(),V=(0,i.YA)(T,!0),X=(0,i.YA)(D,!0),Y=R(T);T.href=Y,(0,C.NI)(_(w),z),P={specInfo:y,clinicName:B,reviewsLinkNumber:V,experienceNumber:X,reviewsLink:T,reviewInfoAppended:!1},x.doctorCardsCache.set(w,P)}U(P);const k=(0,a.Ay)(P.specInfo,O)||(0,a.Ay)(P.clinicName,p)||(0,a.JE)(P.reviewsLinkNumber,b)||(0,a.JE)(P.experienceNumber,s)||(0,a.iG)(P.experienceNumber,g);(0,u.UC)(w,k)}function R(w){return w.href.replace(/\/#otzivi$/,"/otzivi/")}function _(w){return(0,i.Fi)(r.DOCTOR_CARD_NAME,w,!0).innerText}function U(w){if(w.reviewInfoAppended)return;const{reviewsLink:P}=w,k=P.href,z=(0,N.vX)((0,C.sp)(k));if(!z)return;const T=(0,C.pR)(z,k,!0);(0,u.WH)(P,T),w.reviewInfoAppended=!0}function K(){if(!s.value)return;const w=new URL(window.location.href);+w.searchParams.get("experience")!==s.value&&(w.searchParams.set("experience",s.value),window.location.href=w.toString())}},7858:(S,h,e)=>{e.d(h,{O:()=>m});var d=e(573),i=e(9928),u=e(7653);const a={DOCTOR_DETAILS:".b-doctor-details__toc",REVIEWS_FILTER:".reviews-filter:not(.b-reviews-page__filter)",NAME_SPAN_HOLDER:".b-doctor-intro__title-first-line",NAME_SPAN:'[itemprop="name"]',REVIEWS_FILTER_SPAN:":scope > span",DOCTOR_CONTACTS:"#doctor-contacts"};var C=e(2524);function m(){(0,u.z1)(),o();const r=(0,C.vX)((0,u.rd)());if(!r)return;const v=(0,u.pR)(r,t());(0,u.Np)(v)}function t(){const{location:r}=window;return`${r.origin}${r.pathname}otzivi/`}function o(){if(!(0,d.Fi)(a.DOCTOR_CONTACTS))return;const v=[...(0,d.fI)(a.DOCTOR_DETAILS)].pop();if(!v)return;v.style.position="sticky",v.style.top="16px";const N=(0,i.Sw)({},"\u041C\u0435\u0441\u0442\u043E \u0440\u0430\u0431\u043E\u0442\u044B");N.classList.add("b-doctor-details__toc-title");const L=(0,i.d)({},null,"#doctor-contacts");L.classList.add("b-doctor-details__toc-item"),L.append(N),v.insertBefore(L,v.firstChild)}},5072:(S,h,e)=>{e.d(h,{N:()=>f});var d=e(7653);const i={CONTROLS_CONTAINER:".vue-review-filter",REVIEWS:".b-review-card",REVIEW_TEXT_WRAP:".b-review-card__comment",REVIEW_RATING_WRAP:".review-card-tooltips__stars > .ui-text",FILTER_CHIP:'[data-qa="reviews_filter_chip"]',FILTER_LIST:'[data-qa="reviews_filter_list"]',FILTER_LIST_ITEM:'[data-qa^="reviews_filter_list_item"]',FILTER_TITLE_WRAP:'[data-qa="reviews_filter_title"]',FILTER_COUNT_WRAP:'[data-qa="reviews_filter_amount"]',REVIEWS_CONTAINER:"#rating"};var u=e(573),a=e(4921),C=e(5406),m=e(2524),t=e(4521),o=e(5213),r=e(8586),v=e(7877),N=e(5539);function L(T,D){T.forEach(A=>F(D,A))}function F(T,D){if(!D)return;const A=new RegExp(`(${D})`,"gi"),y=document.createTreeWalker(T,NodeFilter.SHOW_TEXT,null);let W=y.nextNode();const $=[];for(;W;){const{textContent:B}=W;if(A.test(B)){const V=document.createDocumentFragment();let X=0;B.replace(A,(Y,ne,Z)=>{Z>X&&V.appendChild(document.createTextNode(B.slice(X,Z)));const J=document.createElement("span");J.className="highlightedSubstring",J.style.backgroundColor="yellow",J.textContent=Y,V.appendChild(J),X=Z+Y.length}),X<B.length&&V.appendChild(document.createTextNode(B.slice(X))),$.push({node:W,fragment:V})}W=y.nextNode()}$.forEach(({node:B,fragment:V})=>{B.parentNode.replaceChild(V,B)})}function n(T){(0,u.fI)(".highlightedSubstring",T).forEach(A=>{const{parentNode:y}=A;A.replaceWith(A.textContent),y.normalize()})}var E=e(8355);function l(T,D){const A=(0,E.f)(T);L(A,D)}function c(T,D){const A=getIncludedSearchStrings(T);D.forEach(y=>highlightSubstrings(A,y))}var O=e(3829),p=e(9928);function b(T={}){return(0,p.Sw)(T,"|")}function s(T={},D=75,A="customFiltersContainer"){const y=document.getElementById(A);if(!y)return console.log(`Element with id="${A}" not found.`),null;const W=createButton(T,`${arrowUpIcon}\u041A \u0444\u0438\u043B\u044C\u0442\u0440\u0430\u043C`);return W.addEventListener("mouseenter",()=>{W.style.filter="brightness(0.9)"}),W.addEventListener("mouseleave",()=>{W.style.filter="brightness(1)"}),W.addEventListener("click",()=>{const $=y.getBoundingClientRect();window.scrollTo({top:$.top+window.scrollY-D})}),new IntersectionObserver(([$])=>{W.style.display=$.isIntersecting?"none":"flex"},{threshold:.5}).observe(y),W}function g(T,D={}){const A=s(D);A&&T.appendChild(A)}const{createGlobalFilter:I}=(0,t.z)(_),x=I("reviews-text-filter"),M=I("reviews-min-rating-filter"),G=I("reviews-max-rating-filter"),j=I("reviews-filter-enabled",!0),H={reviewCardsCache:new Map};async function f(){(0,d.z1)();const T=await(0,a.xk)(document,i.CONTROLS_CONTAINER);(0,o.b)(T,R),_();const D=await w();(0,m.ft)((0,d.rd)(),D);const A=(0,d.pR)(D,k());(0,d.Np)(A),(0,C.$F)("rates_category")&&z()}function R(T,D){(0,N.ZM)(T,r.r.FILTERS_CONTAINER),T.style.marginTop="12px";const A=(0,v.E9)(x,r.r.CONTROL,r.r.TEXT_INPUT),y=(0,v.HX)(M,r.r.CONTROL,r.r.NUMBER_INPUT,1,1),W=(0,v.FR)(G,r.r.CONTROL,r.r.NUMBER_INPUT,1,1),$=b(r.r.CONTROL),B=(0,v.pW)(j,r.r.CONTROL,r.r.CHECKBOX_INPUT);T.append(A,y,W,$,B),D.append(T)}function _(){(0,u.fI)(i.REVIEWS).forEach(U)}function U(T){if(!j.value){(0,N.kl)(T);return}n(T);let D=H.reviewCardsCache.get(T);if(!D){const y=(0,u.Fi)(i.REVIEW_TEXT_WRAP,T),W=(0,u.Fi)(i.REVIEW_RATING_WRAP,T);if(!y){(0,N.Bt)(T);return}D={reviewTextWrap:y,reviewText:y.innerText,rating:W&&(0,u.YA)(W)},H.reviewCardsCache.set(T,D)}x.value&&l(x,D.reviewTextWrap);const A=(0,O.Ay)(D.reviewText,x)||K(D.rating);(0,N.UC)(T,A)}function K(T){return T?(0,O.JE)(T,M)||(0,O.iG)(T,G):!1}async function w(){const T=(0,u.Fi)(i.FILTER_CHIP);T.click();const D=await(0,a.xk)(document,i.FILTER_LIST),A=[...(0,u.fI)(i.FILTER_LIST_ITEM,D)].map(y=>{const W=y.getAttribute("data-qa");if(!W)return null;const $=W.replace("reviews_filter_list_item_",""),B=(0,u.Fi)(i.FILTER_TITLE_WRAP,y).textContent.trim(),V=(0,u.Fi)(i.FILTER_COUNT_WRAP,y),X=(0,u.YA)(V,!0),Y=P(V.classList);return{category:$,title:B,count:X,bgClassSuffix:Y}});return T.click(),A}function P(T){const D=T.value.match(/ui-kit-bg-bg-(\w+)/);return D?D[1]:null}function k(){const{location:T}=window;return`${T.origin}${T.pathname}`}function z(){(0,u.Fi)(i.REVIEWS_CONTAINER).scrollIntoView({behavior:"smooth"})}}},q={};function Q(S){var h=q[S];if(h!==void 0)return h.exports;var e=q[S]={exports:{}};return ee[S](e,e.exports,Q),e.exports}(()=>{var S=typeof Symbol=="function"?Symbol("webpack queues"):"__webpack_queues__",h=typeof Symbol=="function"?Symbol("webpack exports"):"__webpack_exports__",e=typeof Symbol=="function"?Symbol("webpack error"):"__webpack_error__",d=u=>{u&&u.d<1&&(u.d=1,u.forEach(a=>a.r--),u.forEach(a=>a.r--?a.r++:a()))},i=u=>u.map(a=>{if(a!==null&&typeof a=="object"){if(a[S])return a;if(a.then){var C=[];C.d=0,a.then(o=>{m[h]=o,d(C)},o=>{m[e]=o,d(C)});var m={};return m[S]=o=>o(C),m}}var t={};return t[S]=o=>{},t[h]=a,t});Q.a=(u,a,C)=>{var m;C&&((m=[]).d=-1);var t=new Set,o=u.exports,r,v,N,L=new Promise((F,n)=>{N=n,v=F});L[h]=o,L[S]=F=>(m&&F(m),t.forEach(F),L.catch(n=>{})),u.exports=L,a(F=>{r=i(F);var n,E=()=>r.map(c=>{if(c[e])throw c[e];return c[h]}),l=new Promise(c=>{n=()=>c(E),n.r=0;var O=p=>p!==m&&!t.has(p)&&(t.add(p),p&&!p.d&&(n.r++,p.push(n)));r.map(p=>p[S](O))});return n.r?l:E()},F=>(F?N(L[e]=F):v(o),d(m))),m&&m.d<0&&(m.d=0)}})(),Q.d=(S,h)=>{for(var e in h)Q.o(h,e)&&!Q.o(S,e)&&Object.defineProperty(S,e,{enumerable:!0,get:h[e]})},Q.o=(S,h)=>Object.prototype.hasOwnProperty.call(S,h);var te=Q(1753)})();})();
