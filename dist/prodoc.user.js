// ==UserScript==
// @name         Prodoc enhancer
// @description  Hide doctor cards by filter, enhance doctor page
// @grant        GM_addValueChangeListener
// @grant        GM_setValue
// @grant        GM_getValue
// @match        https://prodoctorov.ru/*
// @namespace    https://github.com/reliable-code/product-list-filters
// @version      2.0.73894053
// @icon         https://www.google.com/s2/favicons?sz=64&domain=prodoctorov.ru
// @author       reliable-code
// ==/UserScript==

(()=>{(()=>{"use strict";var ee={5467:(S,v,e)=>{e.d(v,{E2:()=>i});var l=e(9928);function i(T,m={},t=null){const o=(0,l.Sw)(m,t);return o.append(T),o}function u(T,m=null,t={},o={}){const r=createActionLink(T,m,o);return i(r,t)}function s(T,m=null,t=null,o={},r={}){const g=createActionLinkWithIcon(T,t,m,r);return i(g,o)}},9928:(S,v,e)=>{e.d(v,{S:()=>T,Sw:()=>L,d:()=>o,kU:()=>u,o5:()=>s});var l=e(4921),i=e(5539);function u(a,c,O){const p=m(a,"text",c);return p.value=O,p}function s(a,c,O,p,h,d){const C=m(a,"number",c);return C.value=O,C.step=p,C.min=h,C.max=d,C}function T(a,c,O){const p=m(a,"checkbox",c);return p.checked=O,p}function m(a={},c=null,O=null){const p=E("input",a);return c&&(p.type=c),O&&(p.addEventListener("keyup",(0,l.sg)(O,200)),p.addEventListener("change",(0,l.sg)(O,100))),p}function t(a={},c=null){return E("span",a,c)}function o(a={},c=null,O=null){const p=E("a",a,c);return O&&(p.href=O),p}function r(a,c=null,O={}){O.cursor||="pointer";const p=o(O,c);return a&&p.addEventListener("click",a),p}function g(a,c,O=null,p={}){p.display||="inline-flex",p.alignItems||="center",p.gap||="0.25em";const h=r(a,O,p);return h.prepend(n(c)),h}function N(a={},c=null,O=null){const p=E("button",a,c);return O&&p.addEventListener("click",O),p}function L(a={},c=null){return E("div",a,c)}function _(a={}){return E("i",a)}function n(a,c={}){c.width||="1em",c.height||="1em",c.paddingBottom||="1px";const O=_(c);return O.setAttribute("data-lucide",a),O}function E(a,c,O=null){if(typeof c!="object"||c===null)throw new TypeError("styles should be an object");const p=document.createElement(a);return(0,i.ZM)(p,c),O&&(p.innerHTML=O),p}},573:(S,v,e)=>{e.d(v,{Fi:()=>u,YA:()=>t,fI:()=>s});var l=e(4214);function i(n,E=document){return!!E.querySelector(n)}function u(n,E=document,a=!1){const c=E.querySelector(n);return a&&!c&&console.log(`No element found for selector: ${n}`),c}function s(n,E=document,a=!1){const c=E.querySelectorAll(n);return a&&!c.length&&console.log(`No elements found for selector: ${n}`),c}function T(n,E,a){return[...n.querySelectorAll(E)].find(c=>c.textContent.trim().includes(a))}function m(n,E,a=!1,c=!1){const O=u(E,n,!0);return t(O,a,c)}function t(n,E=!1,a=!1,c=null){if(!n)return c===null?(console.log("No element found"),null):c;const O=n.innerText;return g(O,E,a)}function o(n,E,a=!1){const c=n[E];return t(c,a)}function r(n,E=!1,a=!1){const c=n.textContent;return g(c,E,a)}function g(n,E,a){E&&(n=(0,l.zr)(n)),a&&(n=n.replace(",","."));const c=Number(n);return Number.isNaN(c)?(console.log(`Invalid number: ${n}`),0):c}function N(n){return[...n.childNodes].find(E=>E.nodeType===Node.TEXT_NODE)}function L(n){const E=a=>a.nodeType===Node.TEXT_NODE&&a.textContent.trim()!==""?[a]:[...a.childNodes].flatMap(E);return E(n)}function _(n){return normalizeSpacing(n.textContent)}},5539:(S,v,e)=>{e.d(v,{Bt:()=>i,UC:()=>t,WH:()=>l,ZM:()=>X,kl:()=>T});function l(f,R){f.parentNode.insertBefore(R,f.nextSibling)}function i(f){f.style.display="none"}function u(f){g(f),i(f)}function s(f){f.intersectionObserver||runOnceOnIntersection(f,()=>i(f))}function T(f){f.style.display=""}function m(f){const R=r(f);f.style.display=R}function t(f,R){R?i(f):T(f)}function o(f,R){R?s(f):(clearIntersectionObserver(f),T(f))}function r(f){return g(f),f.defaultDisplay}function g(f){if(f.defaultDisplay)return;const{display:R}=getComputedStyle(f);f.defaultDisplay=R}function N(){return{show:[],hide:[]}}function L(f,R,F){f?R.hide.push(F):R.show.push(F)}function _(f){f.show.forEach(T),f.hide.forEach(i)}function n(f,R,F=.3){R?a(f,F):E(f)}function E(f){f.style.opacity=""}function a(f,R=.3){f.style.opacity=R}function c(f){f.style.order=""}function O(f,R){f.style.order=R}function p(f,R){f.style.background=R}function h(f,R){const F=getFirstElement(R);if(!F)return;const B=createLink();B.href=f,F.parentNode.append(B),B.append(F)}function d(f,R){const F=getFirstElement(R);F&&C(f,F)}function C(f,R){const F=createLink();F.href=f,F.append(...R.childNodes),R.append(F)}function b(){const f=getURLQueryParam("scrollTo");if(!f)return;const R=document.getElementById(f);R?R.scrollIntoView():console.log(`Element with ID "${f}" was not found.`)}function W(f,R="custom-global-style"){let F=document.getElementById(R);F||(F=document.createElement("style"),F.id=R,F.type="text/css",document.head.appendChild(F)),F.textContent=f}function X(f,R){Object.assign(f.style,R)}function G(f){return Object.entries(f).map(([R,F])=>`${R.replace(/([A-Z])/g,"-$1").toLowerCase()}: ${F};`).join(" ")}function j(f){return f?f.split(";").filter(R=>R.trim()!=="").reduce((R,F)=>{const[B,H]=F.split(":").map(y=>y.trim()),w=B.replace(/-([a-z])/g,(y,U)=>U.toUpperCase());return R[w]=H,R},{}):{}}function V(f,R,F="text/plain"){const B=new Blob([f],{type:F}),H=URL.createObjectURL(B),w=document.createElement("a");w.href=H,w.download=R,document.body.appendChild(w),w.click(),document.body.removeChild(w),requestAnimationFrame(()=>URL.revokeObjectURL(H))}},4921:(S,v,e)=>{e.d(v,{sg:()=>s,xk:()=>l});function l(t,o,r=null){const g=t.querySelector(o);return g?Promise.resolve(g):new Promise(N=>{const L=new MutationObserver(n);L.observe(t,{childList:!0,subtree:!0});let _;r&&(_=setTimeout(()=>{L.disconnect(),console.log(`No element found for selector: ${o}`),N(null)},r));function n(){const E=t.querySelector(o);E&&(_&&clearTimeout(_),L.disconnect(),N(E))}})}function i(t,o){return t.querySelector(o)?new Promise(g=>{const N=new MutationObserver(L);N.observe(t,{childList:!0,subtree:!0});function L(){t.querySelector(o)||(N.disconnect(),g())}}):Promise.resolve()}function u(t,o=400){return new Promise(r=>{let g;const N=new MutationObserver(()=>{clearTimeout(g),L()});function L(){g=setTimeout(()=>{N.disconnect(),r()},o)}L(),N.observe(t,{childList:!0,subtree:!0})})}function s(t,o=250){let r;return(...g)=>{clearTimeout(r),r=setTimeout(()=>t(...g),o)}}function T(t,o){const r=new IntersectionObserver(g=>{g.forEach(N=>{N.isIntersecting&&(o(),m(t))})});t.intersectionObserver=r,r.observe(t)}function m(t){t.intersectionObserver&&(t.intersectionObserver.disconnect(),t.intersectionObserver=null)}},3829:(S,v,e)=>{e.d(v,{Ay:()=>i,JE:()=>s,iG:()=>T});var l=e(8355);function i(t,o){return!u(t,o)}function u(t,o){if(!o.value)return!0;const r=t.toLowerCase(),g=(0,l.R)(o),N=[],L=[];return g.forEach(_=>{if(_.startsWith("!")){const n=_.substring(1);n&&L.push(n)}else N.push(_)}),N.every(_=>r.includes(_))&&L.every(_=>!r.includes(_))}function s(t,o){return o.value!=null&&t<o.value}function T(t,o){return o.value!=null&&t>o.value}function m(t,o){return o.value&&t!==o.value}},4521:(S,v,e)=>{e.d(v,{z:()=>i});var l=e(3048);function i(u,s=null){return{createGlobalFilter(T,m=null,t=u){return l.V.create(T,m,t)},createSectionFilter(T,m=null,t=u){if(!s)throw new Error("sectionId must be provided to use createSectionFilter.");return l.V.createWithCompositeKey(s,T,m,t)}}}},5884:(S,v,e)=>{e.d(v,{Hw:()=>T,Nm:()=>u,nW:()=>s});var l=e(9928),i=e(5467);function u(m,t,o={},r={}){const g=(0,l.kU)(r,t.updateValueFromEvent,t.value);return(0,i.E2)(g,o,m)}function s(m,t,o,r,g,N={},L={}){const _=(0,l.o5)(L,t.updateValueFromEvent,t.value,o,r,g);return(0,i.E2)(_,N,m)}function T(m,t,o={},r={}){const g=(0,l.S)(r,t.updateValueFromEvent,t.value);return(0,i.E2)(g,o,m)}},7877:(S,v,e)=>{e.d(v,{E9:()=>i,FR:()=>s,HX:()=>u,X0:()=>T,pW:()=>p});var l=e(5884);function i(h,d={},C={}){return(0,l.Nm)("\u041F\u043E\u0438\u0441\u043A: ",h,d,C)}function u(h,d={},C={},b=.1,W=3){return(0,l.nW)("\u041C\u0438\u043D. \u0440\u0435\u0439\u0442\u0438\u043D\u0433: ",h,b,W,5,d,C)}function s(h,d={},C={},b=.1,W=3){return(0,l.nW)("\u041C\u0430\u043A\u0441. \u0440\u0435\u0439\u0442\u0438\u043D\u0433: ",h,b,W,5,d,C)}function T(h,d={},C={}){return t("\u041C\u0438\u043D. \u043E\u0442\u0437\u044B\u0432\u043E\u0432: ",h,d,C)}function m(h,d={},C={}){return t("\u041C\u0430\u043A\u0441. \u043E\u0442\u0437\u044B\u0432\u043E\u0432: ",h,d,C)}function t(h,d,C={},b={}){return(0,l.nW)(h,d,"1","1","999999",C,b)}function o(h,d={},C={}){return r("\u041C\u0438\u043D. \u0441\u043A\u0438\u0434\u043A\u0430: ",h,d,C)}function r(h,d,C={},b={}){return createNumberFilterControl(h,d,"5","0","100",C,b)}function g(h,d={},C={}){return createNumberFilterControl("\u041C\u0438\u043D. \u043A\u0435\u0448\u0431\u0435\u043A: ",h,"5","0","100",d,C)}function N(h,d,C={},b={},W="250"){return createNumberFilterControl(h,d,W,"0","1000000",C,b)}function L(h,d={},C={},b="25"){return N("\u041C\u0438\u043D. \u0446\u0435\u043D\u0430: ",h,d,C,b)}function _(h,d={},C={},b="25"){return N("\u041C\u0430\u043A\u0441. \u0446\u0435\u043D\u0430: ",h,d,C,b)}function n(h,d={},C={}){return E("\u041C\u0438\u043D. \u043B\u0430\u0438\u0306\u043A\u043E\u0432: ",h,d,C)}function E(h,d,C={},b={}){return createNumberFilterControl(h,d,"1","0","99999",C,b)}function a(h,d={},C={}){return createCheckboxFilterControl("\u0411\u0435\u0437 \u0440\u0435\u0439\u0442\u0438\u043D\u0433\u0430: ",h,d,C)}function c(h,d={},C={}){return createCheckboxFilterControl("\u0421 \u0444\u043E\u0442\u043E: ",h,d,C)}function O(h,d={},C={}){return createCheckboxFilterControl("\u041F\u0440\u043E\u0433\u0440\u0443\u0437\u043A\u0430: ",h,d,C)}function p(h,d={},C={}){return(0,l.Hw)("\u0412\u043A\u043B: ",h,d,C)}},8355:(S,v,e)=>{e.d(v,{R:()=>l,f:()=>i});function l(u){return u.value.toLowerCase().split(",").map(s=>s.trim()).filter(s=>s!=="")}function i(u){return l(u).filter(s=>!s.startsWith("!"))}},5213:(S,v,e)=>{e.d(v,{b:()=>u});var l=e(9928),i=e(573);function u(s,T,m=!1,t="customFiltersContainer"){let o=(0,i.Fi)(`#${t}`,s);if(o)if(m)o.remove();else return;o=(0,l.Sw)(),o.id=t,T(o,s)}},8200:(S,v,e)=>{e.d(v,{s:()=>l});function l(i){const{target:u}=i,{type:s}=u;switch(s){case"text":return`"${u.value}"`;case"number":return u.value;case"checkbox":return u.checked;default:return console.log(`Unknown input type: ${s}`),null}}},157:(S,v,e)=>{e.d(v,{Fg:()=>l,IC:()=>s,vx:()=>u});const l=window.GM_setValue,i=window.GM.setValue,u=window.GM_getValue,s=window.GM_addValueChangeListener},1870:(S,v,e)=>{e.d(v,{j:()=>l});class l{constructor(u,s){this.value=u,this.onChange=s}onChangeIfDefined=()=>{this.onChange&&this.onChange()}}},3048:(S,v,e)=>{e.d(v,{V:()=>T});var l=e(1870),i=e(8200),u=e(3976),s=e(157);class T extends l.j{constructor(t,o=null,r=null){super((0,s.vx)(t,o),r),this.storageKey=t,this.defaultValue=o}static create(t,o=null,r=null){return new T(t,o,r)}static createWithCompositeKey(t,o,r=null,g=null){const N=`${t}-${o}`;return new T(N,r,g)}updateValueFromEvent=t=>{const o=(0,i.s)(t),r=(0,u.$)(o);this.updateValue(r)};updateValue(t,o=!0){this.value!==t&&((0,s.Fg)(this.storageKey,t),this.value=t,o&&this.onChangeIfDefined())}clearValue(t=!1){this.updateValue(null,t)}resetValue(t=!1){this.updateValue(this.defaultValue,t)}}},3976:(S,v,e)=>{e.d(v,{$:()=>l});function l(i){return i===""?null:JSON.parse(i)}},4214:(S,v,e)=>{e.d(v,{$z:()=>l,zr:()=>i});function l(m){return m.replace(/\D/g,"")}function i(m){return m.replace(/[^\d.,-]/g,"")}function u(m){return m.replace(/\s/g,"")}function s(m){return m.charAt(0).toUpperCase()+m.slice(1)}function T(m){return m.replace(/\s+/g," ").trim()}},5406:(S,v,e)=>{e.d(v,{$F:()=>m,Fc:()=>l,bn:()=>i,z2:()=>g});function l(n,E="common",a=!1){const{pathname:c}=window.location;return i(c,n,E,a)}function i(n,E,a,c=!1){const p=n.split("/")[E]||a;return c&&console.log(`Pathname element: ${p}`),p}function u(n,E="common",a=!1){const c=l(n,"",a);return s(c,E,a)}function s(n,E,a){if(!n)return E;const c=n.split("-").at(-1);return a&&console.log(`Pathname element ending: ${c}`),c}function T(n,E,a="common",c=!1){const O=i(n,E,"",c);return s(O,a,c)}function m(n){return new URLSearchParams(window.location.search).get(n)}function t(n){return n.split("?")[0]}function o(n){return window.location.pathname.includes(n)}function r(n){return n.some(E=>o(E))}function g(n){return window.location.pathname.split("/").some(a=>a===n)}function N(n){try{const E=new URL(window.location.href);Object.entries(n).forEach(([a,c])=>{E.searchParams.set(a,c)}),window.location.href=E.toString()}catch(E){console.error("Failed to redirect:",E)}}function L(n,E){return function(...a){n.apply(this,a),E()}}function _(n,E){return async function(...a){n.apply(this,a),await E()}}},2524:(S,v,e)=>{e.d(v,{d5:()=>u,vX:()=>t,ft:()=>s});var l=e(157);class i{constructor(g=Date.now(),N=[]){this.lastCheckDate=g,this.reviewsData=N}updateLastCheckDate=()=>{this.lastCheckDate=Date.now()};static fromObject(g){const{lastCheckDate:N,reviewsData:L}=g;return new i(N,L)}}const u={LAST_DOCTOR_UPDATE:"last-doctor-update"};function s(r,g){const N=T(r),L=(0,l.vx)(N),_=m(L);_.reviewsData=g,_.updateLastCheckDate(),(0,l.Fg)(N,_),(0,l.Fg)(u.LAST_DOCTOR_UPDATE,Date.now())}function T(r){return`doctor-${r}`}function m(r){return r?i.fromObject(r):new i}function t(r){return o(r)?.reviewsData??null}function o(r){const g=T(r);return(0,l.vx)(g)}},1753:(S,v,e)=>{e.a(S,async(l,i)=>{try{var u=e(573),s=e(7858),T=e(4231),m=e(5406),t=e(5072);const r=(0,u.Fi)(".appointments_page");r?(0,T.$)(r):(0,m.z2)("otzivi")?await(0,t.N)():(0,m.z2)("vrach")&&(0,s.O)(),i()}catch(o){i(o)}},1)},7653:(S,v,e)=>{e.d(v,{NI:()=>r,z1:()=>L,Np:()=>a,pR:()=>_,sp:()=>O,rd:()=>c});var l=e(9928),i=e(573);const u={DOCTOR_CARD_NAME:'.b-doctor-intro__title-first-line [itemprop="name"]',DOCTOR_INTRO_LEFT:".b-doctor-intro__left-side",NAME_SPAN_HOLDER:".b-doctor-intro__title-first-line",NAME_SPAN:'[itemprop="name"]'};var s=e(8586),T=e(5406),m=e(4214);const t="additionalLinksAppended",o=["\u042F\u043D\u0434\u0435\u043A\u0441","\u041D\u0430\u041F\u043E\u043F\u0440\u0430\u0432\u043A\u0443","DocDoc","\u0414\u043E\u043A\u0442\u0443"];function r(p,h){h.classList.contains(t)||(o.forEach(d=>{g(p,h,d)}),h.classList.add(t))}function g(p,h,d){const C=N(p,d),b=(0,l.d)({},d,C),W=document.createElement("br");h.append(W,b)}function N(p,h){const d=`${p} ${h}`;return`https://www.google.com/search?q=${encodeURIComponent(d)}&btnI`}function L(){const p=(0,i.Fi)(u.DOCTOR_CARD_NAME,document,!0);if(!p)return;const h=p.innerText.trim(),d=(0,l.Sw)();d.style.textAlign="center",(0,i.Fi)(u.DOCTOR_INTRO_LEFT).append(d),r(h,d)}function _(p,h,d=!1){const C=(0,l.Sw)(s.r.REVIEWS_INFO);d&&(C.style.justifyContent="center"),C.classList.add("v-application");const b=(0,l.Sw)(s.r.REVIEWS_INFO_BLOCK);return b.style.height=d?"10px":"23px",b.append(C),p.slice(d?1:0).forEach(W=>{const{category:X,title:G,count:j,bgClassSuffix:V}=W,f=`${h}?rates_category=${X}`,R=d?j:`${G} ${j}`,F=(0,l.d)(s.r.REVIEW_INFO,R,f);F.classList=n(V),C.append(F),d&&E(F,G)}),b}function n(p){return`text-caption ui-kit-color-text px-2 py-1 rounded ui-kit-bg-bg-${p}`}function E(p,h){let d=null;p.addEventListener("mouseenter",()=>{d=(0,l.Sw)(s.r.REVIEW_INFO_TOOLTIP,h),document.body.appendChild(d);const C=p.getBoundingClientRect();d.style.left=`${(C.left+C.right)/2-d.offsetWidth/2+window.scrollX+2}px`,d.style.top=`${C.top+window.scrollY-d.offsetHeight-4}px`}),p.addEventListener("mouseleave",()=>{d&&(d.remove(),d=null)})}function a(p){const h=(0,i.Fi)(u.NAME_SPAN_HOLDER,document,!0);if(!h)return;const d=(0,i.Fi)(u.NAME_SPAN,h,!0);d&&d.append(p)}function c(){const p=(0,T.Fc)(3,"unknown");return(0,m.$z)(p)}function O(p){const h=(0,T.bn)(p,5,"");return(0,m.$z)(h)}},8586:(S,v,e)=>{e.d(v,{r:()=>i});const l={INPUT:{border:"1px solid #c7d3d9",borderRadius:"10px",padding:"7px 14px",marginLeft:"6px"}},i={FILTERS_CONTAINER:{display:"flex",gridGap:"15px",flexFlow:"wrap"},CONTROL:{display:"flex",alignItems:"center"},TEXT_INPUT:{...l.INPUT,width:"195px"},NUMBER_INPUT:{...l.INPUT,width:"70px"},CHECKBOX_INPUT:{...l.INPUT,width:"20px",height:"20px"},REVIEWS_INFO:{gridGap:"6px"},REVIEWS_INFO_BLOCK:{marginTop:"5px"},REVIEW_INFO:{textDecoration:"none",flexShrink:0},REVIEW_INFO_TOOLTIP:{position:"absolute",backgroundColor:"#333",color:"#fff",padding:"4px 8px",borderRadius:"8px",fontSize:"12px",zIndex:"1000",pointerEvents:"none",boxShadow:"0 2px 4px rgba(0, 0, 0, 0.2)"}}},4231:(S,v,e)=>{e.d(v,{$:()=>X});var l=e(5406),i=e(573),u=e(5539),s=e(3829),T=e(7653),m=e(5213),t=e(5884),o=e(7877);const r={LIST_HEADER:".h2_rating",DOCTOR_FILTERS:".doctor-filters",DOCTOR_CARD:".b-doctor-card",DOCTOR_CARD_NAME:".b-doctor-card__name-surname",PROFILE_CARD:".b-profile-card",REVIEWS_LINK:":scope > a",EXPERIENCE_WRAP:".b-doctor-card__experience .mr-2 .ui-text",SPEC_WRAP:".b-doctor-card__spec",CLINIC_CONTAINER:"div.b-doctor-card__lpu-select",CLINIC_WRAP:".b-select__trigger-main-text"};var g=e(4521),N=e(2524),L=e(4921),_=e(157),n=e(8586);const E=(0,l.Fc)(2),{createGlobalFilter:a,createSectionFilter:c}=(0,g.z)(V,E),O=c("spec-filter"),p=c("clinic-filter"),h=c("min-reviews-filter",10),d=c("min-experience-filter",5,H),C=c("max-experience-filter",40),b=a("filter-enabled",!0),W={doctorCardsCache:new WeakMap};function X(w){H(),G();const y=(0,i.Fi)(r.DOCTOR_FILTERS);(0,m.b)(y,j),V(),(0,_.IC)(N.d5.LAST_DOCTOR_UPDATE,V),new MutationObserver((0,L.sg)(V)).observe(w,{childList:!0})}function G(){const w=(0,i.Fi)(r.LIST_HEADER);w&&w.remove()}function j(w,y){(0,u.ZM)(w,n.r.FILTERS_CONTAINER),w.style.marginTop="6px";const U=(0,t.Nm)("\u0421\u043F\u0435\u0446\u0438\u0430\u043B\u0438\u0437\u0430\u0446\u0438\u044F:",O,n.r.CONTROL,n.r.TEXT_INPUT),K=(0,t.Nm)("\u041A\u043B\u0438\u043D\u0438\u043A\u0430:",p,n.r.CONTROL,n.r.TEXT_INPUT),I=(0,o.X0)(h,n.r.CONTROL,n.r.NUMBER_INPUT),D=(0,t.nW)("\u041C\u0438\u043D. \u043E\u043F\u044B\u0442: ",d,"1","0","100",n.r.CONTROL,n.r.NUMBER_INPUT),A=(0,t.nW)("\u041C\u0430\u043A\u0441. \u043E\u043F\u044B\u0442: ",C,"1","0","100",n.r.CONTROL,n.r.NUMBER_INPUT),x=(0,o.pW)(b,n.r.CONTROL,n.r.CHECKBOX_INPUT);w.append(U,K,I,D,A,x),y.append(w)}function V(){(0,i.fI)(r.DOCTOR_CARD).forEach(f)}function f(w){if(!b.value){(0,u.kl)(w);return}let y=W.doctorCardsCache.get(w);if(!y){const K=(0,i.Fi)(r.PROFILE_CARD,w),I=(0,i.Fi)(r.REVIEWS_LINK,K),D=(0,i.Fi)(r.EXPERIENCE_WRAP,w);if(!I||!D){(0,u.Bt)(w);return}const x=(0,i.Fi)(r.SPEC_WRAP,w,!0).innerText.trim(),P=(0,i.Fi)(r.CLINIC_CONTAINER,w,!0),M=(0,i.Fi)(r.CLINIC_WRAP,P,!0).innerText.trim(),$=(0,i.YA)(I,!0),z=(0,i.YA)(D,!0),Y=R(I);I.href=Y,(0,T.NI)(F(w),K),y={specInfo:x,clinicName:M,reviewsLinkNumber:$,experienceNumber:z,reviewsLink:I,reviewInfoAppended:!1},W.doctorCardsCache.set(w,y)}B(y);const U=(0,s.Ay)(y.specInfo,O)||(0,s.Ay)(y.clinicName,p)||(0,s.JE)(y.reviewsLinkNumber,h)||(0,s.JE)(y.experienceNumber,d)||(0,s.iG)(y.experienceNumber,C);(0,u.UC)(w,U)}function R(w){return w.href.replace(/\/#otzivi$/,"/otzivi/")}function F(w){return(0,i.Fi)(r.DOCTOR_CARD_NAME,w,!0).innerText}function B(w){if(w.reviewInfoAppended)return;const{reviewsLink:y}=w,U=y.href,K=(0,N.vX)((0,T.sp)(U));if(!K)return;const I=(0,T.pR)(K,U,!0);(0,u.WH)(y,I),w.reviewInfoAppended=!0}function H(){if(!d.value)return;const w=new URL(window.location.href);+w.searchParams.get("experience")!==d.value&&(w.searchParams.set("experience",d.value),window.location.href=w.toString())}},7858:(S,v,e)=>{e.d(v,{O:()=>m});var l=e(573),i=e(9928),u=e(7653);const s={DOCTOR_DETAILS:".b-doctor-details__toc",REVIEWS_FILTER:".reviews-filter:not(.b-reviews-page__filter)",NAME_SPAN_HOLDER:".b-doctor-intro__title-first-line",NAME_SPAN:'[itemprop="name"]',REVIEWS_FILTER_SPAN:":scope > span",DOCTOR_CONTACTS:"#doctor-contacts"};var T=e(2524);function m(){(0,u.z1)(),o();const r=(0,T.vX)((0,u.rd)());if(!r)return;const g=(0,u.pR)(r,t());(0,u.Np)(g)}function t(){const{location:r}=window;return`${r.origin}${r.pathname}otzivi/`}function o(){if(!(0,l.Fi)(s.DOCTOR_CONTACTS))return;const g=[...(0,l.fI)(s.DOCTOR_DETAILS)].pop();if(!g)return;g.style.position="sticky",g.style.top="16px";const N=(0,i.Sw)({},"\u041C\u0435\u0441\u0442\u043E \u0440\u0430\u0431\u043E\u0442\u044B");N.classList.add("b-doctor-details__toc-title");const L=(0,i.d)({},null,"#doctor-contacts");L.classList.add("b-doctor-details__toc-item"),L.append(N),g.insertBefore(L,g.firstChild)}},5072:(S,v,e)=>{e.d(v,{N:()=>f});var l=e(7653);const i={CONTROLS_CONTAINER:".vue-review-filter",REVIEWS:".b-review-card",REVIEW_TEXT_WRAP:".b-review-card__comment",REVIEW_RATING_WRAP:".review-card-tooltips__stars > .ui-text",FILTER_CHIP:'[data-qa="reviews_filter_chip"]',FILTER_LIST:'[data-qa="reviews_filter_list"]',FILTER_LIST_ITEM:'[data-qa^="reviews_filter_list_item"]',FILTER_TITLE_WRAP:'[data-qa="reviews_filter_title"]',FILTER_COUNT_WRAP:'[data-qa="reviews_filter_amount"]',REVIEWS_CONTAINER:"#rating"};var u=e(573),s=e(4921),T=e(5406),m=e(2524),t=e(4521),o=e(5213),r=e(8586),g=e(7877),N=e(5539);function L(I,D){I.forEach(A=>_(D,A))}function _(I,D){if(!D)return;const A=new RegExp(`(${D})`,"gi"),x=document.createTreeWalker(I,NodeFilter.SHOW_TEXT,null);let P=x.nextNode();const k=[];for(;P;){const{textContent:M}=P;if(A.test(M)){const $=document.createDocumentFragment();let z=0;M.replace(A,(Y,ne,Z)=>{Z>z&&$.appendChild(document.createTextNode(M.slice(z,Z)));const J=document.createElement("span");J.className="highlightedSubstring",J.style.backgroundColor="yellow",J.textContent=Y,$.appendChild(J),z=Z+Y.length}),z<M.length&&$.appendChild(document.createTextNode(M.slice(z))),k.push({node:P,fragment:$})}P=x.nextNode()}k.forEach(({node:M,fragment:$})=>{M.parentNode.replaceChild($,M)})}function n(I){(0,u.fI)(".highlightedSubstring",I).forEach(A=>{const{parentNode:x}=A;A.replaceWith(A.textContent),x.normalize()})}var E=e(8355);function a(I,D){const A=(0,E.f)(I);L(A,D)}function c(I,D){const A=getIncludedSearchStrings(I);D.forEach(x=>highlightSubstrings(A,x))}var O=e(3829),p=e(9928);function h(I={}){return(0,p.Sw)(I,"|")}function d(I={},D=75,A="customFiltersContainer"){const x=document.getElementById(A);if(!x)return console.log(`Element with id="${A}" not found.`),null;const P=createButton(I,`${arrowUpIcon}\u041A \u0444\u0438\u043B\u044C\u0442\u0440\u0430\u043C`);return P.addEventListener("mouseenter",()=>{P.style.filter="brightness(0.9)"}),P.addEventListener("mouseleave",()=>{P.style.filter="brightness(1)"}),P.addEventListener("click",()=>{const k=x.getBoundingClientRect();window.scrollTo({top:k.top+window.scrollY-D})}),new IntersectionObserver(([k])=>{P.style.display=k.isIntersecting?"none":"flex"},{threshold:.5}).observe(x),P}function C(I,D={}){const A=d(D);A&&I.appendChild(A)}const{createGlobalFilter:b}=(0,t.z)(F),W=b("reviews-text-filter"),X=b("reviews-min-rating-filter"),G=b("reviews-max-rating-filter"),j=b("reviews-filter-enabled",!0),V={reviewCardsCache:new Map};async function f(){(0,l.z1)();const I=await(0,s.xk)(document,i.CONTROLS_CONTAINER);(0,o.b)(I,R),F();const D=await w();(0,m.ft)((0,l.rd)(),D);const A=(0,l.pR)(D,U());(0,l.Np)(A),(0,T.$F)("rates_category")&&K()}function R(I,D){(0,N.ZM)(I,r.r.FILTERS_CONTAINER),I.style.marginTop="12px";const A=(0,g.E9)(W,r.r.CONTROL,r.r.TEXT_INPUT),x=(0,g.HX)(X,r.r.CONTROL,r.r.NUMBER_INPUT,1,1),P=(0,g.FR)(G,r.r.CONTROL,r.r.NUMBER_INPUT,1,1),k=h(r.r.CONTROL),M=(0,g.pW)(j,r.r.CONTROL,r.r.CHECKBOX_INPUT);I.append(A,x,P,k,M),D.append(I)}function F(){(0,u.fI)(i.REVIEWS).forEach(B)}function B(I){if(!j.value){(0,N.kl)(I);return}n(I);let D=V.reviewCardsCache.get(I);if(!D){const x=(0,u.Fi)(i.REVIEW_TEXT_WRAP,I),P=(0,u.Fi)(i.REVIEW_RATING_WRAP,I);if(!x){(0,N.Bt)(I);return}D={reviewTextWrap:x,reviewText:x.innerText,rating:P&&(0,u.YA)(P)},V.reviewCardsCache.set(I,D)}W.value&&a(W,D.reviewTextWrap);const A=(0,O.Ay)(D.reviewText,W)||H(D.rating);(0,N.UC)(I,A)}function H(I){return I?(0,O.JE)(I,X)||(0,O.iG)(I,G):!1}async function w(){const I=(0,u.Fi)(i.FILTER_CHIP);I.click();const D=await(0,s.xk)(document,i.FILTER_LIST),A=[...(0,u.fI)(i.FILTER_LIST_ITEM,D)].map(x=>{const P=x.getAttribute("data-qa");if(!P)return null;const k=P.replace("reviews_filter_list_item_",""),M=(0,u.Fi)(i.FILTER_TITLE_WRAP,x).textContent.trim(),$=(0,u.Fi)(i.FILTER_COUNT_WRAP,x),z=(0,u.YA)($,!0),Y=y($.classList);return{category:k,title:M,count:z,bgClassSuffix:Y}});return I.click(),A}function y(I){const D=I.value.match(/ui-kit-bg-bg-(\w+)/);return D?D[1]:null}function U(){const{location:I}=window;return`${I.origin}${I.pathname}`}function K(){(0,u.Fi)(i.REVIEWS_CONTAINER).scrollIntoView({behavior:"smooth"})}}},q={};function Q(S){var v=q[S];if(v!==void 0)return v.exports;var e=q[S]={exports:{}};return ee[S](e,e.exports,Q),e.exports}(()=>{var S=typeof Symbol=="function"?Symbol("webpack queues"):"__webpack_queues__",v=typeof Symbol=="function"?Symbol("webpack exports"):"__webpack_exports__",e=typeof Symbol=="function"?Symbol("webpack error"):"__webpack_error__",l=u=>{u&&u.d<1&&(u.d=1,u.forEach(s=>s.r--),u.forEach(s=>s.r--?s.r++:s()))},i=u=>u.map(s=>{if(s!==null&&typeof s=="object"){if(s[S])return s;if(s.then){var T=[];T.d=0,s.then(o=>{m[v]=o,l(T)},o=>{m[e]=o,l(T)});var m={};return m[S]=o=>o(T),m}}var t={};return t[S]=o=>{},t[v]=s,t});Q.a=(u,s,T)=>{var m;T&&((m=[]).d=-1);var t=new Set,o=u.exports,r,g,N,L=new Promise((_,n)=>{N=n,g=_});L[v]=o,L[S]=_=>(m&&_(m),t.forEach(_),L.catch(n=>{})),u.exports=L,s(_=>{r=i(_);var n,E=()=>r.map(c=>{if(c[e])throw c[e];return c[v]}),a=new Promise(c=>{n=()=>c(E),n.r=0;var O=p=>p!==m&&!t.has(p)&&(t.add(p),p&&!p.d&&(n.r++,p.push(n)));r.map(p=>p[S](O))});return n.r?a:E()},_=>(_?N(L[e]=_):g(o),l(m))),m&&m.d<0&&(m.d=0)}})(),Q.d=(S,v)=>{for(var e in v)Q.o(v,e)&&!Q.o(S,e)&&Object.defineProperty(S,e,{enumerable:!0,get:v[e]})},Q.o=(S,v)=>Object.prototype.hasOwnProperty.call(S,v);var te=Q(1753)})();})();
