// ==UserScript==
// @name         Prodoc enhancer
// @description  Hide doctor cards by filter, enhance doctor page
// @grant        GM_addValueChangeListener
// @grant        GM_setValue
// @grant        GM_getValue
// @match        https://prodoctorov.ru/*
// @namespace    https://github.com/reliable-code/product-list-filters
// @version      2.0.73697271
// @icon         https://www.google.com/s2/favicons?sz=64&domain=prodoctorov.ru
// @author       reliable-code
// ==/UserScript==

(()=>{(()=>{"use strict";var ee={9928:(N,h,e)=>{e.d(h,{S:()=>v,Sw:()=>C,d:()=>a,kU:()=>c,o5:()=>u});var s=e(4921),i=e(5539);function c(l,t,n){const E=p(l,"text",t);return E.value=n,E}function u(l,t,n,E,D,_){const b=p(l,"number",t);return b.value=n,b.step=E,b.min=D,b.max=_,b}function v(l,t,n){const E=p(l,"checkbox",t);return E.checked=n,E}function p(l={},t=null,n=null){const E=I("input",l);return t&&(E.type=t),n&&(E.addEventListener("keyup",(0,s.sg)(n,200)),E.addEventListener("change",(0,s.sg)(n,100))),E}function o(l={},t=null){return I("span",l,t)}function a(l={},t=null,n=null){const E=I("a",l,t);return n&&(E.href=n),E}function r(l={},t=null,n=null){const E=I("button",l,t);return n&&(E.onclick=n),E}function C(l={},t=null){return I("div",l,t)}function I(l,t,n=null){if(typeof t!="object"||t===null)throw new TypeError("styles should be an object");const E=document.createElement(l);return(0,i.ZM)(E,t),n&&(E.innerHTML=n),E}},573:(N,h,e)=>{e.d(h,{Fi:()=>c,YA:()=>o,fI:()=>u});var s=e(4214);function i(t,n=document){return!!n.querySelector(t)}function c(t,n=document,E=!1){const D=n.querySelector(t);return E&&!D&&console.log(`No element found for selector: ${t}`),D}function u(t,n=document,E=!1){const D=n.querySelectorAll(t);return E&&!D.length&&console.log(`No elements found for selector: ${t}`),D}function v(t,n,E){return[...t.querySelectorAll(n)].find(D=>D.textContent.trim().includes(E))}function p(t,n,E=!1,D=!1){const _=c(n,t,!0);return o(_,E,D)}function o(t,n=!1,E=!1,D=null){if(!t)return D===null?(console.log("No element found"),null):D;const _=t.innerText;return C(_,n,E)}function a(t,n,E=!1){const D=t[n];return o(D,E)}function r(t,n=!1,E=!1){const D=t.textContent;return C(D,n,E)}function C(t,n,E){return n&&(t=(0,s.zr)(t)),E&&(t=t.replace(",",".")),+t}function I(t){return[...t.childNodes].find(n=>n.nodeType===Node.TEXT_NODE)}function l(t){const n=E=>E.nodeType===Node.TEXT_NODE&&E.textContent.trim()!==""?[E]:[...E.childNodes].flatMap(n);return n(t)}},5539:(N,h,e)=>{e.d(h,{Bt:()=>i,UC:()=>o,WH:()=>s,ZM:()=>w,kl:()=>v});function s(m,R){m.parentNode.insertBefore(R,m.nextSibling)}function i(m){m.style.display="none"}function c(m){C(m),i(m)}function u(m){m.intersectionObserver||runOnceOnIntersection(m,()=>i(m))}function v(m){m.style.display=""}function p(m){const R=r(m);m.style.display=R}function o(m,R){R?i(m):v(m)}function a(m,R){R?u(m):(clearIntersectionObserver(m),v(m))}function r(m){return C(m),m.defaultDisplay}function C(m){if(m.defaultDisplay)return;const{display:R}=getComputedStyle(m);m.defaultDisplay=R}function I(){return{show:[],hide:[]}}function l(m,R,x){m?R.hide.push(x):R.show.push(x)}function t(m){m.show.forEach(v),m.hide.forEach(i)}function n(m,R,x=.3){R?D(m,x):E(m)}function E(m){m.style.opacity=""}function D(m,R=.3){m.style.opacity=R}function _(m){m.style.order=""}function b(m,R){m.style.order=R}function f(m,R){m.style.background=R}function g(){const m=getURLQueryParam("scrollTo");if(!m)return;const R=document.getElementById(m);R?R.scrollIntoView():console.log(`Element with ID "${m}" was not found.`)}function d(m,R="custom-global-style"){let x=document.getElementById(R);x||(x=document.createElement("style"),x.id=R,x.type="text/css",document.head.appendChild(x)),x.textContent=m}function w(m,R){Object.assign(m.style,R)}function A(m){return Object.entries(m).map(([R,x])=>`${R.replace(/([A-Z])/g,"-$1").toLowerCase()}: ${x};`).join(" ")}function M(m){return m?m.split(";").filter(R=>R.trim()!=="").reduce((R,x)=>{const[B,X]=x.split(":").map(U=>U.trim()),G=B.replace(/-([a-z])/g,(U,Q)=>Q.toUpperCase());return R[G]=X,R},{}):{}}},4921:(N,h,e)=>{e.d(h,{sg:()=>c,xk:()=>s});async function s(p,o,a=null){const r=p.querySelector(o);return r?Promise.resolve(r):new Promise(C=>{const I=new MutationObserver(t);I.observe(p,{childList:!0,subtree:!0});let l=null;a&&(l=setTimeout(()=>{I.disconnect(),console.log(`No element found for selector: ${o}`),C(null)},a));function t(){const n=p.querySelector(o);n&&(l&&clearTimeout(l),I.disconnect(),C(n))}})}async function i(p,o){return p.querySelector(o)?new Promise(r=>{const C=new MutationObserver(I);C.observe(p,{childList:!0,subtree:!0});function I(){p.querySelector(o)||(C.disconnect(),r())}}):Promise.resolve()}function c(p,o=250){let a;return(...r)=>{clearTimeout(a),a=setTimeout(()=>p(...r),o)}}function u(p,o){const a=new IntersectionObserver(r=>{r.forEach(C=>{C.isIntersecting&&(o(),v(p))})});p.intersectionObserver=a,a.observe(p)}function v(p){p.intersectionObserver&&(p.intersectionObserver.disconnect(),p.intersectionObserver=null)}},3829:(N,h,e)=>{e.d(h,{Ay:()=>i,JE:()=>u,iG:()=>v});var s=e(8355);function i(o,a){return!c(o,a)}function c(o,a){if(!a.value)return!0;const r=o.toLowerCase(),C=(0,s.R)(a),I=[],l=[];return C.forEach(t=>{if(t.startsWith("!")){const n=t.substring(1);n&&l.push(n)}else I.push(t)}),I.every(t=>r.includes(t))&&l.every(t=>!r.includes(t))}function u(o,a){return a.value!=null&&o<a.value}function v(o,a){return a.value!=null&&o>a.value}function p(o,a){return a.value&&o!==a.value}},4521:(N,h,e)=>{e.d(h,{z:()=>i});var s=e(3048);function i(c,u=null){return{createGlobalFilter(v,p=null,o=c){return s.V.create(v,p,o)},createSectionFilter(v,p=null,o=c){if(!u)throw new Error("sectionId must be provided to use createSectionFilter.");return s.V.createWithCompositeKey(u,v,p,o)}}}},5884:(N,h,e)=>{e.d(h,{Hw:()=>u,Nm:()=>i,nW:()=>c});var s=e(9928);function i(v,p,o={},a={}){const r=(0,s.Sw)(o,v),C=(0,s.kU)(a,p.updateValueFromEvent,p.value);return r.append(C),r}function c(v,p,o,a,r,C={},I={}){const l=(0,s.Sw)(C,v),t=(0,s.o5)(I,p.updateValueFromEvent,p.value,o,a,r);return l.append(t),l}function u(v,p,o={},a={}){const r=(0,s.Sw)(o,v),C=(0,s.S)(a,p.updateValueFromEvent,p.value);return r.append(C),r}},7877:(N,h,e)=>{e.d(h,{E9:()=>i,FR:()=>u,HX:()=>c,X0:()=>v,pW:()=>b});var s=e(5884);function i(f,g={},d={}){return(0,s.Nm)("\u041F\u043E\u0438\u0441\u043A: ",f,g,d)}function c(f,g={},d={},w=.1,A=3){return(0,s.nW)("\u041C\u0438\u043D. \u0440\u0435\u0439\u0442\u0438\u043D\u0433: ",f,w,A,5,g,d)}function u(f,g={},d={},w=.1,A=3){return(0,s.nW)("\u041C\u0430\u043A\u0441. \u0440\u0435\u0439\u0442\u0438\u043D\u0433: ",f,w,A,5,g,d)}function v(f,g={},d={}){return o("\u041C\u0438\u043D. \u043E\u0442\u0437\u044B\u0432\u043E\u0432: ",f,g,d)}function p(f,g={},d={}){return o("\u041C\u0430\u043A\u0441. \u043E\u0442\u0437\u044B\u0432\u043E\u0432: ",f,g,d)}function o(f,g,d={},w={}){return(0,s.nW)(f,g,"1","1","999999",d,w)}function a(f,g={},d={}){return r("\u041C\u0438\u043D. \u0441\u043A\u0438\u0434\u043A\u0430: ",f,g,d)}function r(f,g,d={},w={}){return createNumberFilterControl(f,g,"5","0","100",d,w)}function C(f,g={},d={}){return createNumberFilterControl("\u041C\u0438\u043D. \u043A\u0435\u0448\u0431\u0435\u043A: ",f,"5","0","100",g,d)}function I(f,g,d={},w={},A="250"){return createNumberFilterControl(f,g,A,"0","1000000",d,w)}function l(f,g={},d={},w="25"){return I("\u041C\u0438\u043D. \u0446\u0435\u043D\u0430: ",f,g,d,w)}function t(f,g={},d={},w="25"){return I("\u041C\u0430\u043A\u0441. \u0446\u0435\u043D\u0430: ",f,g,d,w)}function n(f,g,d={},w={}){return createNumberFilterControl(f,g,"1","0","99999",d,w)}function E(f,g={},d={}){return createCheckboxFilterControl("\u0411\u0435\u0437 \u0440\u0435\u0439\u0442\u0438\u043D\u0433\u0430: ",f,g,d)}function D(f,g={},d={}){return createCheckboxFilterControl("\u0421 \u0444\u043E\u0442\u043E: ",f,g,d)}function _(f,g={},d={}){return createCheckboxFilterControl("\u041F\u0440\u043E\u0433\u0440\u0443\u0437\u043A\u0430: ",f,g,d)}function b(f,g={},d={}){return(0,s.Hw)("\u0412\u043A\u043B: ",f,g,d)}},8355:(N,h,e)=>{e.d(h,{R:()=>s,f:()=>i});function s(c){return c.value.toLowerCase().split(",").map(u=>u.trim()).filter(u=>u!=="")}function i(c){return s(c).filter(u=>!u.startsWith("!"))}},5213:(N,h,e)=>{e.d(h,{b:()=>c});var s=e(9928),i=e(573);function c(u,v,p=!1,o="customFiltersContainer"){let a=(0,i.Fi)(`#${o}`,u);if(a)if(p)a.remove();else return;a=(0,s.Sw)(),a.id=o,v(a,u)}},8200:(N,h,e)=>{e.d(h,{s:()=>s});function s(i){const{target:c}=i,{type:u}=c;switch(u){case"text":return`"${c.value}"`;case"number":return c.value;case"checkbox":return c.checked;default:return console.log(`Unknown input type: ${u}`),null}}},157:(N,h,e)=>{e.d(h,{Fg:()=>s,IC:()=>u,vx:()=>c});const s=window.GM_setValue,i=window.GM.setValue,c=window.GM_getValue,u=window.GM_addValueChangeListener},1870:(N,h,e)=>{e.d(h,{j:()=>s});class s{constructor(c,u){this.value=c,this.onChange=u}onChangeIfDefined=()=>{this.onChange&&this.onChange()}}},3048:(N,h,e)=>{e.d(h,{V:()=>v});var s=e(1870),i=e(8200),c=e(3976),u=e(157);class v extends s.j{constructor(o,a=null,r=null){super((0,u.vx)(o,a),r),this.storageKey=o,this.defaultValue=a}static create(o,a=null,r=null){return new v(o,a,r)}static createWithCompositeKey(o,a,r=null,C=null){const I=`${o}-${a}`;return new v(I,r,C)}updateValueFromEvent=o=>{const a=(0,i.s)(o),r=(0,c.$)(a);this.updateValue(r)};updateValue(o){this.value!==o&&((0,u.Fg)(this.storageKey,o),this.value=o,this.onChangeIfDefined())}clearValue(){this.updateValue(null)}resetValue(){this.updateValue(this.defaultValue)}}},3976:(N,h,e)=>{e.d(h,{$:()=>s});function s(i){return i===""?null:JSON.parse(i)}},4214:(N,h,e)=>{e.d(h,{$z:()=>s,zr:()=>i});function s(v){return v.replace(/\D/g,"")}function i(v){return v.replace(/[^\d.,-]/g,"")}function c(v){return v.replace(/\s/g,"")}function u(v){return v.charAt(0).toUpperCase()+v.slice(1)}},5406:(N,h,e)=>{e.d(h,{$F:()=>p,Fc:()=>s,bn:()=>i,z2:()=>C});function s(l,t="common",n=!1){const{pathname:E}=window.location;return i(E,l,t,n)}function i(l,t,n,E=!1){const _=l.split("/")[t]||n;return E&&console.log(`Pathname element: ${_}`),_}function c(l,t="common",n=!1){const E=s(l,"",n);return u(E,t,n)}function u(l,t,n){if(!l)return t;const E=l.split("-").at(-1);return n&&console.log(`Pathname element ending: ${E}`),E}function v(l,t,n="common",E=!1){const D=i(l,t,"",E);return u(D,n,E)}function p(l){return new URLSearchParams(window.location.search).get(l)}function o(l){return l.split("?")[0]}function a(l){return window.location.pathname.includes(l)}function r(l){return l.some(t=>a(t))}function C(l){return window.location.pathname.split("/").some(n=>n===l)}function I(l){try{const t=new URL(window.location.href);Object.entries(l).forEach(([n,E])=>{t.searchParams.set(n,E)}),window.location.href=t.toString()}catch(t){console.error("Failed to redirect:",t)}}},2524:(N,h,e)=>{e.d(h,{d5:()=>c,vX:()=>o,ft:()=>u});var s=e(157);class i{constructor(C=Date.now(),I=[]){this.lastCheckDate=C,this.reviewsData=I}updateLastCheckDate=()=>{this.lastCheckDate=Date.now()};static fromObject(C){const{lastCheckDate:I,reviewsData:l}=C;return new i(I,l)}}const c={LAST_DOCTOR_UPDATE:"last-doctor-update"};function u(r,C){const I=v(r),l=(0,s.vx)(I),t=p(l);t.reviewsData=C,t.updateLastCheckDate(),(0,s.Fg)(I,t),(0,s.Fg)(c.LAST_DOCTOR_UPDATE,Date.now())}function v(r){return`doctor-${r}`}function p(r){return r?i.fromObject(r):new i}function o(r){return a(r)?.reviewsData??null}function a(r){const C=v(r);return(0,s.vx)(C)}},1753:(N,h,e)=>{e.a(N,async(s,i)=>{try{var c=e(573),u=e(7858),v=e(4231),p=e(5406),o=e(5072);const r=(0,c.Fi)(".appointments_page");r?(0,v.$)(r):(0,p.z2)("otzivi")?await(0,o.N)():(0,p.z2)("vrach")&&(0,u.O)(),i()}catch(a){i(a)}},1)},7653:(N,h,e)=>{e.d(h,{NI:()=>r,z1:()=>l,Np:()=>D,pR:()=>t,sp:()=>b,rd:()=>_});var s=e(9928),i=e(573);const c={DOCTOR_CARD_NAME:'.b-doctor-intro__title-first-line [itemprop="name"]',DOCTOR_INTRO_LEFT:".b-doctor-intro__left-side",NAME_SPAN_HOLDER:".b-doctor-intro__title-first-line",NAME_SPAN:'[itemprop="name"]'};var u=e(8586),v=e(5406),p=e(4214);const o="additionalLinksAppended",a=["\u042F\u043D\u0434\u0435\u043A\u0441","\u041D\u0430\u041F\u043E\u043F\u0440\u0430\u0432\u043A\u0443","DocDoc","\u0414\u043E\u043A\u0442\u0443"];function r(f,g){g.classList.contains(o)||(a.forEach(d=>{C(f,g,d)}),g.classList.add(o))}function C(f,g,d){const w=I(f,d),A=(0,s.d)({},d,w),M=document.createElement("br");g.append(M,A)}function I(f,g){const d=`${f} ${g}`;return`https://www.google.com/search?q=${encodeURIComponent(d)}&btnI`}function l(){const f=(0,i.Fi)(c.DOCTOR_CARD_NAME,document,!0);if(!f)return;const g=f.innerText.trim(),d=(0,s.Sw)();d.style.textAlign="center",(0,i.Fi)(c.DOCTOR_INTRO_LEFT).append(d),r(g,d)}function t(f,g,d=!1){const w=(0,s.Sw)(u.r.REVIEWS_INFO);d&&(w.style.justifyContent="center"),w.classList.add("v-application");const A=(0,s.Sw)(u.r.REVIEWS_INFO_BLOCK);return A.style.height=d?"10px":"23px",A.append(w),f.slice(d?1:0).forEach(M=>{const{category:m,title:R,count:x,bgClassSuffix:B}=M,X=`${g}?rates_category=${m}`,G=d?x:`${R} ${x}`,U=(0,s.d)(u.r.REVIEW_INFO,G,X);U.classList=n(B),w.append(U),d&&E(U,R)}),A}function n(f){return`text-caption ui-kit-color-text px-2 py-1 rounded ui-kit-bg-bg-${f}`}function E(f,g){let d=null;f.addEventListener("mouseenter",()=>{d=(0,s.Sw)(u.r.REVIEW_INFO_TOOLTIP,g),document.body.appendChild(d);const w=f.getBoundingClientRect();d.style.left=`${(w.left+w.right)/2-d.offsetWidth/2+window.scrollX+2}px`,d.style.top=`${w.top+window.scrollY-d.offsetHeight-4}px`}),f.addEventListener("mouseleave",()=>{d&&(d.remove(),d=null)})}function D(f){const g=(0,i.Fi)(c.NAME_SPAN_HOLDER,document,!0);if(!g)return;const d=(0,i.Fi)(c.NAME_SPAN,g,!0);d&&d.append(f)}function _(){const f=(0,v.Fc)(3,"unknown");return(0,p.$z)(f)}function b(f){const g=(0,v.bn)(f,5,"");return(0,p.$z)(g)}},8586:(N,h,e)=>{e.d(h,{r:()=>i});const s={INPUT:{border:"1px solid #c7d3d9",borderRadius:"10px",padding:"7px 14px",marginLeft:"6px"}},i={FILTERS_CONTAINER:{display:"flex",gridGap:"15px",flexFlow:"wrap"},CONTROL:{display:"flex",alignItems:"center"},TEXT_INPUT:{...s.INPUT,width:"195px"},NUMBER_INPUT:{...s.INPUT,width:"70px"},CHECKBOX_INPUT:{...s.INPUT,width:"20px",height:"20px"},REVIEWS_INFO:{gridGap:"6px"},REVIEWS_INFO_BLOCK:{marginTop:"5px"},REVIEW_INFO:{textDecoration:"none",flexShrink:0},REVIEW_INFO_TOOLTIP:{position:"absolute",backgroundColor:"#333",color:"#fff",padding:"4px 8px",borderRadius:"8px",fontSize:"12px",zIndex:"1000",pointerEvents:"none",boxShadow:"0 2px 4px rgba(0, 0, 0, 0.2)"}}},4231:(N,h,e)=>{e.d(h,{$:()=>m});var s=e(5406),i=e(573),c=e(5539),u=e(3829),v=e(7653),p=e(5213),o=e(5884),a=e(7877);const r={LIST_HEADER:".h2_rating",DOCTOR_FILTERS:".doctor-filters",DOCTOR_CARD:".b-doctor-card",DOCTOR_CARD_NAME:".b-doctor-card__name-surname",PROFILE_CARD:".b-profile-card",REVIEWS_LINK:":scope > a",EXPERIENCE_WRAP:".b-doctor-card__experience .mr-2 .ui-text",SPEC_WRAP:".b-doctor-card__spec",CLINIC_CONTAINER:"div.b-doctor-card__lpu-select",CLINIC_WRAP:".b-select__trigger-main-text"};var C=e(4521),I=e(2524),l=e(4921),t=e(157),n=e(8586);const E=(0,s.Fc)(2),{createGlobalFilter:D,createSectionFilter:_}=(0,C.z)(B,E),b=_("spec-filter"),f=_("clinic-filter"),g=_("min-reviews-filter",10),d=_("min-experience-filter",5,Y),w=_("max-experience-filter",40),A=D("filter-enabled",!0),M={doctorCardsCache:new WeakMap};function m(O){Y(),R();const P=(0,i.Fi)(r.DOCTOR_FILTERS);(0,p.b)(P,x),B(),(0,t.IC)(I.d5.LAST_DOCTOR_UPDATE,B),new MutationObserver((0,l.sg)(B)).observe(O,{childList:!0})}function R(){const O=(0,i.Fi)(r.LIST_HEADER);O&&O.remove()}function x(O,P){(0,c.ZM)(O,n.r.FILTERS_CONTAINER),O.style.marginTop="6px";const V=(0,o.Nm)("\u0421\u043F\u0435\u0446\u0438\u0430\u043B\u0438\u0437\u0430\u0446\u0438\u044F:",b,n.r.CONTROL,n.r.TEXT_INPUT),H=(0,o.Nm)("\u041A\u043B\u0438\u043D\u0438\u043A\u0430:",f,n.r.CONTROL,n.r.TEXT_INPUT),T=(0,a.X0)(g,n.r.CONTROL,n.r.NUMBER_INPUT),S=(0,o.nW)("\u041C\u0438\u043D. \u043E\u043F\u044B\u0442: ",d,"1","0","100",n.r.CONTROL,n.r.NUMBER_INPUT),F=(0,o.nW)("\u041C\u0430\u043A\u0441. \u043E\u043F\u044B\u0442: ",w,"1","0","100",n.r.CONTROL,n.r.NUMBER_INPUT),L=(0,a.pW)(A,n.r.CONTROL,n.r.CHECKBOX_INPUT);O.append(V,H,T,S,F,L),P.append(O)}function B(){(0,i.fI)(r.DOCTOR_CARD).forEach(X)}function X(O){if(!A.value){(0,c.kl)(O);return}let P=M.doctorCardsCache.get(O);if(!P){const H=(0,i.Fi)(r.PROFILE_CARD,O),T=(0,i.Fi)(r.REVIEWS_LINK,H),S=(0,i.Fi)(r.EXPERIENCE_WRAP,O);if(!T||!S){(0,c.Bt)(O);return}const L=(0,i.Fi)(r.SPEC_WRAP,O,!0).innerText.trim(),y=(0,i.Fi)(r.CLINIC_CONTAINER,O,!0),W=(0,i.Fi)(r.CLINIC_WRAP,y,!0).innerText.trim(),$=(0,i.YA)(T,!0),K=(0,i.YA)(S,!0),j=G(T);T.href=j,(0,v.NI)(U(O),H),P={specInfo:L,clinicName:W,reviewsLinkNumber:$,experienceNumber:K,reviewsLink:T,reviewInfoAppended:!1},M.doctorCardsCache.set(O,P)}Q(P);const V=(0,u.Ay)(P.specInfo,b)||(0,u.Ay)(P.clinicName,f)||(0,u.JE)(P.reviewsLinkNumber,g)||(0,u.JE)(P.experienceNumber,d)||(0,u.iG)(P.experienceNumber,w);(0,c.UC)(O,V)}function G(O){return O.href.replace(/\/#otzivi$/,"/otzivi/")}function U(O){return(0,i.Fi)(r.DOCTOR_CARD_NAME,O,!0).innerText}function Q(O){if(O.reviewInfoAppended)return;const{reviewsLink:P}=O,V=P.href,H=(0,I.vX)((0,v.sp)(V));if(!H)return;const T=(0,v.pR)(H,V,!0);(0,c.WH)(P,T),O.reviewInfoAppended=!0}function Y(){if(!d.value)return;const O=new URL(window.location.href);+O.searchParams.get("experience")!==d.value&&(O.searchParams.set("experience",d.value),window.location.href=O.toString())}},7858:(N,h,e)=>{e.d(h,{O:()=>p});var s=e(573),i=e(9928),c=e(7653);const u={DOCTOR_DETAILS:".b-doctor-details__toc",REVIEWS_FILTER:".reviews-filter:not(.b-reviews-page__filter)",NAME_SPAN_HOLDER:".b-doctor-intro__title-first-line",NAME_SPAN:'[itemprop="name"]',REVIEWS_FILTER_SPAN:":scope > span",DOCTOR_CONTACTS:"#doctor-contacts"};var v=e(2524);function p(){(0,c.z1)(),a();const r=(0,v.vX)((0,c.rd)());if(!r)return;const C=(0,c.pR)(r,o());(0,c.Np)(C)}function o(){const{location:r}=window;return`${r.origin}${r.pathname}otzivi/`}function a(){if(!(0,s.Fi)(u.DOCTOR_CONTACTS))return;const C=[...(0,s.fI)(u.DOCTOR_DETAILS)].pop();if(!C)return;C.style.position="sticky",C.style.top="16px";const I=(0,i.Sw)({},"\u041C\u0435\u0441\u0442\u043E \u0440\u0430\u0431\u043E\u0442\u044B");I.classList.add("b-doctor-details__toc-title");const l=(0,i.d)({},null,"#doctor-contacts");l.classList.add("b-doctor-details__toc-item"),l.append(I),C.insertBefore(l,C.firstChild)}},5072:(N,h,e)=>{e.d(h,{N:()=>X});var s=e(7653);const i={CONTROLS_CONTAINER:".vue-review-filter",REVIEWS:".b-review-card",REVIEW_TEXT_WRAP:".b-review-card__comment",REVIEW_RATING_WRAP:".review-card-tooltips__stars > .ui-text",FILTER_CHIP:'[data-qa="reviews_filter_chip"]',FILTER_LIST:'[data-qa="reviews_filter_list"]',FILTER_LIST_ITEM:'[data-qa^="reviews_filter_list_item"]',FILTER_TITLE_WRAP:'[data-qa="reviews_filter_title"]',FILTER_COUNT_WRAP:'[data-qa="reviews_filter_amount"]',REVIEWS_CONTAINER:"#rating"};var c=e(573),u=e(4921),v=e(5406),p=e(2524),o=e(4521),a=e(5213),r=e(8586),C=e(7877),I=e(5539);function l(T,S){T.forEach(F=>t(S,F))}function t(T,S){if(!S)return;const F=new RegExp(`(${S})`,"gi"),L=document.createTreeWalker(T,NodeFilter.SHOW_TEXT,null);let y=L.nextNode();const k=[];for(;y;){const{textContent:W}=y;if(F.test(W)){const $=document.createDocumentFragment();let K=0;W.replace(F,(j,ne,Z)=>{Z>K&&$.appendChild(document.createTextNode(W.slice(K,Z)));const J=document.createElement("span");J.className="highlightedSubstring",J.style.backgroundColor="yellow",J.textContent=j,$.appendChild(J),K=Z+j.length}),K<W.length&&$.appendChild(document.createTextNode(W.slice(K))),k.push({node:y,fragment:$})}y=L.nextNode()}k.forEach(({node:W,fragment:$})=>{W.parentNode.replaceChild($,W)})}function n(T){(0,c.fI)(".highlightedSubstring",T).forEach(F=>{const{parentNode:L}=F;F.replaceWith(F.textContent),L.normalize()})}var E=e(8355);function D(T,S){const F=(0,E.f)(T);l(F,S)}function _(T,S){const F=getIncludedSearchStrings(T);S.forEach(L=>highlightSubstrings(F,L))}var b=e(3829),f=e(9928);function g(T={}){return(0,f.Sw)(T,"|")}function d(T={},S=75,F="customFiltersContainer"){const L=document.getElementById(F);if(!L)return console.log(`Element with id="${F}" not found.`),null;const y=createButton(T,`${arrowUpIcon}\u041A \u0444\u0438\u043B\u044C\u0442\u0440\u0430\u043C`);return y.addEventListener("mouseover",()=>{y.style.filter="brightness(0.9)"}),y.addEventListener("mouseout",()=>{y.style.filter="brightness(1)"}),y.addEventListener("click",()=>{const k=L.getBoundingClientRect();window.scrollTo({top:k.top+window.scrollY-S})}),new IntersectionObserver(([k])=>{y.style.display=k.isIntersecting?"none":"flex"},{threshold:.5}).observe(L),y}function w(T,S={}){const F=d(S);F&&T.appendChild(F)}const{createGlobalFilter:A}=(0,o.z)(U),M=A("reviews-text-filter"),m=A("reviews-min-rating-filter"),R=A("reviews-max-rating-filter"),x=A("reviews-filter-enabled",!0),B={reviewCardsCache:new Map};async function X(){(0,s.z1)();const T=await(0,u.xk)(document,i.CONTROLS_CONTAINER);(0,a.b)(T,G),U();const S=await O();(0,p.ft)((0,s.rd)(),S);const F=(0,s.pR)(S,V());(0,s.Np)(F),(0,v.$F)("rates_category")&&H()}function G(T,S){(0,I.ZM)(T,r.r.FILTERS_CONTAINER),T.style.marginTop="12px";const F=(0,C.E9)(M,r.r.CONTROL,r.r.TEXT_INPUT),L=(0,C.HX)(m,r.r.CONTROL,r.r.NUMBER_INPUT,1,1),y=(0,C.FR)(R,r.r.CONTROL,r.r.NUMBER_INPUT,1,1),k=g(r.r.CONTROL),W=(0,C.pW)(x,r.r.CONTROL,r.r.CHECKBOX_INPUT);T.append(F,L,y,k,W),S.append(T)}function U(){(0,c.fI)(i.REVIEWS).forEach(Q)}function Q(T){if(!x.value){(0,I.kl)(T);return}n(T);let S=B.reviewCardsCache.get(T);if(!S){const L=(0,c.Fi)(i.REVIEW_TEXT_WRAP,T),y=(0,c.Fi)(i.REVIEW_RATING_WRAP,T);if(!L){(0,I.Bt)(T);return}S={reviewTextWrap:L,reviewText:L.innerText,rating:y&&(0,c.YA)(y)},B.reviewCardsCache.set(T,S)}M.value&&D(M,S.reviewTextWrap);const F=(0,b.Ay)(S.reviewText,M)||Y(S.rating);(0,I.UC)(T,F)}function Y(T){return T?(0,b.JE)(T,m)||(0,b.iG)(T,R):!1}async function O(){const T=(0,c.Fi)(i.FILTER_CHIP);T.click();const S=await(0,u.xk)(document,i.FILTER_LIST),F=[...(0,c.fI)(i.FILTER_LIST_ITEM,S)].map(L=>{const y=L.getAttribute("data-qa");if(!y)return null;const k=y.replace("reviews_filter_list_item_",""),W=(0,c.Fi)(i.FILTER_TITLE_WRAP,L).textContent.trim(),$=(0,c.Fi)(i.FILTER_COUNT_WRAP,L),K=(0,c.YA)($,!0),j=P($.classList);return{category:k,title:W,count:K,bgClassSuffix:j}});return T.click(),F}function P(T){const S=T.value.match(/ui-kit-bg-bg-(\w+)/);return S?S[1]:null}function V(){const{location:T}=window;return`${T.origin}${T.pathname}`}function H(){(0,c.Fi)(i.REVIEWS_CONTAINER).scrollIntoView({behavior:"smooth"})}}},q={};function z(N){var h=q[N];if(h!==void 0)return h.exports;var e=q[N]={exports:{}};return ee[N](e,e.exports,z),e.exports}(()=>{var N=typeof Symbol=="function"?Symbol("webpack queues"):"__webpack_queues__",h=typeof Symbol=="function"?Symbol("webpack exports"):"__webpack_exports__",e=typeof Symbol=="function"?Symbol("webpack error"):"__webpack_error__",s=c=>{c&&c.d<1&&(c.d=1,c.forEach(u=>u.r--),c.forEach(u=>u.r--?u.r++:u()))},i=c=>c.map(u=>{if(u!==null&&typeof u=="object"){if(u[N])return u;if(u.then){var v=[];v.d=0,u.then(a=>{p[h]=a,s(v)},a=>{p[e]=a,s(v)});var p={};return p[N]=a=>a(v),p}}var o={};return o[N]=a=>{},o[h]=u,o});z.a=(c,u,v)=>{var p;v&&((p=[]).d=-1);var o=new Set,a=c.exports,r,C,I,l=new Promise((t,n)=>{I=n,C=t});l[h]=a,l[N]=t=>(p&&t(p),o.forEach(t),l.catch(n=>{})),c.exports=l,u(t=>{r=i(t);var n,E=()=>r.map(_=>{if(_[e])throw _[e];return _[h]}),D=new Promise(_=>{n=()=>_(E),n.r=0;var b=f=>f!==p&&!o.has(f)&&(o.add(f),f&&!f.d&&(n.r++,f.push(n)));r.map(f=>f[N](b))});return n.r?D:E()},t=>(t?I(l[e]=t):C(a),s(p))),p&&p.d<0&&(p.d=0)}})(),z.d=(N,h)=>{for(var e in h)z.o(h,e)&&!z.o(N,e)&&Object.defineProperty(N,e,{enumerable:!0,get:h[e]})},z.o=(N,h)=>Object.prototype.hasOwnProperty.call(N,h);var te=z(1753)})();})();
