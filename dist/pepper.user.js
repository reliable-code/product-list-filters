// ==UserScript==
// @name         Pepper product cards filter
// @description  Hide product cards by filter
// @grant        GM_addValueChangeListener
// @grant        GM_setValue
// @grant        GM_getValue
// @match        https://www.pepper.ru/*
// @namespace    https://github.com/reliable-code/product-list-filters
// @version      0.3.73688152
// @icon         https://www.google.com/s2/favicons?sz=64&domain=pepper.ru
// @author       reliable-code
// ==/UserScript==

(()=>{(()=>{"use strict";var G={9928:(C,l,e)=>{e.d(l,{S:()=>f,Sw:()=>w,kU:()=>d,o5:()=>a});var c=e(4921),h=e(5539);function d(p,t,o){const s=i(p,"text",t);return s.value=o,s}function a(p,t,o,s,E,x){const m=i(p,"number",t);return m.value=o,m.step=s,m.min=E,m.max=x,m}function f(p,t,o){const s=i(p,"checkbox",t);return s.checked=o,s}function i(p={},t=null,o=null){const s=N("input",p);return t&&(s.type=t),o&&(s.addEventListener("keyup",(0,c.sg)(o,200)),s.addEventListener("change",(0,c.sg)(o,100))),s}function n(p={},t=null){return N("span",p,t)}function r(p={},t=null,o=null){const s=N("a",p,t);return o&&(s.href=o),s}function b(p={},t=null,o=null){const s=N("button",p,t);return o&&(s.onclick=o),s}function w(p={},t=null){return N("div",p,t)}function N(p,t,o=null){if(typeof t!="object"||t===null)throw new TypeError("styles should be an object");const s=document.createElement(p);return(0,h.ZM)(s,t),o&&(s.innerHTML=o),s}},573:(C,l,e)=>{e.d(l,{Fi:()=>d,YA:()=>n,fI:()=>a});var c=e(4214);function h(t,o=document){return!!o.querySelector(t)}function d(t,o=document,s=!1){const E=o.querySelector(t);return s&&!E&&console.log(`No element found for selector: ${t}`),E}function a(t,o=document,s=!1){const E=o.querySelectorAll(t);return s&&!E.length&&console.log(`No elements found for selector: ${t}`),E}function f(t,o,s){return[...t.querySelectorAll(o)].find(E=>E.textContent.trim().includes(s))}function i(t,o,s=!1,E=!1){const x=d(o,t,!0);return n(x,s,E)}function n(t,o=!1,s=!1,E=null){if(!t)return E===null?(console.log("No element found"),null):E;const x=t.innerText;return w(x,o,s)}function r(t,o,s=!1){const E=t[o];return n(E,s)}function b(t,o=!1,s=!1){const E=t.textContent;return w(E,o,s)}function w(t,o,s){return o&&(t=(0,c.zr)(t)),s&&(t=t.replace(",",".")),+t}function N(t){return[...t.childNodes].find(o=>o.nodeType===Node.TEXT_NODE)}function p(t){const o=s=>s.nodeType===Node.TEXT_NODE&&s.textContent.trim()!==""?[s]:[...s.childNodes].flatMap(o);return o(t)}},5539:(C,l,e)=>{e.d(l,{D9:()=>o,ZM:()=>D,iV:()=>E,vJ:()=>s});function c(u,g){u.parentNode.insertBefore(g,u.nextSibling)}function h(u){u.style.display="none"}function d(u){w(u),h(u)}function a(u){u.intersectionObserver||runOnceOnIntersection(u,()=>h(u))}function f(u){u.style.display=""}function i(u){const g=b(u);u.style.display=g}function n(u,g){g?h(u):f(u)}function r(u,g){g?a(u):(clearIntersectionObserver(u),f(u))}function b(u){return w(u),u.defaultDisplay}function w(u){if(u.defaultDisplay)return;const{display:g}=getComputedStyle(u);u.defaultDisplay=g}function N(){return{show:[],hide:[]}}function p(u,g,T){u?g.hide.push(T):g.show.push(T)}function t(u){u.show.forEach(f),u.hide.forEach(h)}function o(u,g,T=.3){g?E(u,T):s(u)}function s(u){u.style.opacity=""}function E(u,g=.3){u.style.opacity=g}function x(u){u.style.order=""}function m(u,g){u.style.order=g}function v(u,g){u.style.background=g}function y(){const u=getQueryParam("scrollTo");if(!u)return;const g=document.getElementById(u);g?g.scrollIntoView():console.log(`Element with ID "${u}" was not found.`)}function F(u,g="custom-global-style"){let T=document.getElementById(g);T||(T=document.createElement("style"),T.id=g,T.type="text/css",document.head.appendChild(T)),T.textContent=u}function D(u,g){Object.assign(u.style,g)}function L(u){return Object.entries(u).map(([g,T])=>`${g.replace(/([A-Z])/g,"-$1").toLowerCase()}: ${T};`).join(" ")}function $(u){return u?u.split(";").filter(g=>g.trim()!=="").reduce((g,T)=>{const[P,S]=T.split(":").map(k=>k.trim()),I=P.replace(/-([a-z])/g,(k,A)=>A.toUpperCase());return g[I]=S,g},{}):{}}},4921:(C,l,e)=>{e.d(l,{sg:()=>d,xk:()=>c});async function c(i,n,r=null){const b=i.querySelector(n);return b?Promise.resolve(b):new Promise(w=>{const N=new MutationObserver(t);N.observe(i,{childList:!0,subtree:!0});let p=null;r&&(p=setTimeout(()=>{N.disconnect(),console.log(`No element found for selector: ${n}`),w(null)},r));function t(){const o=i.querySelector(n);o&&(p&&clearTimeout(p),N.disconnect(),w(o))}})}async function h(i,n){return i.querySelector(n)?new Promise(b=>{const w=new MutationObserver(N);w.observe(i,{childList:!0,subtree:!0});function N(){i.querySelector(n)||(w.disconnect(),b())}}):Promise.resolve()}function d(i,n=250){let r;return(...b)=>{clearTimeout(r),r=setTimeout(()=>i(...b),n)}}function a(i,n){const r=new IntersectionObserver(b=>{b.forEach(w=>{w.isIntersecting&&(n(),f(i))})});i.intersectionObserver=r,r.observe(i)}function f(i){i.intersectionObserver&&(i.intersectionObserver.disconnect(),i.intersectionObserver=null)}},3829:(C,l,e)=>{e.d(l,{Ay:()=>h,JE:()=>a});var c=e(8355);function h(n,r){return!d(n,r)}function d(n,r){if(!r.value)return!0;const b=n.toLowerCase(),w=(0,c.R)(r),N=[],p=[];return w.forEach(t=>{if(t.startsWith("!")){const o=t.substring(1);o&&p.push(o)}else N.push(t)}),N.every(t=>b.includes(t))&&p.every(t=>!b.includes(t))}function a(n,r){return r.value!=null&&n<r.value}function f(n,r){return r.value!=null&&n>r.value}function i(n,r){return r.value&&n!==r.value}},4521:(C,l,e)=>{e.d(l,{z:()=>h});var c=e(3048);function h(d,a=null){return{createGlobalFilter(f,i=null,n=d){return c.V.create(f,i,n)},createSectionFilter(f,i=null,n=d){if(!a)throw new Error("sectionId must be provided to use createSectionFilter.");return c.V.createWithCompositeKey(a,f,i,n)}}}},5884:(C,l,e)=>{e.d(l,{Hw:()=>a,Nm:()=>h,nW:()=>d});var c=e(9928);function h(f,i,n={},r={}){const b=(0,c.Sw)(n,f),w=(0,c.kU)(r,i.updateValueFromEvent,i.value);return b.append(w),b}function d(f,i,n,r,b,w={},N={}){const p=(0,c.Sw)(w,f),t=(0,c.o5)(N,i.updateValueFromEvent,i.value,n,r,b);return p.append(t),p}function a(f,i,n={},r={}){const b=(0,c.Sw)(n,f),w=(0,c.S)(r,i.updateValueFromEvent,i.value);return b.append(w),b}},7877:(C,l,e)=>{e.d(l,{E9:()=>h,pW:()=>x});var c=e(5884);function h(m,v={},y={}){return(0,c.Nm)("\u041F\u043E\u0438\u0441\u043A: ",m,v,y)}function d(m,v={},y={},F=.1,D=3){return createNumberFilterControl("\u041C\u0438\u043D. \u0440\u0435\u0439\u0442\u0438\u043D\u0433: ",m,F,D,5,v,y)}function a(m,v={},y={},F=.1,D=3){return createNumberFilterControl("\u041C\u0430\u043A\u0441. \u0440\u0435\u0439\u0442\u0438\u043D\u0433: ",m,F,D,5,v,y)}function f(m,v={},y={}){return n("\u041C\u0438\u043D. \u043E\u0442\u0437\u044B\u0432\u043E\u0432: ",m,v,y)}function i(m,v={},y={}){return n("\u041C\u0430\u043A\u0441. \u043E\u0442\u0437\u044B\u0432\u043E\u0432: ",m,v,y)}function n(m,v,y={},F={}){return createNumberFilterControl(m,v,"1","1","999999",y,F)}function r(m,v={},y={}){return b("\u041C\u0438\u043D. \u0441\u043A\u0438\u0434\u043A\u0430: ",m,v,y)}function b(m,v,y={},F={}){return createNumberFilterControl(m,v,"5","0","100",y,F)}function w(m,v={},y={}){return createNumberFilterControl("\u041C\u0438\u043D. \u043A\u0435\u0448\u0431\u0435\u043A: ",m,"5","0","100",v,y)}function N(m,v,y={},F={},D="250"){return createNumberFilterControl(m,v,D,"0","1000000",y,F)}function p(m,v={},y={},F="25"){return N("\u041C\u0438\u043D. \u0446\u0435\u043D\u0430: ",m,v,y,F)}function t(m,v={},y={},F="25"){return N("\u041C\u0430\u043A\u0441. \u0446\u0435\u043D\u0430: ",m,v,y,F)}function o(m,v,y={},F={}){return createNumberFilterControl(m,v,"1","0","99999",y,F)}function s(m,v={},y={}){return createCheckboxFilterControl("\u0411\u0435\u0437 \u0440\u0435\u0439\u0442\u0438\u043D\u0433\u0430: ",m,v,y)}function E(m,v={},y={}){return createCheckboxFilterControl("\u0421 \u0444\u043E\u0442\u043E: ",m,v,y)}function x(m,v={},y={}){return(0,c.Hw)("\u0412\u043A\u043B: ",m,v,y)}},8355:(C,l,e)=>{e.d(l,{R:()=>c});function c(d){return d.value.toLowerCase().split(",").map(a=>a.trim()).filter(a=>a!=="")}function h(d){return c(d).filter(a=>!a.startsWith("!"))}},5213:(C,l,e)=>{e.d(l,{b:()=>d});var c=e(9928),h=e(573);function d(a,f,i=!1,n="customFiltersContainer"){let r=(0,h.Fi)(`#${n}`,a);if(r)if(i)r.remove();else return;r=(0,c.Sw)(),r.id=n,f(r,a)}},8200:(C,l,e)=>{e.d(l,{s:()=>c});function c(h){const{target:d}=h,{type:a}=d;switch(a){case"text":return`"${d.value}"`;case"number":return d.value;case"checkbox":return d.checked;default:return console.log(`Unknown input type: ${a}`),null}}},157:(C,l,e)=>{e.d(l,{Fg:()=>c,vx:()=>d});const c=window.GM_setValue,h=window.GM.setValue,d=window.GM_getValue,a=window.GM_addValueChangeListener},1870:(C,l,e)=>{e.d(l,{j:()=>c});class c{constructor(d,a){this.value=d,this.onChange=a}onChangeIfDefined=()=>{this.onChange&&this.onChange()}}},3048:(C,l,e)=>{e.d(l,{V:()=>f});var c=e(1870),h=e(8200),d=e(3976),a=e(157);class f extends c.j{constructor(n,r=null,b=null){super((0,a.vx)(n,r),b),this.storageKey=n,this.defaultValue=r}static create(n,r=null,b=null){return new f(n,r,b)}static createWithCompositeKey(n,r,b=null,w=null){const N=`${n}-${r}`;return new f(N,b,w)}updateValueFromEvent=n=>{const r=(0,h.s)(n),b=(0,d.$)(r);this.updateValue(b)};updateValue(n){this.value!==n&&((0,a.Fg)(this.storageKey,n),this.value=n,this.onChangeIfDefined())}clearValue(){this.updateValue(null)}resetValue(){this.updateValue(this.defaultValue)}}},3976:(C,l,e)=>{e.d(l,{$:()=>c});function c(h){return h===""?null:JSON.parse(h)}},4214:(C,l,e)=>{e.d(l,{zr:()=>h});function c(f){return f.replace(/\D/g,"")}function h(f){return f.replace(/[^\d.,-]/g,"")}function d(f){return f.replace(/\s/g,"")}function a(f){return f.charAt(0).toUpperCase()+f.slice(1)}},1365:(C,l,e)=>{e.d(l,{i:()=>c});const c={MARK_AS_NEWEST_SEEN_APPENDED:"markAsNewestSeenAppended"}},7234:(C,l,e)=>{e.d(l,{CU:()=>d,Fr:()=>f,Su:()=>h,X0:()=>a});var c=e(157);function h(i){(0,c.Fg)("newest-seen-product-id",i)}function d(){return(0,c.vx)("newest-seen-product-id")}function a(i){(0,c.Fg)("prev-newest-seen-product-id",i)}function f(){return(0,c.vx)("prev-newest-seen-product-id")}},9374:(C,l,e)=>{e.a(C,async(c,h)=>{try{let y=function(){const S=(0,r.fI)(N.Z.PRODUCT_CARD);if(S.length){const I=S[0].parentElement;(0,a.b)(I,F),D(),new MutationObserver(D).observe(I,{childList:!0,subtree:!0})}},F=function(S,I){(0,n.ZM)(S,p.r.FILTERS_CONTAINER);const k=(0,b.E9)(E,p.r.CONTROL,p.r.TEXT_INPUT),A=(0,i.nW)("\u041C\u0438\u043D\u0438\u043C\u0430\u043B\u044C\u043D\u043E \u0433\u043E\u043B\u043E\u0441\u043E\u0432: ",x,"50","0","10000",p.r.CONTROL,p.r.NUMBER_INPUT),O=(0,i.Hw)("\u0417\u0430\u0432\u0435\u0440\u0448\u0451\u043D\u043D\u044B\u0435: ",m,p.r.CONTROL,p.r.CHECKBOX_INPUT),V=(0,b.pW)(v,p.r.CONTROL,p.r.CHECKBOX_INPUT);S.append(k,A,O,V),I.prepend(S)},D=function(){(0,r.fI)(N.Z.PRODUCT_CARD).forEach(L)},L=function(S){const I=(0,r.Fi)(N.Z.PRODUCT_CARD_LINK,S),k=$(I);if(u(k,S),g(S,I,k),!v.value){(0,n.vJ)(S);return}if(S.classList.contains("expired-view")&&!m.value){(0,n.iV)(S);return}const O=(0,r.Fi)(N.Z.PRODUCT_CARD_RATING,S);if(O.innerText.includes("\u041D\u043E\u0432\u043E\u0435"))return;const V=(0,r.Fi)(N.Z.PRODUCT_NAME,S),H=(0,r.YA)(O,!0),Z=V.innerText,B=(0,f.Ay)(Z,E)||(0,f.JE)(H,x);(0,n.D9)(S,B)},$=function(S){return+S.getAttribute("href").split("-").pop()},u=function(S,I){S>(0,t.Fr)()?I.style.border="3px solid #8ab854":I.style.removeProperty("border")},g=function(S,I,k){S.hasAttribute(o.i.MARK_AS_NEWEST_SEEN_APPENDED)||(S.addEventListener("mousedown",A=>{A.button===1&&A.target!==I&&confirm("\u041F\u043E\u043C\u0435\u0442\u0438\u0442\u044C \u043A\u0430\u043A \u043D\u043E\u0432\u043E\u0435?")&&(T(k),A.preventDefault())}),S.setAttribute(o.i.MARK_AS_NEWEST_SEEN_APPENDED,""))},T=function(S){const I=(0,t.CU)();(0,t.X0)(I),(0,t.Su)(S),D()};var d=e(4921),a=e(5213),f=e(3829),i=e(5884),n=e(5539),r=e(573),b=e(7877),w=e(4521),N=e(2756),p=e(8050),t=e(7234),o=e(1365);const{createGlobalFilter:s}=(0,w.z)(y),E=s("name-filter"),x=s("min-votes-filter",50),m=s("show-expired-filter",!1),v=s("filter-enabled",!0);await P(),y();async function P(){const S=await(0,d.xk)(document,N.Z.DISCUSSIONS);S&&(S.style.position="sticky",S.style.top="0")}h()}catch(s){h(s)}},1)},2756:(C,l,e)=>{e.d(l,{Z:()=>c});const c={DISCUSSIONS:"div.md\\:block.hidden.common-box:nth-of-type(3)",PRODUCT_CARD:".deal-card",PRODUCT_CARD_RATING:".common-box span",PRODUCT_NAME:".custom-card-title",PRODUCT_CARD_LINK:".custom-card-title > a"}},8050:(C,l,e)=>{e.d(l,{r:()=>h});const c={INPUT:{border:"1px solid #d1d5db",borderRadius:"8px",marginLeft:"7px"}},h={FILTERS_CONTAINER:{display:"flex",gridGap:"15px",padding:"11px 19px",marginBottom:".5rem",backgroundColor:"#fff",borderWidth:"1px",borderColor:"rgb(229, 229, 229)",borderRadius:"10px",position:"sticky",zIndex:"11",top:"-1px"},CONTROL:{display:"flex",alignItems:"center"},TEXT_INPUT:{...c.INPUT,width:"180px",padding:"7px 14px",backgroundColor:"#fff"},NUMBER_INPUT:{...c.INPUT,width:"90px",padding:"7px 14px",backgroundColor:"#fff"},CHECKBOX_INPUT:{...c.INPUT,width:"24px",height:"24px"}}}},U={};function R(C){var l=U[C];if(l!==void 0)return l.exports;var e=U[C]={exports:{}};return G[C](e,e.exports,R),e.exports}(()=>{var C=typeof Symbol=="function"?Symbol("webpack queues"):"__webpack_queues__",l=typeof Symbol=="function"?Symbol("webpack exports"):"__webpack_exports__",e=typeof Symbol=="function"?Symbol("webpack error"):"__webpack_error__",c=d=>{d&&d.d<1&&(d.d=1,d.forEach(a=>a.r--),d.forEach(a=>a.r--?a.r++:a()))},h=d=>d.map(a=>{if(a!==null&&typeof a=="object"){if(a[C])return a;if(a.then){var f=[];f.d=0,a.then(r=>{i[l]=r,c(f)},r=>{i[e]=r,c(f)});var i={};return i[C]=r=>r(f),i}}var n={};return n[C]=r=>{},n[l]=a,n});R.a=(d,a,f)=>{var i;f&&((i=[]).d=-1);var n=new Set,r=d.exports,b,w,N,p=new Promise((t,o)=>{N=o,w=t});p[l]=r,p[C]=t=>(i&&t(i),n.forEach(t),p.catch(o=>{})),d.exports=p,a(t=>{b=h(t);var o,s=()=>b.map(x=>{if(x[e])throw x[e];return x[l]}),E=new Promise(x=>{o=()=>x(s),o.r=0;var m=v=>v!==i&&!n.has(v)&&(n.add(v),v&&!v.d&&(o.r++,v.push(o)));b.map(v=>v[C](m))});return o.r?E:s()},t=>(t?N(p[e]=t):w(r),c(i))),i&&i.d<0&&(i.d=0)}})(),R.d=(C,l)=>{for(var e in l)R.o(l,e)&&!R.o(C,e)&&Object.defineProperty(C,e,{enumerable:!0,get:l[e]})},R.o=(C,l)=>Object.prototype.hasOwnProperty.call(C,l);var j=R(9374)})();})();
