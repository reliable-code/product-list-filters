// ==UserScript==
// @name         Pepper product cards filter
// @description  Hide product cards by filter
// @grant        GM_addValueChangeListener
// @grant        GM_setValue
// @grant        GM_getValue
// @match        https://www.pepper.ru/*
// @namespace    https://github.com/reliable-code/product-list-filters
// @version      0.3.73672377
// @icon         https://www.google.com/s2/favicons?sz=64&domain=pepper.ru
// @author       reliable-code
// ==/UserScript==

(()=>{(()=>{"use strict";var $={9928:(C,l,e)=>{e.d(l,{S:()=>f,Sw:()=>w,kU:()=>d,o5:()=>a});var c=e(4921),h=e(5539);function d(p,t,u){const s=o(p,"text",t);return s.value=u,s}function a(p,t,u,s,E,F){const m=o(p,"number",t);return m.value=u,m.step=s,m.min=E,m.max=F,m}function f(p,t,u){const s=o(p,"checkbox",t);return s.checked=u,s}function o(p={},t=null,u=null){const s=S("input",p);return t&&(s.type=t),u&&(s.addEventListener("keyup",(0,c.sg)(u,200)),s.addEventListener("change",(0,c.sg)(u,100))),s}function n(p={},t=null){return S("span",p,t)}function r(p={},t=null,u=null){const s=S("a",p,t);return u&&(s.href=u),s}function b(p={},t=null,u=null){const s=S("button",p,t);return u&&(s.onclick=u),s}function w(p={},t=null){return S("div",p,t)}function S(p,t,u=null){if(typeof t!="object"||t===null)throw new TypeError("styles should be an object");const s=document.createElement(p);return(0,h.ZM)(s,t),u&&(s.innerHTML=u),s}},573:(C,l,e)=>{e.d(l,{Fi:()=>d,YA:()=>n,fI:()=>a});var c=e(4214);function h(t,u=document){return!!u.querySelector(t)}function d(t,u=document,s=!1){const E=u.querySelector(t);return s&&!E&&console.log(`No element found for selector: ${t}`),E}function a(t,u=document,s=!1){const E=u.querySelectorAll(t);return s&&!E.length&&console.log(`No elements found for selector: ${t}`),E}function f(t,u,s){return[...t.querySelectorAll(u)].find(E=>E.textContent.trim().includes(s))}function o(t,u,s=!1,E=!1){const F=d(u,t,!0);return n(F,s,E)}function n(t,u=!1,s=!1,E=null){if(!t)return E===null?(console.log("No element found"),null):E;const F=t.innerText;return w(F,u,s)}function r(t,u,s=!1){const E=t[u];return n(E,s)}function b(t,u=!1,s=!1){const E=t.textContent;return w(E,u,s)}function w(t,u,s){return u&&(t=(0,c.zr)(t)),s&&(t=t.replace(",",".")),+t}function S(t){return[...t.childNodes].find(u=>u.nodeType===Node.TEXT_NODE)}function p(t){const u=s=>s.nodeType===Node.TEXT_NODE&&s.textContent.trim()!==""?[s]:[...s.childNodes].flatMap(u);return u(t)}},5539:(C,l,e)=>{e.d(l,{D9:()=>u,ZM:()=>x,iV:()=>E,vJ:()=>s});function c(i,N){i.parentNode.insertBefore(N,i.nextSibling)}function h(i){i.style.display="none"}function d(i){w(i),h(i)}function a(i){i.intersectionObserver||runOnceOnIntersection(i,()=>h(i))}function f(i){i.style.display=""}function o(i){const N=b(i);i.style.display=N}function n(i,N){N?h(i):f(i)}function r(i,N){N?a(i):(clearIntersectionObserver(i),f(i))}function b(i){return w(i),i.defaultDisplay}function w(i){if(i.defaultDisplay)return;const{display:N}=getComputedStyle(i);i.defaultDisplay=N}function S(){return{show:[],hide:[]}}function p(i,N,I){i?N.hide.push(I):N.show.push(I)}function t(i){i.show.forEach(f),i.hide.forEach(h)}function u(i,N,I=.3){N?E(i,I):s(i)}function s(i){i.style.opacity=""}function E(i,N=.3){i.style.opacity=N}function F(i){i.style.order=""}function m(i,N){i.style.order=N}function v(i,N){i.style.background=N}function g(i,N="custom-global-style"){let I=document.getElementById(N);I||(I=document.createElement("style"),I.id=N,I.type="text/css",document.head.appendChild(I)),I.textContent=i}function x(i,N){Object.assign(i.style,N)}function k(i){return Object.entries(i).map(([N,I])=>`${N.replace(/([A-Z])/g,"-$1").toLowerCase()}: ${I};`).join(" ")}function G(i){return i?i.split(";").filter(N=>N.trim()!=="").reduce((N,I)=>{const[P,V]=I.split(":").map(T=>T.trim()),y=P.replace(/-([a-z])/g,(T,D)=>D.toUpperCase());return N[y]=V,N},{}):{}}},4921:(C,l,e)=>{e.d(l,{sg:()=>d,xk:()=>c});async function c(o,n,r=null){const b=o.querySelector(n);return b?Promise.resolve(b):new Promise(w=>{const S=new MutationObserver(t);S.observe(o,{childList:!0,subtree:!0});let p=null;r&&(p=setTimeout(()=>{S.disconnect(),console.log(`No element found for selector: ${n}`),w(null)},r));function t(){const u=o.querySelector(n);u&&(p&&clearTimeout(p),S.disconnect(),w(u))}})}async function h(o,n){return o.querySelector(n)?new Promise(b=>{const w=new MutationObserver(S);w.observe(o,{childList:!0,subtree:!0});function S(){o.querySelector(n)||(w.disconnect(),b())}}):Promise.resolve()}function d(o,n=250){let r;return(...b)=>{clearTimeout(r),r=setTimeout(()=>o(...b),n)}}function a(o,n){const r=new IntersectionObserver(b=>{b.forEach(w=>{w.isIntersecting&&(n(),f(o))})});o.intersectionObserver=r,r.observe(o)}function f(o){o.intersectionObserver&&(o.intersectionObserver.disconnect(),o.intersectionObserver=null)}},3829:(C,l,e)=>{e.d(l,{Ay:()=>h,JE:()=>a});var c=e(8355);function h(n,r){return!d(n,r)}function d(n,r){if(!r.value)return!0;const b=n.toLowerCase(),w=(0,c.R)(r),S=[],p=[];return w.forEach(t=>{if(t.startsWith("!")){const u=t.substring(1);u&&p.push(u)}else S.push(t)}),S.every(t=>b.includes(t))&&p.every(t=>!b.includes(t))}function a(n,r){return r.value!=null&&n<r.value}function f(n,r){return r.value!=null&&n>r.value}function o(n,r){return r.value&&n!==r.value}},4521:(C,l,e)=>{e.d(l,{z:()=>h});var c=e(3048);function h(d,a=null){return{createGlobalFilter(f,o=null,n=d){return c.V.create(f,o,n)},createSectionFilter(f,o=null,n=d){if(!a)throw new Error("sectionId must be provided to use createSectionFilter.");return c.V.createWithCompositeKey(a,f,o,n)}}}},5884:(C,l,e)=>{e.d(l,{Hw:()=>a,Nm:()=>h,nW:()=>d});var c=e(9928);function h(f,o,n={},r={}){const b=(0,c.Sw)(n,f),w=(0,c.kU)(r,o.updateValueFromEvent,o.value);return b.append(w),b}function d(f,o,n,r,b,w={},S={}){const p=(0,c.Sw)(w,f),t=(0,c.o5)(S,o.updateValueFromEvent,o.value,n,r,b);return p.append(t),p}function a(f,o,n={},r={}){const b=(0,c.Sw)(n,f),w=(0,c.S)(r,o.updateValueFromEvent,o.value);return b.append(w),b}},7877:(C,l,e)=>{e.d(l,{E9:()=>h,pW:()=>F});var c=e(5884);function h(m,v={},g={}){return(0,c.Nm)("\u041F\u043E\u0438\u0441\u043A: ",m,v,g)}function d(m,v={},g={},x=.1,k=3){return createNumberFilterControl("\u041C\u0438\u043D. \u0440\u0435\u0439\u0442\u0438\u043D\u0433: ",m,x,k,5,v,g)}function a(m,v={},g={},x=.1,k=3){return createNumberFilterControl("\u041C\u0430\u043A\u0441. \u0440\u0435\u0439\u0442\u0438\u043D\u0433: ",m,x,k,5,v,g)}function f(m,v={},g={}){return n("\u041C\u0438\u043D. \u043E\u0442\u0437\u044B\u0432\u043E\u0432: ",m,v,g)}function o(m,v={},g={}){return n("\u041C\u0430\u043A\u0441. \u043E\u0442\u0437\u044B\u0432\u043E\u0432: ",m,v,g)}function n(m,v,g={},x={}){return createNumberFilterControl(m,v,"1","1","999999",g,x)}function r(m,v={},g={}){return b("\u041C\u0438\u043D. \u0441\u043A\u0438\u0434\u043A\u0430: ",m,v,g)}function b(m,v,g={},x={}){return createNumberFilterControl(m,v,"5","0","100",g,x)}function w(m,v={},g={}){return createNumberFilterControl("\u041C\u0438\u043D. \u043A\u0435\u0448\u0431\u0435\u043A: ",m,"5","0","100",v,g)}function S(m,v,g={},x={},k="250"){return createNumberFilterControl(m,v,k,"0","1000000",g,x)}function p(m,v={},g={},x="25"){return S("\u041C\u0438\u043D. \u0446\u0435\u043D\u0430: ",m,v,g,x)}function t(m,v={},g={},x="25"){return S("\u041C\u0430\u043A\u0441. \u0446\u0435\u043D\u0430: ",m,v,g,x)}function u(m,v,g={},x={}){return createNumberFilterControl(m,v,"1","0","99999",g,x)}function s(m,v={},g={}){return createCheckboxFilterControl("\u0411\u0435\u0437 \u0440\u0435\u0439\u0442\u0438\u043D\u0433\u0430: ",m,v,g)}function E(m,v={},g={}){return createCheckboxFilterControl("\u0421 \u0444\u043E\u0442\u043E: ",m,v,g)}function F(m,v={},g={}){return(0,c.Hw)("\u0412\u043A\u043B: ",m,v,g)}},8355:(C,l,e)=>{e.d(l,{R:()=>c});function c(d){return d.value.toLowerCase().split(",").map(a=>a.trim()).filter(a=>a!=="")}function h(d){return c(d).filter(a=>!a.startsWith("!"))}},5213:(C,l,e)=>{e.d(l,{b:()=>d});var c=e(9928),h=e(573);function d(a,f,o=!1,n="customFiltersContainer"){let r=(0,h.Fi)(`#${n}`,a);if(r)if(o)r.remove();else return;r=(0,c.Sw)(),r.id=n,f(r,a)}},8200:(C,l,e)=>{e.d(l,{s:()=>c});function c(h){const{target:d}=h,{type:a}=d;switch(a){case"text":return`"${d.value}"`;case"number":return d.value;case"checkbox":return d.checked;default:return console.log(`Unknown input type: ${a}`),null}}},157:(C,l,e)=>{e.d(l,{Fg:()=>c,vx:()=>d});const c=window.GM_setValue,h=window.GM.setValue,d=window.GM_getValue,a=window.GM_addValueChangeListener},1870:(C,l,e)=>{e.d(l,{j:()=>c});class c{constructor(d,a){this.value=d,this.onChange=a}onChangeIfDefined=()=>{this.onChange&&this.onChange()}}},3048:(C,l,e)=>{e.d(l,{V:()=>f});var c=e(1870),h=e(8200),d=e(3976),a=e(157);class f extends c.j{constructor(n,r=null,b=null){super((0,a.vx)(n,r),b),this.storageKey=n,this.defaultValue=r}static create(n,r=null,b=null){return new f(n,r,b)}static createWithCompositeKey(n,r,b=null,w=null){const S=`${n}-${r}`;return new f(S,b,w)}updateValueFromEvent=n=>{const r=(0,h.s)(n),b=(0,d.$)(r);this.updateValue(b)};updateValue(n){this.value!==n&&((0,a.Fg)(this.storageKey,n),this.value=n,this.onChangeIfDefined())}clearValue(){this.updateValue(null)}resetValue(){this.updateValue(this.defaultValue)}}},3976:(C,l,e)=>{e.d(l,{$:()=>c});function c(h){return h===""?null:JSON.parse(h)}},4214:(C,l,e)=>{e.d(l,{zr:()=>h});function c(f){return f.replace(/\D/g,"")}function h(f){return f.replace(/[^\d.,-]/g,"")}function d(f){return f.replace(/\s/g,"")}function a(f){return f.charAt(0).toUpperCase()+f.slice(1)}},1365:(C,l,e)=>{e.d(l,{i:()=>c});const c={MARK_AS_NEWEST_SEEN_APPENDED:"markAsNewestSeenAppended"}},7234:(C,l,e)=>{e.d(l,{CU:()=>d,Fr:()=>f,Su:()=>h,X0:()=>a});var c=e(157);function h(o){(0,c.Fg)("newest-seen-product-id",o)}function d(){return(0,c.vx)("newest-seen-product-id")}function a(o){(0,c.Fg)("prev-newest-seen-product-id",o)}function f(){return(0,c.vx)("prev-newest-seen-product-id")}},9374:(C,l,e)=>{e.a(C,async(c,h)=>{try{let g=function(){const y=(0,r.fI)(S.Z.PRODUCT_CARD);if(y.length){const T=y[0].parentElement;(0,a.b)(T,x),k(),new MutationObserver(k).observe(T,{childList:!0,subtree:!0})}},x=function(y,T){(0,n.ZM)(y,p.r.FILTERS_CONTAINER);const D=(0,b.E9)(E,p.r.CONTROL,p.r.TEXT_INPUT),R=(0,o.nW)("\u041C\u0438\u043D\u0438\u043C\u0430\u043B\u044C\u043D\u043E \u0433\u043E\u043B\u043E\u0441\u043E\u0432: ",F,"50","0","10000",p.r.CONTROL,p.r.NUMBER_INPUT),O=(0,o.Hw)("\u0417\u0430\u0432\u0435\u0440\u0448\u0451\u043D\u043D\u044B\u0435: ",m,p.r.CONTROL,p.r.CHECKBOX_INPUT),U=(0,b.pW)(v,p.r.CONTROL,p.r.CHECKBOX_INPUT);y.append(D,R,O,U),T.prepend(y)},k=function(){(0,r.fI)(S.Z.PRODUCT_CARD).forEach(G)},G=function(y){const T=(0,r.Fi)(S.Z.PRODUCT_CARD_LINK,y),D=i(T);if(N(D,y),I(y,T,D),!v.value){(0,n.vJ)(y);return}if(y.classList.contains("expired-view")&&!m.value){(0,n.iV)(y);return}const O=(0,r.Fi)(S.Z.PRODUCT_CARD_RATING,y);if(O.innerText.includes("\u041D\u043E\u0432\u043E\u0435"))return;const U=(0,r.Fi)(S.Z.PRODUCT_NAME,y),H=(0,r.YA)(O,!0),Z=U.innerText,j=(0,f.Ay)(Z,E)||(0,f.JE)(H,F);(0,n.D9)(y,j)},i=function(y){return+y.getAttribute("href").split("-").pop()},N=function(y,T){y>(0,t.Fr)()?T.style.border="3px solid #8ab854":T.style.removeProperty("border")},I=function(y,T,D){y.hasAttribute(u.i.MARK_AS_NEWEST_SEEN_APPENDED)||(y.addEventListener("mousedown",R=>{R.button===1&&R.target!==T&&confirm("\u041F\u043E\u043C\u0435\u0442\u0438\u0442\u044C \u043A\u0430\u043A \u043D\u043E\u0432\u043E\u0435?")&&(P(D),R.preventDefault())}),y.setAttribute(u.i.MARK_AS_NEWEST_SEEN_APPENDED,""))},P=function(y){const T=(0,t.CU)();(0,t.X0)(T),(0,t.Su)(y),k()};var d=e(4921),a=e(5213),f=e(3829),o=e(5884),n=e(5539),r=e(573),b=e(7877),w=e(4521),S=e(2756),p=e(8050),t=e(7234),u=e(1365);const{createGlobalFilter:s}=(0,w.z)(g),E=s("name-filter"),F=s("min-votes-filter",50),m=s("show-expired-filter",!1),v=s("filter-enabled",!0);await V(),g();async function V(){const y=await(0,d.xk)(document,S.Z.DISCUSSIONS);y&&(y.style.position="sticky",y.style.top="0")}h()}catch(s){h(s)}},1)},2756:(C,l,e)=>{e.d(l,{Z:()=>c});const c={DISCUSSIONS:"div.md\\:block.hidden.common-box:nth-of-type(3)",PRODUCT_CARD:".deal-card",PRODUCT_CARD_RATING:".common-box span",PRODUCT_NAME:".custom-card-title",PRODUCT_CARD_LINK:".custom-card-title > a"}},8050:(C,l,e)=>{e.d(l,{r:()=>h});const c={INPUT:{border:"1px solid #d1d5db",borderRadius:"8px",marginLeft:"7px"}},h={FILTERS_CONTAINER:{display:"flex",gridGap:"15px",padding:"11px 19px",marginBottom:".5rem",backgroundColor:"#fff",borderWidth:"1px",borderColor:"rgb(229, 229, 229)",borderRadius:"10px",position:"sticky",zIndex:"11",top:"-1px"},CONTROL:{display:"flex",alignItems:"center"},TEXT_INPUT:{...c.INPUT,width:"180px",padding:"7px 14px",backgroundColor:"#fff"},NUMBER_INPUT:{...c.INPUT,width:"90px",padding:"7px 14px",backgroundColor:"#fff"},CHECKBOX_INPUT:{...c.INPUT,width:"24px",height:"24px"}}}},L={};function A(C){var l=L[C];if(l!==void 0)return l.exports;var e=L[C]={exports:{}};return $[C](e,e.exports,A),e.exports}(()=>{var C=typeof Symbol=="function"?Symbol("webpack queues"):"__webpack_queues__",l=typeof Symbol=="function"?Symbol("webpack exports"):"__webpack_exports__",e=typeof Symbol=="function"?Symbol("webpack error"):"__webpack_error__",c=d=>{d&&d.d<1&&(d.d=1,d.forEach(a=>a.r--),d.forEach(a=>a.r--?a.r++:a()))},h=d=>d.map(a=>{if(a!==null&&typeof a=="object"){if(a[C])return a;if(a.then){var f=[];f.d=0,a.then(r=>{o[l]=r,c(f)},r=>{o[e]=r,c(f)});var o={};return o[C]=r=>r(f),o}}var n={};return n[C]=r=>{},n[l]=a,n});A.a=(d,a,f)=>{var o;f&&((o=[]).d=-1);var n=new Set,r=d.exports,b,w,S,p=new Promise((t,u)=>{S=u,w=t});p[l]=r,p[C]=t=>(o&&t(o),n.forEach(t),p.catch(u=>{})),d.exports=p,a(t=>{b=h(t);var u,s=()=>b.map(F=>{if(F[e])throw F[e];return F[l]}),E=new Promise(F=>{u=()=>F(s),u.r=0;var m=v=>v!==o&&!n.has(v)&&(n.add(v),v&&!v.d&&(u.r++,v.push(u)));b.map(v=>v[C](m))});return u.r?E:s()},t=>(t?S(p[e]=t):w(r),c(o))),o&&o.d<0&&(o.d=0)}})(),A.d=(C,l)=>{for(var e in l)A.o(l,e)&&!A.o(C,e)&&Object.defineProperty(C,e,{enumerable:!0,get:l[e]})},A.o=(C,l)=>Object.prototype.hasOwnProperty.call(C,l);var B=A(9374)})();})();
