// ==UserScript==
// @name         Pepper product cards filter
// @description  Hide product cards by filter
// @grant        GM_addValueChangeListener
// @grant        GM_setValue
// @grant        GM_getValue
// @match        https://www.pepper.ru/*
// @namespace    https://github.com/reliable-code/product-list-filters
// @version      1.0.73696917
// @icon         https://www.google.com/s2/favicons?sz=64&domain=pepper.ru
// @author       reliable-code
// ==/UserScript==

(()=>{(()=>{"use strict";var G={9928:(g,l,e)=>{e.d(l,{S:()=>f,Sw:()=>E,kU:()=>d,o5:()=>a});var s=e(4921),b=e(5539);function d(p,t,o){const c=i(p,"text",t);return c.value=o,c}function a(p,t,o,c,w,F){const k=i(p,"number",t);return k.value=o,k.step=c,k.min=w,k.max=F,k}function f(p,t,o){const c=i(p,"checkbox",t);return c.checked=o,c}function i(p={},t=null,o=null){const c=N("input",p);return t&&(c.type=t),o&&(c.addEventListener("keyup",(0,s.sg)(o,200)),c.addEventListener("change",(0,s.sg)(o,100))),c}function n(p={},t=null){return N("span",p,t)}function r(p={},t=null,o=null){const c=N("a",p,t);return o&&(c.href=o),c}function v(p={},t=null,o=null){const c=N("button",p,t);return o&&(c.onclick=o),c}function E(p={},t=null){return N("div",p,t)}function N(p,t,o=null){if(typeof t!="object"||t===null)throw new TypeError("styles should be an object");const c=document.createElement(p);return(0,b.ZM)(c,t),o&&(c.innerHTML=o),c}},573:(g,l,e)=>{e.d(l,{Fi:()=>d,YA:()=>n,fI:()=>a});var s=e(4214);function b(t,o=document){return!!o.querySelector(t)}function d(t,o=document,c=!1){const w=o.querySelector(t);return c&&!w&&console.log(`No element found for selector: ${t}`),w}function a(t,o=document,c=!1){const w=o.querySelectorAll(t);return c&&!w.length&&console.log(`No elements found for selector: ${t}`),w}function f(t,o,c){return[...t.querySelectorAll(o)].find(w=>w.textContent.trim().includes(c))}function i(t,o,c=!1,w=!1){const F=d(o,t,!0);return n(F,c,w)}function n(t,o=!1,c=!1,w=null){if(!t)return w===null?(console.log("No element found"),null):w;const F=t.innerText;return E(F,o,c)}function r(t,o,c=!1){const w=t[o];return n(w,c)}function v(t,o=!1,c=!1){const w=t.textContent;return E(w,o,c)}function E(t,o,c){return o&&(t=(0,s.zr)(t)),c&&(t=t.replace(",",".")),+t}function N(t){return[...t.childNodes].find(o=>o.nodeType===Node.TEXT_NODE)}function p(t){const o=c=>c.nodeType===Node.TEXT_NODE&&c.textContent.trim()!==""?[c]:[...c.childNodes].flatMap(o);return o(t)}},5539:(g,l,e)=>{e.d(l,{D9:()=>o,ZM:()=>x,iV:()=>w,vJ:()=>c});function s(u,C){u.parentNode.insertBefore(C,u.nextSibling)}function b(u){u.style.display="none"}function d(u){E(u),b(u)}function a(u){u.intersectionObserver||runOnceOnIntersection(u,()=>b(u))}function f(u){u.style.display=""}function i(u){const C=v(u);u.style.display=C}function n(u,C){C?b(u):f(u)}function r(u,C){C?a(u):(clearIntersectionObserver(u),f(u))}function v(u){return E(u),u.defaultDisplay}function E(u){if(u.defaultDisplay)return;const{display:C}=getComputedStyle(u);u.defaultDisplay=C}function N(){return{show:[],hide:[]}}function p(u,C,T){u?C.hide.push(T):C.show.push(T)}function t(u){u.show.forEach(f),u.hide.forEach(b)}function o(u,C,T=.3){C?w(u,T):c(u)}function c(u){u.style.opacity=""}function w(u,C=.3){u.style.opacity=C}function F(u){u.style.order=""}function k(u,C){u.style.order=C}function m(u,C){u.style.background=C}function h(){const u=getURLQueryParam("scrollTo");if(!u)return;const C=document.getElementById(u);C?C.scrollIntoView():console.log(`Element with ID "${u}" was not found.`)}function y(u,C="custom-global-style"){let T=document.getElementById(C);T||(T=document.createElement("style"),T.id=C,T.type="text/css",document.head.appendChild(T)),T.textContent=u}function x(u,C){Object.assign(u.style,C)}function A(u){return Object.entries(u).map(([C,T])=>`${C.replace(/([A-Z])/g,"-$1").toLowerCase()}: ${T};`).join(" ")}function $(u){return u?u.split(";").filter(C=>C.trim()!=="").reduce((C,T)=>{const[V,S]=T.split(":").map(D=>D.trim()),I=V.replace(/-([a-z])/g,(D,R)=>R.toUpperCase());return C[I]=S,C},{}):{}}},4921:(g,l,e)=>{e.d(l,{sg:()=>d,xk:()=>s});async function s(i,n,r=null){const v=i.querySelector(n);return v?Promise.resolve(v):new Promise(E=>{const N=new MutationObserver(t);N.observe(i,{childList:!0,subtree:!0});let p=null;r&&(p=setTimeout(()=>{N.disconnect(),console.log(`No element found for selector: ${n}`),E(null)},r));function t(){const o=i.querySelector(n);o&&(p&&clearTimeout(p),N.disconnect(),E(o))}})}async function b(i,n){return i.querySelector(n)?new Promise(v=>{const E=new MutationObserver(N);E.observe(i,{childList:!0,subtree:!0});function N(){i.querySelector(n)||(E.disconnect(),v())}}):Promise.resolve()}function d(i,n=250){let r;return(...v)=>{clearTimeout(r),r=setTimeout(()=>i(...v),n)}}function a(i,n){const r=new IntersectionObserver(v=>{v.forEach(E=>{E.isIntersecting&&(n(),f(i))})});i.intersectionObserver=r,r.observe(i)}function f(i){i.intersectionObserver&&(i.intersectionObserver.disconnect(),i.intersectionObserver=null)}},3829:(g,l,e)=>{e.d(l,{Ay:()=>b,JE:()=>a});var s=e(8355);function b(n,r){return!d(n,r)}function d(n,r){if(!r.value)return!0;const v=n.toLowerCase(),E=(0,s.R)(r),N=[],p=[];return E.forEach(t=>{if(t.startsWith("!")){const o=t.substring(1);o&&p.push(o)}else N.push(t)}),N.every(t=>v.includes(t))&&p.every(t=>!v.includes(t))}function a(n,r){return r.value!=null&&n<r.value}function f(n,r){return r.value!=null&&n>r.value}function i(n,r){return r.value&&n!==r.value}},4521:(g,l,e)=>{e.d(l,{z:()=>b});var s=e(3048);function b(d,a=null){return{createGlobalFilter(f,i=null,n=d){return s.V.create(f,i,n)},createSectionFilter(f,i=null,n=d){if(!a)throw new Error("sectionId must be provided to use createSectionFilter.");return s.V.createWithCompositeKey(a,f,i,n)}}}},5884:(g,l,e)=>{e.d(l,{Hw:()=>a,Nm:()=>b,nW:()=>d});var s=e(9928);function b(f,i,n={},r={}){const v=(0,s.Sw)(n,f),E=(0,s.kU)(r,i.updateValueFromEvent,i.value);return v.append(E),v}function d(f,i,n,r,v,E={},N={}){const p=(0,s.Sw)(E,f),t=(0,s.o5)(N,i.updateValueFromEvent,i.value,n,r,v);return p.append(t),p}function a(f,i,n={},r={}){const v=(0,s.Sw)(n,f),E=(0,s.S)(r,i.updateValueFromEvent,i.value);return v.append(E),v}},7877:(g,l,e)=>{e.d(l,{E9:()=>b,pW:()=>k});var s=e(5884);function b(m,h={},y={}){return(0,s.Nm)("\u041F\u043E\u0438\u0441\u043A: ",m,h,y)}function d(m,h={},y={},x=.1,A=3){return createNumberFilterControl("\u041C\u0438\u043D. \u0440\u0435\u0439\u0442\u0438\u043D\u0433: ",m,x,A,5,h,y)}function a(m,h={},y={},x=.1,A=3){return createNumberFilterControl("\u041C\u0430\u043A\u0441. \u0440\u0435\u0439\u0442\u0438\u043D\u0433: ",m,x,A,5,h,y)}function f(m,h={},y={}){return n("\u041C\u0438\u043D. \u043E\u0442\u0437\u044B\u0432\u043E\u0432: ",m,h,y)}function i(m,h={},y={}){return n("\u041C\u0430\u043A\u0441. \u043E\u0442\u0437\u044B\u0432\u043E\u0432: ",m,h,y)}function n(m,h,y={},x={}){return createNumberFilterControl(m,h,"1","1","999999",y,x)}function r(m,h={},y={}){return v("\u041C\u0438\u043D. \u0441\u043A\u0438\u0434\u043A\u0430: ",m,h,y)}function v(m,h,y={},x={}){return createNumberFilterControl(m,h,"5","0","100",y,x)}function E(m,h={},y={}){return createNumberFilterControl("\u041C\u0438\u043D. \u043A\u0435\u0448\u0431\u0435\u043A: ",m,"5","0","100",h,y)}function N(m,h,y={},x={},A="250"){return createNumberFilterControl(m,h,A,"0","1000000",y,x)}function p(m,h={},y={},x="25"){return N("\u041C\u0438\u043D. \u0446\u0435\u043D\u0430: ",m,h,y,x)}function t(m,h={},y={},x="25"){return N("\u041C\u0430\u043A\u0441. \u0446\u0435\u043D\u0430: ",m,h,y,x)}function o(m,h,y={},x={}){return createNumberFilterControl(m,h,"1","0","99999",y,x)}function c(m,h={},y={}){return createCheckboxFilterControl("\u0411\u0435\u0437 \u0440\u0435\u0439\u0442\u0438\u043D\u0433\u0430: ",m,h,y)}function w(m,h={},y={}){return createCheckboxFilterControl("\u0421 \u0444\u043E\u0442\u043E: ",m,h,y)}function F(m,h={},y={}){return createCheckboxFilterControl("\u041F\u0440\u043E\u0433\u0440\u0443\u0437\u043A\u0430: ",m,h,y)}function k(m,h={},y={}){return(0,s.Hw)("\u0412\u043A\u043B: ",m,h,y)}},8355:(g,l,e)=>{e.d(l,{R:()=>s});function s(d){return d.value.toLowerCase().split(",").map(a=>a.trim()).filter(a=>a!=="")}function b(d){return s(d).filter(a=>!a.startsWith("!"))}},5213:(g,l,e)=>{e.d(l,{b:()=>d});var s=e(9928),b=e(573);function d(a,f,i=!1,n="customFiltersContainer"){let r=(0,b.Fi)(`#${n}`,a);if(r)if(i)r.remove();else return;r=(0,s.Sw)(),r.id=n,f(r,a)}},8200:(g,l,e)=>{e.d(l,{s:()=>s});function s(b){const{target:d}=b,{type:a}=d;switch(a){case"text":return`"${d.value}"`;case"number":return d.value;case"checkbox":return d.checked;default:return console.log(`Unknown input type: ${a}`),null}}},157:(g,l,e)=>{e.d(l,{Fg:()=>s,vx:()=>d});const s=window.GM_setValue,b=window.GM.setValue,d=window.GM_getValue,a=window.GM_addValueChangeListener},1870:(g,l,e)=>{e.d(l,{j:()=>s});class s{constructor(d,a){this.value=d,this.onChange=a}onChangeIfDefined=()=>{this.onChange&&this.onChange()}}},3048:(g,l,e)=>{e.d(l,{V:()=>f});var s=e(1870),b=e(8200),d=e(3976),a=e(157);class f extends s.j{constructor(n,r=null,v=null){super((0,a.vx)(n,r),v),this.storageKey=n,this.defaultValue=r}static create(n,r=null,v=null){return new f(n,r,v)}static createWithCompositeKey(n,r,v=null,E=null){const N=`${n}-${r}`;return new f(N,v,E)}updateValueFromEvent=n=>{const r=(0,b.s)(n),v=(0,d.$)(r);this.updateValue(v)};updateValue(n){this.value!==n&&((0,a.Fg)(this.storageKey,n),this.value=n,this.onChangeIfDefined())}clearValue(){this.updateValue(null)}resetValue(){this.updateValue(this.defaultValue)}}},3976:(g,l,e)=>{e.d(l,{$:()=>s});function s(b){return b===""?null:JSON.parse(b)}},4214:(g,l,e)=>{e.d(l,{zr:()=>b});function s(f){return f.replace(/\D/g,"")}function b(f){return f.replace(/[^\d.,-]/g,"")}function d(f){return f.replace(/\s/g,"")}function a(f){return f.charAt(0).toUpperCase()+f.slice(1)}},1365:(g,l,e)=>{e.d(l,{i:()=>s});const s={MARK_AS_NEWEST_SEEN_APPENDED:"markAsNewestSeenAppended"}},7234:(g,l,e)=>{e.d(l,{CU:()=>d,Fr:()=>f,Su:()=>b,X0:()=>a});var s=e(157);function b(i){(0,s.Fg)("newest-seen-product-id",i)}function d(){return(0,s.vx)("newest-seen-product-id")}function a(i){(0,s.Fg)("prev-newest-seen-product-id",i)}function f(){return(0,s.vx)("prev-newest-seen-product-id")}},9374:(g,l,e)=>{e.a(g,async(s,b)=>{try{let h=function(){const S=(0,r.fI)(N.Z.PRODUCT_CARD);if(S.length){const I=S[0].parentElement;(0,a.b)(I,y),x(),new MutationObserver(x).observe(I,{childList:!0,subtree:!0})}},y=function(S,I){(0,n.ZM)(S,p.r.FILTERS_CONTAINER);const D=(0,v.E9)(w,p.r.CONTROL,p.r.TEXT_INPUT),R=(0,i.nW)("\u041C\u0438\u043D\u0438\u043C\u0430\u043B\u044C\u043D\u043E \u0433\u043E\u043B\u043E\u0441\u043E\u0432: ",F,"50","0","10000",p.r.CONTROL,p.r.NUMBER_INPUT),P=(0,i.Hw)("\u0417\u0430\u0432\u0435\u0440\u0448\u0451\u043D\u043D\u044B\u0435: ",k,p.r.CONTROL,p.r.CHECKBOX_INPUT),U=(0,v.pW)(m,p.r.CONTROL,p.r.CHECKBOX_INPUT);S.append(D,R,P,U),I.prepend(S)},x=function(){(0,r.fI)(N.Z.PRODUCT_CARD).forEach(A)},A=function(S){const I=(0,r.Fi)(N.Z.PRODUCT_CARD_LINK,S),D=$(I);if(u(D,S),C(S,I,D),!m.value){(0,n.vJ)(S);return}if(S.classList.contains("expired-view")&&!k.value){(0,n.iV)(S);return}const P=(0,r.Fi)(N.Z.PRODUCT_CARD_RATING,S);if(P.innerText.includes("\u041D\u043E\u0432\u043E\u0435"))return;const U=(0,r.Fi)(N.Z.PRODUCT_NAME,S),H=(0,r.YA)(P,!0),Z=U.innerText,B=(0,f.Ay)(Z,w)||(0,f.JE)(H,F);(0,n.D9)(S,B)},$=function(S){return+S.getAttribute("href").split("-").pop()},u=function(S,I){S>(0,t.Fr)()?I.style.border="3px solid #8ab854":I.style.removeProperty("border")},C=function(S,I,D){S.hasAttribute(o.i.MARK_AS_NEWEST_SEEN_APPENDED)||(S.addEventListener("mousedown",R=>{R.button===1&&R.target!==I&&confirm("\u041F\u043E\u043C\u0435\u0442\u0438\u0442\u044C \u043A\u0430\u043A \u043D\u043E\u0432\u043E\u0435?")&&(T(D),R.preventDefault())}),S.setAttribute(o.i.MARK_AS_NEWEST_SEEN_APPENDED,""))},T=function(S){const I=(0,t.CU)();(0,t.X0)(I),(0,t.Su)(S),x()};var d=e(4921),a=e(5213),f=e(3829),i=e(5884),n=e(5539),r=e(573),v=e(7877),E=e(4521),N=e(2756),p=e(8050),t=e(7234),o=e(1365);const{createGlobalFilter:c}=(0,E.z)(h),w=c("name-filter"),F=c("min-votes-filter",50),k=c("show-expired-filter",!1),m=c("filter-enabled",!0);await V(),h();async function V(){const S=await(0,d.xk)(document,N.Z.DISCUSSIONS);S&&(S.style.position="sticky",S.style.top="0")}b()}catch(c){b(c)}},1)},2756:(g,l,e)=>{e.d(l,{Z:()=>s});const s={DISCUSSIONS:"div.md\\:block.hidden.common-box:nth-of-type(3)",PRODUCT_CARD:".deal-card",PRODUCT_CARD_RATING:".common-box span",PRODUCT_NAME:".custom-card-title",PRODUCT_CARD_LINK:".custom-card-title > a"}},8050:(g,l,e)=>{e.d(l,{r:()=>b});const s={INPUT:{border:"1px solid #d1d5db",borderRadius:"8px",marginLeft:"7px"}},b={FILTERS_CONTAINER:{display:"flex",gridGap:"15px",padding:"11px 19px",marginBottom:".5rem",backgroundColor:"#fff",borderWidth:"1px",borderColor:"rgb(229, 229, 229)",borderRadius:"10px",position:"sticky",zIndex:"11",top:"-1px"},CONTROL:{display:"flex",alignItems:"center"},TEXT_INPUT:{...s.INPUT,width:"180px",padding:"7px 14px",backgroundColor:"#fff"},NUMBER_INPUT:{...s.INPUT,width:"90px",padding:"7px 14px",backgroundColor:"#fff"},CHECKBOX_INPUT:{...s.INPUT,width:"24px",height:"24px"}}}},L={};function O(g){var l=L[g];if(l!==void 0)return l.exports;var e=L[g]={exports:{}};return G[g](e,e.exports,O),e.exports}(()=>{var g=typeof Symbol=="function"?Symbol("webpack queues"):"__webpack_queues__",l=typeof Symbol=="function"?Symbol("webpack exports"):"__webpack_exports__",e=typeof Symbol=="function"?Symbol("webpack error"):"__webpack_error__",s=d=>{d&&d.d<1&&(d.d=1,d.forEach(a=>a.r--),d.forEach(a=>a.r--?a.r++:a()))},b=d=>d.map(a=>{if(a!==null&&typeof a=="object"){if(a[g])return a;if(a.then){var f=[];f.d=0,a.then(r=>{i[l]=r,s(f)},r=>{i[e]=r,s(f)});var i={};return i[g]=r=>r(f),i}}var n={};return n[g]=r=>{},n[l]=a,n});O.a=(d,a,f)=>{var i;f&&((i=[]).d=-1);var n=new Set,r=d.exports,v,E,N,p=new Promise((t,o)=>{N=o,E=t});p[l]=r,p[g]=t=>(i&&t(i),n.forEach(t),p.catch(o=>{})),d.exports=p,a(t=>{v=b(t);var o,c=()=>v.map(F=>{if(F[e])throw F[e];return F[l]}),w=new Promise(F=>{o=()=>F(c),o.r=0;var k=m=>m!==i&&!n.has(m)&&(n.add(m),m&&!m.d&&(o.r++,m.push(o)));v.map(m=>m[g](k))});return o.r?w:c()},t=>(t?N(p[e]=t):E(r),s(i))),i&&i.d<0&&(i.d=0)}})(),O.d=(g,l)=>{for(var e in l)O.o(l,e)&&!O.o(g,e)&&Object.defineProperty(g,e,{enumerable:!0,get:l[e]})},O.o=(g,l)=>Object.prototype.hasOwnProperty.call(g,l);var j=O(9374)})();})();
