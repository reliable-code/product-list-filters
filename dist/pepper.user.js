// ==UserScript==
// @name         Pepper product cards filter
// @description  Hide product cards by filter
// @grant        GM_addValueChangeListener
// @grant        GM_setValue
// @grant        GM_getValue
// @match        https://www.pepper.ru/*
// @namespace    https://github.com/reliable-code/product-list-filters
// @version      0.3.73635453
// @icon         https://www.google.com/s2/favicons?sz=64&domain=pepper.ru
// @author       reliable-code
// ==/UserScript==

(()=>{(()=>{"use strict";var O={9928:(N,d,n)=>{n.d(d,{S:()=>v,Sw:()=>b,kU:()=>p,o5:()=>a});var l=n(4921),S=n(573);function p(s,f,C){const r=u(s,"text",f);return r.value=C,r}function a(s,f,C,r,g,t){const e=u(s,"number",f);return e.value=C,e.step=r,e.min=g,e.max=t,e}function v(s,f,C){const r=u(s,"checkbox",f);return r.checked=C,r}function u(s={},f=null,C=null){const r=m("input",s);return f&&(r.type=f),C&&(r.addEventListener("keyup",(0,l.sg)(C,200)),r.addEventListener("change",(0,l.sg)(C,100))),r}function c(s={},f=null){return m("span",s,f)}function o(s={},f=null,C=null){const r=m("a",s,f);return C&&(r.href=C),r}function y(s={},f=null,C=null){const r=m("button",s,f);return C&&(r.onclick=C),r}function b(s={},f=null){return m("div",s,f)}function m(s,f,C=null){if(typeof f!="object"||f===null)throw new TypeError("styles should be an object");const r=document.createElement(s);return(0,S.ZM)(r,f),C&&(r.innerHTML=C),r}},573:(N,d,n)=>{n.d(d,{Fi:()=>p,YA:()=>c,ZM:()=>m,fI:()=>a});var l=n(4214);function S(r,g=document){return!!g.querySelector(r)}function p(r,g=document,t=!1){const e=g.querySelector(r);return t&&!e&&console.log(`No element found for selector: ${r}`),e}function a(r,g=document,t=!1){const e=g.querySelectorAll(r);return t&&!e.length&&console.log(`No elements found for selector: ${r}`),e}function v(r,g,t){return[...r.querySelectorAll(g)].find(e=>e.textContent.trim().includes(t))}function u(r,g,t=!1,e=!1){const i=p(g,r,!0);return c(i,t,e)}function c(r,g=!1,t=!1,e=null){if(!r)return e===null?(console.log("No element found"),null):e;const i=r.innerText;return b(i,g,t)}function o(r,g,t=!1){const e=r[g];return c(e,t)}function y(r,g=!1,t=!1){const e=r.textContent;return b(e,g,t)}function b(r,g,t){return g&&(r=(0,l.zr)(r)),t&&(r=r.replace(",",".")),+r}function m(r,g){Object.assign(r.style,g)}function s(r){return Object.entries(r).map(([g,t])=>`${g.replace(/([A-Z])/g,"-$1").toLowerCase()}: ${t};`).join(" ")}function f(r){return r?r.split(";").filter(g=>g.trim()!=="").reduce((g,t)=>{const[e,i]=t.split(":").map(x=>x.trim()),h=e.replace(/-([a-z])/g,(x,F)=>F.toUpperCase());return g[h]=i,g},{}):{}}function C(r){const g=t=>t.nodeType===Node.TEXT_NODE&&t.textContent.trim()!==""?[t]:[...t.childNodes].flatMap(g);return g(r)}},5539:(N,d,n)=>{n.d(d,{D9:()=>b,iV:()=>s,vJ:()=>m});function l(t,e){t.parentNode.insertBefore(e,t.nextSibling)}function S(t){y(t),c(t,"none")}function p(t){t.intersectionObserver||runOnceOnIntersection(t,()=>S(t))}function a(t){const e=o(t);c(t,e)}function v(t,e){e?S(t):a(t)}function u(t,e){e?p(t):(clearIntersectionObserver(t),a(t))}function c(t,e){t.style.display=e}function o(t){return y(t),t.defaultDisplay}function y(t){if(t.defaultDisplay)return;const{display:e}=getComputedStyle(t);t.defaultDisplay=e}function b(t,e,i=.3){e?s(t,i):m(t)}function m(t){t.style.opacity=""}function s(t,e=.3){t.style.opacity=e}function f(t){t.style.order=""}function C(t,e){t.style.order=e}function r(t,e){t.style.background=e}function g(t,e="custom-global-style"){let i=document.getElementById(e);i||(i=document.createElement("style"),i.id=e,i.type="text/css",document.head.appendChild(i)),i.textContent=t}},4921:(N,d,n)=>{n.d(d,{sg:()=>p,xk:()=>l});async function l(u,c,o=null){const y=u.querySelector(c);return y?Promise.resolve(y):new Promise(b=>{const m=new MutationObserver(f);m.observe(u,{childList:!0,subtree:!0});let s=null;o&&(s=setTimeout(()=>{m.disconnect(),console.log(`No element found for selector: ${c}`),b(null)},o));function f(){const C=u.querySelector(c);C&&(s&&clearTimeout(s),m.disconnect(),b(C))}})}async function S(u,c){return u.querySelector(c)?new Promise(y=>{const b=new MutationObserver(m);b.observe(u,{childList:!0,subtree:!0});function m(){u.querySelector(c)||(b.disconnect(),y())}}):Promise.resolve()}function p(u,c=250){let o;return(...y)=>{clearTimeout(o),o=setTimeout(()=>u(...y),c)}}function a(u,c){const o=new IntersectionObserver(y=>{y.forEach(b=>{b.isIntersecting&&(c(),v(u))})});u.intersectionObserver=o,o.observe(u)}function v(u){u.intersectionObserver&&(u.intersectionObserver.disconnect(),u.intersectionObserver=null)}},3829:(N,d,n)=>{n.d(d,{Ay:()=>S,JE:()=>a});var l=n(8355);function S(c,o){return!p(c,o)}function p(c,o){if(!o.value)return!0;const y=c.toLowerCase(),b=(0,l.R)(o),m=[],s=[];return b.forEach(f=>{if(f.startsWith("!")){const C=f.substring(1);C&&s.push(C)}else m.push(f)}),m.every(f=>y.includes(f))&&s.every(f=>!y.includes(f))}function a(c,o){return o.value!=null&&c<o.value}function v(c,o){return o.value!=null&&c>o.value}function u(c,o){return o.value!=null&&c!==o.value}},4521:(N,d,n)=>{n.d(d,{z:()=>S});var l=n(4160);function S(p,a=null){return{createGlobalFilter(v,u=null,c=p){return l.VB.create(v,u,c)},createSectionFilter(v,u=null,c=p){if(!a)throw new Error("sectionId must be provided to use createSectionFilter.");return l.VB.createWithCompositeKey(a,v,u,c)}}}},5884:(N,d,n)=>{n.d(d,{Hw:()=>a,Nm:()=>S,nW:()=>p});var l=n(9928);function S(v,u,c={},o={}){const y=(0,l.Sw)(c,v),b=(0,l.kU)(o,u.updateValueFromEvent,u.value);return y.append(b),y}function p(v,u,c,o,y,b={},m={}){const s=(0,l.Sw)(b,v),f=(0,l.o5)(m,u.updateValueFromEvent,u.value,c,o,y);return s.append(f),s}function a(v,u,c={},o={}){const y=(0,l.Sw)(c,v),b=(0,l.S)(o,u.updateValueFromEvent,u.value);return y.append(b),y}},7877:(N,d,n)=>{n.d(d,{E9:()=>S,pW:()=>t});var l=n(5884);function S(e,i={},h={}){return(0,l.Nm)("\u041F\u043E\u0438\u0441\u043A: ",e,i,h)}function p(e,i={},h={},x=.1,F=3){return createNumberFilterControl("\u041C\u0438\u043D. \u0440\u0435\u0439\u0442\u0438\u043D\u0433: ",e,x,F,5,i,h)}function a(e,i={},h={},x=.1,F=3){return createNumberFilterControl("\u041C\u0430\u043A\u0441. \u0440\u0435\u0439\u0442\u0438\u043D\u0433: ",e,x,F,5,i,h)}function v(e,i={},h={}){return c("\u041C\u0438\u043D. \u043E\u0442\u0437\u044B\u0432\u043E\u0432: ",e,i,h)}function u(e,i={},h={}){return c("\u041C\u0430\u043A\u0441. \u043E\u0442\u0437\u044B\u0432\u043E\u0432: ",e,i,h)}function c(e,i,h={},x={}){return createNumberFilterControl(e,i,"1","1","999999",h,x)}function o(e,i={},h={}){return y("\u041C\u0438\u043D. \u0441\u043A\u0438\u0434\u043A\u0430: ",e,i,h)}function y(e,i,h={},x={}){return createNumberFilterControl(e,i,"5","0","100",h,x)}function b(e,i={},h={}){return createNumberFilterControl("\u041C\u0438\u043D. \u043A\u0435\u0448\u0431\u0435\u043A: ",e,"5","0","100",i,h)}function m(e,i,h={},x={},F="250"){return createNumberFilterControl(e,i,F,"0","1000000",h,x)}function s(e,i={},h={},x="25"){return m("\u041C\u0438\u043D. \u0446\u0435\u043D\u0430: ",e,i,h,x)}function f(e,i={},h={},x="25"){return m("\u041C\u0430\u043A\u0441. \u0446\u0435\u043D\u0430: ",e,i,h,x)}function C(e,i,h={},x={}){return createNumberFilterControl(e,i,"1","0","99999",h,x)}function r(e,i={},h={}){return createCheckboxFilterControl("\u0411\u0435\u0437 \u0440\u0435\u0439\u0442\u0438\u043D\u0433\u0430: ",e,i,h)}function g(e,i={},h={}){return createCheckboxFilterControl("\u0421 \u0444\u043E\u0442\u043E: ",e,i,h)}function t(e,i={},h={}){return(0,l.Hw)("\u0412\u043A\u043B: ",e,i,h)}},8355:(N,d,n)=>{n.d(d,{R:()=>l});function l(p){return p.value.toLowerCase().split(",").map(a=>a.trim()).filter(a=>a!=="")}function S(p){return l(p).filter(a=>!a.startsWith("!"))}},5213:(N,d,n)=>{n.d(d,{b:()=>p});var l=n(9928),S=n(573);function p(a,v,u=!1,c="customFiltersContainer"){let o=(0,S.Fi)(`#${c}`,a);if(o)if(u)o.remove();else return;o=(0,l.Sw)(),o.id=c,v(o,a)}},8200:(N,d,n)=>{n.d(d,{s:()=>l});function l(S){const{target:p}=S,{type:a}=p;switch(a){case"text":return`"${p.value}"`;case"number":return p.value;case"checkbox":return p.checked;default:return console.log(`Unknown input type: ${a}`),null}}},1870:(N,d,n)=>{n.d(d,{j:()=>l});class l{constructor(p,a){this.value=p,this.onChange=a}onChangeIfDefined=()=>{this.onChange&&this.onChange()}}},4160:(N,d,n)=>{n.d(d,{Fg:()=>a,VB:()=>o,vx:()=>u});var l=n(1870),S=n(8200),p=n(3976);const a=window.GM_setValue,v=window.GM.setValue,u=window.GM_getValue,c=window.GM_addValueChangeListener;class o extends l.j{constructor(b,m=null,s=null){super(u(b,m),s),this.storageKey=b,this.defaultValue=m}static create(b,m=null,s=null){return new o(b,m,s)}static createWithCompositeKey(b,m,s=null,f=null){const C=`${b}-${m}`;return new o(C,s,f)}updateValueFromEvent=b=>{const m=(0,S.s)(b),s=(0,p.$)(m);this.updateValue(s)};updateValue(b){this.value!==b&&(a(this.storageKey,b),this.value=b,this.onChangeIfDefined())}clearValue(){this.updateValue(null)}resetValue(){this.updateValue(this.defaultValue)}}},3976:(N,d,n)=>{n.d(d,{$:()=>l});function l(S){return S===""?null:JSON.parse(S)}},4214:(N,d,n)=>{n.d(d,{zr:()=>S});function l(v){return v.replace(/\D/g,"")}function S(v){return v.replace(/[^\d.,-]/g,"")}function p(v){return v.replace(/\s/g,"")}function a(v){return v.charAt(0).toUpperCase()+v.slice(1)}},1365:(N,d,n)=>{n.d(d,{i:()=>l});const l={MARK_AS_NEWEST_SEEN_APPENDED:"markAsNewestSeenAppended"}},7234:(N,d,n)=>{n.d(d,{CU:()=>p,Fr:()=>v,Su:()=>S,X0:()=>a});var l=n(4160);function S(u){(0,l.Fg)("newest-seen-product-id",u)}function p(){return(0,l.vx)("newest-seen-product-id")}function a(u){(0,l.Fg)("prev-newest-seen-product-id",u)}function v(){return(0,l.vx)("prev-newest-seen-product-id")}},9374:(N,d,n)=>{n.a(N,async(l,S)=>{try{let h=function(){const w=(0,o.fI)(m.Z.PRODUCT_CARD);if(w.length){const E=w[0].parentElement;(0,a.b)(E,x),F(),new MutationObserver(F).observe(E,{childList:!0,subtree:!0})}},x=function(w,E){(0,o.ZM)(w,s.r.FILTERS_CONTAINER);const I=(0,y.E9)(g,s.r.CONTROL,s.r.TEXT_INPUT),k=(0,u.nW)("\u041C\u0438\u043D\u0438\u043C\u0430\u043B\u044C\u043D\u043E \u0433\u043E\u043B\u043E\u0441\u043E\u0432: ",t,"50","0","10000",s.r.CONTROL,s.r.NUMBER_INPUT),A=(0,u.Hw)("\u0417\u0430\u0432\u0435\u0440\u0448\u0451\u043D\u043D\u044B\u0435: ",e,s.r.CONTROL,s.r.CHECKBOX_INPUT),D=(0,y.pW)(i,s.r.CONTROL,s.r.CHECKBOX_INPUT);w.append(I,k,A,D),E.prepend(w)},F=function(){(0,o.fI)(m.Z.PRODUCT_CARD).forEach(V)},V=function(w){const E=(0,o.Fi)(m.Z.PRODUCT_CARD_LINK,w),I=P(E);if(U(I,w),L(w,E,I),!i.value){(0,c.vJ)(w);return}if(w.classList.contains("expired-view")&&!e.value){(0,c.iV)(w);return}const A=(0,o.Fi)(m.Z.PRODUCT_CARD_RATING,w);if(A.innerText.includes("\u041D\u043E\u0432\u043E\u0435"))return;const D=(0,o.Fi)(m.Z.PRODUCT_NAME,w),B=(0,o.YA)(A,!0),Z=D.innerText,H=(0,v.Ay)(Z,g)||(0,v.JE)(B,t);(0,c.D9)(w,H)},P=function(w){return+w.getAttribute("href").split("-").pop()},U=function(w,E){w>(0,f.Fr)()?E.style.border="3px solid #8ab854":E.style.removeProperty("border")},L=function(w,E,I){w.hasAttribute(C.i.MARK_AS_NEWEST_SEEN_APPENDED)||(w.addEventListener("mousedown",k=>{k.button===1&&k.target!==E&&confirm("\u041F\u043E\u043C\u0435\u0442\u0438\u0442\u044C \u043A\u0430\u043A \u043D\u043E\u0432\u043E\u0435?")&&($(I),k.preventDefault())}),w.setAttribute(C.i.MARK_AS_NEWEST_SEEN_APPENDED,""))},$=function(w){const E=(0,f.CU)();(0,f.X0)(E),(0,f.Su)(w),F()};var p=n(4921),a=n(5213),v=n(3829),u=n(5884),c=n(5539),o=n(573),y=n(7877),b=n(4521),m=n(2756),s=n(8050),f=n(7234),C=n(1365);const{createGlobalFilter:r}=(0,b.z)(h),g=r("name-filter"),t=r("min-votes-filter",50),e=r("show-expired-filter",!1),i=r("filter-enabled",!0);await G(),h();async function G(){const w=await(0,p.xk)(document,m.Z.DISCUSSIONS);w&&(w.style.position="sticky",w.style.top="0")}S()}catch(r){S(r)}},1)},2756:(N,d,n)=>{n.d(d,{Z:()=>l});const l={DISCUSSIONS:"div.md\\:block.hidden.common-box:nth-of-type(3)",PRODUCT_CARD:".deal-card",PRODUCT_CARD_RATING:".common-box span",PRODUCT_NAME:".custom-card-title",PRODUCT_CARD_LINK:".custom-card-title > a"}},8050:(N,d,n)=>{n.d(d,{r:()=>S});const l={INPUT:{border:"1px solid #d1d5db",borderRadius:"8px",marginLeft:"7px"}},S={FILTERS_CONTAINER:{display:"flex",gridGap:"15px",padding:"11px 19px",marginBottom:".5rem",backgroundColor:"#fff",borderWidth:"1px",borderColor:"rgb(229, 229, 229)",borderRadius:"10px",position:"sticky",zIndex:"11",top:"-1px"},CONTROL:{display:"flex",alignItems:"center"},TEXT_INPUT:{...l.INPUT,width:"180px",padding:"7px 14px",backgroundColor:"#fff"},NUMBER_INPUT:{...l.INPUT,width:"90px",padding:"7px 14px",backgroundColor:"#fff"},CHECKBOX_INPUT:{...l.INPUT,width:"24px",height:"24px"}}}},R={};function T(N){var d=R[N];if(d!==void 0)return d.exports;var n=R[N]={exports:{}};return O[N](n,n.exports,T),n.exports}(()=>{var N=typeof Symbol=="function"?Symbol("webpack queues"):"__webpack_queues__",d=typeof Symbol=="function"?Symbol("webpack exports"):"__webpack_exports__",n=typeof Symbol=="function"?Symbol("webpack error"):"__webpack_error__",l=p=>{p&&p.d<1&&(p.d=1,p.forEach(a=>a.r--),p.forEach(a=>a.r--?a.r++:a()))},S=p=>p.map(a=>{if(a!==null&&typeof a=="object"){if(a[N])return a;if(a.then){var v=[];v.d=0,a.then(o=>{u[d]=o,l(v)},o=>{u[n]=o,l(v)});var u={};return u[N]=o=>o(v),u}}var c={};return c[N]=o=>{},c[d]=a,c});T.a=(p,a,v)=>{var u;v&&((u=[]).d=-1);var c=new Set,o=p.exports,y,b,m,s=new Promise((f,C)=>{m=C,b=f});s[d]=o,s[N]=f=>(u&&f(u),c.forEach(f),s.catch(C=>{})),p.exports=s,a(f=>{y=S(f);var C,r=()=>y.map(t=>{if(t[n])throw t[n];return t[d]}),g=new Promise(t=>{C=()=>t(r),C.r=0;var e=i=>i!==u&&!c.has(i)&&(c.add(i),i&&!i.d&&(C.r++,i.push(C)));y.map(i=>i[N](e))});return C.r?g:r()},f=>(f?m(s[n]=f):b(o),l(u))),u&&u.d<0&&(u.d=0)}})(),T.d=(N,d)=>{for(var n in d)T.o(d,n)&&!T.o(N,n)&&Object.defineProperty(N,n,{enumerable:!0,get:d[n]})},T.o=(N,d)=>Object.prototype.hasOwnProperty.call(N,d);var j=T(9374)})();})();
