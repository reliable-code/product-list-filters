// ==UserScript==
// @name         Pepper product cards filter
// @description  Hide product cards by filter
// @grant        GM_addValueChangeListener
// @grant        GM_setValue
// @grant        GM_getValue
// @match        https://www.pepper.ru/*
// @namespace    https://github.com/reliable-code/product-list-filters
// @version      1.0.73894053
// @icon         https://www.google.com/s2/favicons?sz=64&domain=pepper.ru
// @author       reliable-code
// ==/UserScript==

(()=>{(()=>{"use strict";var j={5467:(w,c,n)=>{n.d(c,{E2:()=>h});var s=n(9928);function h(C,i={},t=null){const r=(0,s.Sw)(i,t);return r.append(C),r}function f(C,i=null,t={},r={}){const v=createActionLink(C,i,r);return h(v,t)}function a(C,i=null,t=null,r={},v={}){const S=createActionLinkWithIcon(C,t,i,v);return h(S,r)}},9928:(w,c,n)=>{n.d(c,{S:()=>C,Sw:()=>x,kU:()=>f,o5:()=>a});var s=n(4921),h=n(5539);function f(l,u,N){const b=i(l,"text",u);return b.value=N,b}function a(l,u,N,b,g,E){const m=i(l,"number",u);return m.value=N,m.step=b,m.min=g,m.max=E,m}function C(l,u,N){const b=i(l,"checkbox",u);return b.checked=N,b}function i(l={},u=null,N=null){const b=p("input",l);return u&&(b.type=u),N&&(b.addEventListener("keyup",(0,s.sg)(N,200)),b.addEventListener("change",(0,s.sg)(N,100))),b}function t(l={},u=null){return p("span",l,u)}function r(l={},u=null,N=null){const b=p("a",l,u);return N&&(b.href=N),b}function v(l,u=null,N={}){N.cursor||="pointer";const b=r(N,u);return l&&b.addEventListener("click",l),b}function S(l,u,N=null,b={}){b.display||="inline-flex",b.alignItems||="center",b.gap||="0.25em";const g=v(l,N,b);return g.prepend(d(u)),g}function F(l={},u=null,N=null){const b=p("button",l,u);return N&&b.addEventListener("click",N),b}function x(l={},u=null){return p("div",l,u)}function T(l={}){return p("i",l)}function d(l,u={}){u.width||="1em",u.height||="1em",u.paddingBottom||="1px";const N=T(u);return N.setAttribute("data-lucide",l),N}function p(l,u,N=null){if(typeof u!="object"||u===null)throw new TypeError("styles should be an object");const b=document.createElement(l);return(0,h.ZM)(b,u),N&&(b.innerHTML=N),b}},573:(w,c,n)=>{n.d(c,{Fi:()=>f,YA:()=>t,fI:()=>a});var s=n(4214);function h(d,p=document){return!!p.querySelector(d)}function f(d,p=document,l=!1){const u=p.querySelector(d);return l&&!u&&console.log(`No element found for selector: ${d}`),u}function a(d,p=document,l=!1){const u=p.querySelectorAll(d);return l&&!u.length&&console.log(`No elements found for selector: ${d}`),u}function C(d,p,l){return[...d.querySelectorAll(p)].find(u=>u.textContent.trim().includes(l))}function i(d,p,l=!1,u=!1){const N=f(p,d,!0);return t(N,l,u)}function t(d,p=!1,l=!1,u=null){if(!d)return u===null?(console.log("No element found"),null):u;const N=d.innerText;return S(N,p,l)}function r(d,p,l=!1){const u=d[p];return t(u,l)}function v(d,p=!1,l=!1){const u=d.textContent;return S(u,p,l)}function S(d,p,l){p&&(d=(0,s.zr)(d)),l&&(d=d.replace(",","."));const u=Number(d);return Number.isNaN(u)?(console.log(`Invalid number: ${d}`),0):u}function F(d){return[...d.childNodes].find(p=>p.nodeType===Node.TEXT_NODE)}function x(d){const p=l=>l.nodeType===Node.TEXT_NODE&&l.textContent.trim()!==""?[l]:[...l.childNodes].flatMap(p);return p(d)}function T(d){return normalizeSpacing(d.textContent)}},5539:(w,c,n)=>{n.d(c,{D9:()=>d,ZM:()=>P,iV:()=>l,vJ:()=>p});function s(e,o){e.parentNode.insertBefore(o,e.nextSibling)}function h(e){e.style.display="none"}function f(e){S(e),h(e)}function a(e){e.intersectionObserver||runOnceOnIntersection(e,()=>h(e))}function C(e){e.style.display=""}function i(e){const o=v(e);e.style.display=o}function t(e,o){o?h(e):C(e)}function r(e,o){o?a(e):(clearIntersectionObserver(e),C(e))}function v(e){return S(e),e.defaultDisplay}function S(e){if(e.defaultDisplay)return;const{display:o}=getComputedStyle(e);e.defaultDisplay=o}function F(){return{show:[],hide:[]}}function x(e,o,y){e?o.hide.push(y):o.show.push(y)}function T(e){e.show.forEach(C),e.hide.forEach(h)}function d(e,o,y=.3){o?l(e,y):p(e)}function p(e){e.style.opacity=""}function l(e,o=.3){e.style.opacity=o}function u(e){e.style.order=""}function N(e,o){e.style.order=o}function b(e,o){e.style.background=o}function g(e,o){const y=getFirstElement(o);if(!y)return;const I=createLink();I.href=e,y.parentNode.append(I),I.append(y)}function E(e,o){const y=getFirstElement(o);y&&m(e,y)}function m(e,o){const y=createLink();y.href=e,y.append(...o.childNodes),o.append(y)}function k(){const e=getURLQueryParam("scrollTo");if(!e)return;const o=document.getElementById(e);o?o.scrollIntoView():console.log(`Element with ID "${e}" was not found.`)}function L(e,o="custom-global-style"){let y=document.getElementById(o);y||(y=document.createElement("style"),y.id=o,y.type="text/css",document.head.appendChild(y)),y.textContent=e}function P(e,o){Object.assign(e.style,o)}function B(e){return Object.entries(e).map(([o,y])=>`${o.replace(/([A-Z])/g,"-$1").toLowerCase()}: ${y};`).join(" ")}function $(e){return e?e.split(";").filter(o=>o.trim()!=="").reduce((o,y)=>{const[I,D]=y.split(":").map(O=>O.trim()),A=I.replace(/-([a-z])/g,(O,U)=>U.toUpperCase());return o[A]=D,o},{}):{}}function G(e,o,y="text/plain"){const I=new Blob([e],{type:y}),D=URL.createObjectURL(I),A=document.createElement("a");A.href=D,A.download=o,document.body.appendChild(A),A.click(),document.body.removeChild(A),requestAnimationFrame(()=>URL.revokeObjectURL(D))}},4921:(w,c,n)=>{n.d(c,{sg:()=>a,xk:()=>s});function s(t,r,v=null){const S=t.querySelector(r);return S?Promise.resolve(S):new Promise(F=>{const x=new MutationObserver(d);x.observe(t,{childList:!0,subtree:!0});let T;v&&(T=setTimeout(()=>{x.disconnect(),console.log(`No element found for selector: ${r}`),F(null)},v));function d(){const p=t.querySelector(r);p&&(T&&clearTimeout(T),x.disconnect(),F(p))}})}function h(t,r){return t.querySelector(r)?new Promise(S=>{const F=new MutationObserver(x);F.observe(t,{childList:!0,subtree:!0});function x(){t.querySelector(r)||(F.disconnect(),S())}}):Promise.resolve()}function f(t,r=400){return new Promise(v=>{let S;const F=new MutationObserver(()=>{clearTimeout(S),x()});function x(){S=setTimeout(()=>{F.disconnect(),v()},r)}x(),F.observe(t,{childList:!0,subtree:!0})})}function a(t,r=250){let v;return(...S)=>{clearTimeout(v),v=setTimeout(()=>t(...S),r)}}function C(t,r){const v=new IntersectionObserver(S=>{S.forEach(F=>{F.isIntersecting&&(r(),i(t))})});t.intersectionObserver=v,v.observe(t)}function i(t){t.intersectionObserver&&(t.intersectionObserver.disconnect(),t.intersectionObserver=null)}},3829:(w,c,n)=>{n.d(c,{Ay:()=>h,JE:()=>a});var s=n(8355);function h(t,r){return!f(t,r)}function f(t,r){if(!r.value)return!0;const v=t.toLowerCase(),S=(0,s.R)(r),F=[],x=[];return S.forEach(T=>{if(T.startsWith("!")){const d=T.substring(1);d&&x.push(d)}else F.push(T)}),F.every(T=>v.includes(T))&&x.every(T=>!v.includes(T))}function a(t,r){return r.value!=null&&t<r.value}function C(t,r){return r.value!=null&&t>r.value}function i(t,r){return r.value&&t!==r.value}},4521:(w,c,n)=>{n.d(c,{z:()=>h});var s=n(3048);function h(f,a=null){return{createGlobalFilter(C,i=null,t=f){return s.V.create(C,i,t)},createSectionFilter(C,i=null,t=f){if(!a)throw new Error("sectionId must be provided to use createSectionFilter.");return s.V.createWithCompositeKey(a,C,i,t)}}}},5884:(w,c,n)=>{n.d(c,{Hw:()=>C,Nm:()=>f,nW:()=>a});var s=n(9928),h=n(5467);function f(i,t,r={},v={}){const S=(0,s.kU)(v,t.updateValueFromEvent,t.value);return(0,h.E2)(S,r,i)}function a(i,t,r,v,S,F={},x={}){const T=(0,s.o5)(x,t.updateValueFromEvent,t.value,r,v,S);return(0,h.E2)(T,F,i)}function C(i,t,r={},v={}){const S=(0,s.S)(v,t.updateValueFromEvent,t.value);return(0,h.E2)(S,r,i)}},7877:(w,c,n)=>{n.d(c,{E9:()=>h,pW:()=>b});var s=n(5884);function h(g,E={},m={}){return(0,s.Nm)("\u041F\u043E\u0438\u0441\u043A: ",g,E,m)}function f(g,E={},m={},k=.1,L=3){return createNumberFilterControl("\u041C\u0438\u043D. \u0440\u0435\u0439\u0442\u0438\u043D\u0433: ",g,k,L,5,E,m)}function a(g,E={},m={},k=.1,L=3){return createNumberFilterControl("\u041C\u0430\u043A\u0441. \u0440\u0435\u0439\u0442\u0438\u043D\u0433: ",g,k,L,5,E,m)}function C(g,E={},m={}){return t("\u041C\u0438\u043D. \u043E\u0442\u0437\u044B\u0432\u043E\u0432: ",g,E,m)}function i(g,E={},m={}){return t("\u041C\u0430\u043A\u0441. \u043E\u0442\u0437\u044B\u0432\u043E\u0432: ",g,E,m)}function t(g,E,m={},k={}){return createNumberFilterControl(g,E,"1","1","999999",m,k)}function r(g,E={},m={}){return v("\u041C\u0438\u043D. \u0441\u043A\u0438\u0434\u043A\u0430: ",g,E,m)}function v(g,E,m={},k={}){return createNumberFilterControl(g,E,"5","0","100",m,k)}function S(g,E={},m={}){return createNumberFilterControl("\u041C\u0438\u043D. \u043A\u0435\u0448\u0431\u0435\u043A: ",g,"5","0","100",E,m)}function F(g,E,m={},k={},L="250"){return createNumberFilterControl(g,E,L,"0","1000000",m,k)}function x(g,E={},m={},k="25"){return F("\u041C\u0438\u043D. \u0446\u0435\u043D\u0430: ",g,E,m,k)}function T(g,E={},m={},k="25"){return F("\u041C\u0430\u043A\u0441. \u0446\u0435\u043D\u0430: ",g,E,m,k)}function d(g,E={},m={}){return p("\u041C\u0438\u043D. \u043B\u0430\u0438\u0306\u043A\u043E\u0432: ",g,E,m)}function p(g,E,m={},k={}){return createNumberFilterControl(g,E,"1","0","99999",m,k)}function l(g,E={},m={}){return createCheckboxFilterControl("\u0411\u0435\u0437 \u0440\u0435\u0439\u0442\u0438\u043D\u0433\u0430: ",g,E,m)}function u(g,E={},m={}){return createCheckboxFilterControl("\u0421 \u0444\u043E\u0442\u043E: ",g,E,m)}function N(g,E={},m={}){return createCheckboxFilterControl("\u041F\u0440\u043E\u0433\u0440\u0443\u0437\u043A\u0430: ",g,E,m)}function b(g,E={},m={}){return(0,s.Hw)("\u0412\u043A\u043B: ",g,E,m)}},8355:(w,c,n)=>{n.d(c,{R:()=>s});function s(f){return f.value.toLowerCase().split(",").map(a=>a.trim()).filter(a=>a!=="")}function h(f){return s(f).filter(a=>!a.startsWith("!"))}},5213:(w,c,n)=>{n.d(c,{b:()=>f});var s=n(9928),h=n(573);function f(a,C,i=!1,t="customFiltersContainer"){let r=(0,h.Fi)(`#${t}`,a);if(r)if(i)r.remove();else return;r=(0,s.Sw)(),r.id=t,C(r,a)}},8200:(w,c,n)=>{n.d(c,{s:()=>s});function s(h){const{target:f}=h,{type:a}=f;switch(a){case"text":return`"${f.value}"`;case"number":return f.value;case"checkbox":return f.checked;default:return console.log(`Unknown input type: ${a}`),null}}},157:(w,c,n)=>{n.d(c,{Fg:()=>s,vx:()=>f});const s=window.GM_setValue,h=window.GM.setValue,f=window.GM_getValue,a=window.GM_addValueChangeListener},1870:(w,c,n)=>{n.d(c,{j:()=>s});class s{constructor(f,a){this.value=f,this.onChange=a}onChangeIfDefined=()=>{this.onChange&&this.onChange()}}},3048:(w,c,n)=>{n.d(c,{V:()=>C});var s=n(1870),h=n(8200),f=n(3976),a=n(157);class C extends s.j{constructor(t,r=null,v=null){super((0,a.vx)(t,r),v),this.storageKey=t,this.defaultValue=r}static create(t,r=null,v=null){return new C(t,r,v)}static createWithCompositeKey(t,r,v=null,S=null){const F=`${t}-${r}`;return new C(F,v,S)}updateValueFromEvent=t=>{const r=(0,h.s)(t),v=(0,f.$)(r);this.updateValue(v)};updateValue(t,r=!0){this.value!==t&&((0,a.Fg)(this.storageKey,t),this.value=t,r&&this.onChangeIfDefined())}clearValue(t=!1){this.updateValue(null,t)}resetValue(t=!1){this.updateValue(this.defaultValue,t)}}},3976:(w,c,n)=>{n.d(c,{$:()=>s});function s(h){return h===""?null:JSON.parse(h)}},4214:(w,c,n)=>{n.d(c,{zr:()=>h});function s(i){return i.replace(/\D/g,"")}function h(i){return i.replace(/[^\d.,-]/g,"")}function f(i){return i.replace(/\s/g,"")}function a(i){return i.charAt(0).toUpperCase()+i.slice(1)}function C(i){return i.replace(/\s+/g," ").trim()}},1365:(w,c,n)=>{n.d(c,{i:()=>s});const s={MARK_AS_NEWEST_SEEN_APPENDED:"markAsNewestSeenAppended"}},7234:(w,c,n)=>{n.d(c,{CU:()=>f,Fr:()=>C,Su:()=>h,X0:()=>a});var s=n(157);function h(i){(0,s.Fg)("newest-seen-product-id",i)}function f(){return(0,s.vx)("newest-seen-product-id")}function a(i){(0,s.Fg)("prev-newest-seen-product-id",i)}function C(){return(0,s.vx)("prev-newest-seen-product-id")}},9374:(w,c,n)=>{n.a(w,async(s,h)=>{try{let g=function(){const e=(0,r.fI)(F.Z.PRODUCT_CARD);if(e.length){const o=e[0].parentElement;(0,a.b)(o,E),m(),new MutationObserver(m).observe(o,{childList:!0,subtree:!0})}},E=function(e,o){(0,t.ZM)(e,x.r.FILTERS_CONTAINER);const y=(0,v.E9)(l,x.r.CONTROL,x.r.TEXT_INPUT),I=(0,i.nW)("\u041C\u0438\u043D\u0438\u043C\u0430\u043B\u044C\u043D\u043E \u0433\u043E\u043B\u043E\u0441\u043E\u0432: ",u,"50","0","10000",x.r.CONTROL,x.r.NUMBER_INPUT),D=(0,i.Hw)("\u0417\u0430\u0432\u0435\u0440\u0448\u0451\u043D\u043D\u044B\u0435: ",N,x.r.CONTROL,x.r.CHECKBOX_INPUT),A=(0,v.pW)(b,x.r.CONTROL,x.r.CHECKBOX_INPUT);e.append(y,I,D,A),o.prepend(e)},m=function(){(0,r.fI)(F.Z.PRODUCT_CARD).forEach(k)},k=function(e){const o=(0,r.Fi)(F.Z.PRODUCT_CARD_LINK,e),y=L(o);if(P(y,e),B(e,o,y),!b.value){(0,t.vJ)(e);return}if(e.classList.contains("expired-view")&&!N.value){(0,t.iV)(e);return}const D=(0,r.Fi)(F.Z.PRODUCT_CARD_RATING,e);if(D.innerText.includes("\u041D\u043E\u0432\u043E\u0435"))return;const A=(0,r.Fi)(F.Z.PRODUCT_NAME,e),O=(0,r.YA)(D,!0),U=A.innerText,z=(0,C.Ay)(U,l)||(0,C.JE)(O,u);(0,t.D9)(e,z)},L=function(e){return+e.getAttribute("href").split("-").pop()},P=function(e,o){e>(0,T.Fr)()?o.style.border="3px solid #8ab854":o.style.removeProperty("border")},B=function(e,o,y){e.hasAttribute(d.i.MARK_AS_NEWEST_SEEN_APPENDED)||(e.addEventListener("mousedown",I=>{I.button===1&&I.target!==o&&confirm("\u041F\u043E\u043C\u0435\u0442\u0438\u0442\u044C \u043A\u0430\u043A \u043D\u043E\u0432\u043E\u0435?")&&($(y),I.preventDefault())}),e.setAttribute(d.i.MARK_AS_NEWEST_SEEN_APPENDED,""))},$=function(e){const o=(0,T.CU)();(0,T.X0)(o),(0,T.Su)(e),m()};var f=n(4921),a=n(5213),C=n(3829),i=n(5884),t=n(5539),r=n(573),v=n(7877),S=n(4521),F=n(2756),x=n(8050),T=n(7234),d=n(1365);const{createGlobalFilter:p}=(0,S.z)(g),l=p("name-filter"),u=p("min-votes-filter",50),N=p("show-expired-filter",!1),b=p("filter-enabled",!0);await G(),g();async function G(){const e=await(0,f.xk)(document,F.Z.DISCUSSIONS);e&&(e.style.position="sticky",e.style.top="0")}h()}catch(p){h(p)}},1)},2756:(w,c,n)=>{n.d(c,{Z:()=>s});const s={DISCUSSIONS:"div.md\\:block.hidden.common-box:nth-of-type(3)",PRODUCT_CARD:".deal-card",PRODUCT_CARD_RATING:".common-box span",PRODUCT_NAME:".custom-card-title",PRODUCT_CARD_LINK:".custom-card-title > a"}},8050:(w,c,n)=>{n.d(c,{r:()=>h});const s={INPUT:{border:"1px solid #d1d5db",borderRadius:"8px",marginLeft:"7px"}},h={FILTERS_CONTAINER:{display:"flex",gridGap:"15px",padding:"11px 19px",marginBottom:".5rem",backgroundColor:"#fff",borderWidth:"1px",borderColor:"rgb(229, 229, 229)",borderRadius:"10px",position:"sticky",zIndex:"11",top:"-1px"},CONTROL:{display:"flex",alignItems:"center"},TEXT_INPUT:{...s.INPUT,width:"180px",padding:"7px 14px",backgroundColor:"#fff"},NUMBER_INPUT:{...s.INPUT,width:"90px",padding:"7px 14px",backgroundColor:"#fff"},CHECKBOX_INPUT:{...s.INPUT,width:"24px",height:"24px"}}}},V={};function R(w){var c=V[w];if(c!==void 0)return c.exports;var n=V[w]={exports:{}};return j[w](n,n.exports,R),n.exports}(()=>{var w=typeof Symbol=="function"?Symbol("webpack queues"):"__webpack_queues__",c=typeof Symbol=="function"?Symbol("webpack exports"):"__webpack_exports__",n=typeof Symbol=="function"?Symbol("webpack error"):"__webpack_error__",s=f=>{f&&f.d<1&&(f.d=1,f.forEach(a=>a.r--),f.forEach(a=>a.r--?a.r++:a()))},h=f=>f.map(a=>{if(a!==null&&typeof a=="object"){if(a[w])return a;if(a.then){var C=[];C.d=0,a.then(r=>{i[c]=r,s(C)},r=>{i[n]=r,s(C)});var i={};return i[w]=r=>r(C),i}}var t={};return t[w]=r=>{},t[c]=a,t});R.a=(f,a,C)=>{var i;C&&((i=[]).d=-1);var t=new Set,r=f.exports,v,S,F,x=new Promise((T,d)=>{F=d,S=T});x[c]=r,x[w]=T=>(i&&T(i),t.forEach(T),x.catch(d=>{})),f.exports=x,a(T=>{v=h(T);var d,p=()=>v.map(u=>{if(u[n])throw u[n];return u[c]}),l=new Promise(u=>{d=()=>u(p),d.r=0;var N=b=>b!==i&&!t.has(b)&&(t.add(b),b&&!b.d&&(d.r++,b.push(d)));v.map(b=>b[w](N))});return d.r?l:p()},T=>(T?F(x[n]=T):S(r),s(i))),i&&i.d<0&&(i.d=0)}})(),R.d=(w,c)=>{for(var n in c)R.o(c,n)&&!R.o(w,n)&&Object.defineProperty(w,n,{enumerable:!0,get:c[n]})},R.o=(w,c)=>Object.prototype.hasOwnProperty.call(w,c);var H=R(9374)})();})();
