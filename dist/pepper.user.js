// ==UserScript==
// @name         Pepper product cards filter
// @description  Hide product cards by filter
// @grant        GM_addValueChangeListener
// @grant        GM_setValue
// @grant        GM_getValue
// @match        https://www.pepper.ru/*
// @namespace    https://github.com/reliable-code/product-list-filters
// @version      0.3.73668928
// @icon         https://www.google.com/s2/favicons?sz=64&domain=pepper.ru
// @author       reliable-code
// ==/UserScript==

(()=>{(()=>{"use strict";var P={9928:(g,s,n)=>{n.d(s,{S:()=>p,Sw:()=>x,kU:()=>d,o5:()=>l});var c=n(4921),h=n(573);function d(f,a,C){const S=i(f,"text",a);return S.value=C,S}function l(f,a,C,S,m,t){const e=i(f,"number",a);return e.value=C,e.step=S,e.min=m,e.max=t,e}function p(f,a,C){const S=i(f,"checkbox",a);return S.checked=C,S}function i(f={},a=null,C=null){const S=N("input",f);return a&&(S.type=a),C&&(S.addEventListener("keyup",(0,c.sg)(C,200)),S.addEventListener("change",(0,c.sg)(C,100))),S}function u(f={},a=null){return N("span",f,a)}function o(f={},a=null,C=null){const S=N("a",f,a);return C&&(S.href=C),S}function v(f={},a=null,C=null){const S=N("button",f,a);return C&&(S.onclick=C),S}function x(f={},a=null){return N("div",f,a)}function N(f,a,C=null){if(typeof a!="object"||a===null)throw new TypeError("styles should be an object");const S=document.createElement(f);return(0,h.ZM)(S,a),C&&(S.innerHTML=C),S}},573:(g,s,n)=>{n.d(s,{Fi:()=>d,YA:()=>u,ZM:()=>a,fI:()=>l});var c=n(4214);function h(m,t=document){return!!t.querySelector(m)}function d(m,t=document,e=!1){const r=t.querySelector(m);return e&&!r&&console.log(`No element found for selector: ${m}`),r}function l(m,t=document,e=!1){const r=t.querySelectorAll(m);return e&&!r.length&&console.log(`No elements found for selector: ${m}`),r}function p(m,t,e){return[...m.querySelectorAll(t)].find(r=>r.textContent.trim().includes(e))}function i(m,t,e=!1,r=!1){const b=d(t,m,!0);return u(b,e,r)}function u(m,t=!1,e=!1,r=null){if(!m)return r===null?(console.log("No element found"),null):r;const b=m.innerText;return x(b,t,e)}function o(m,t,e=!1){const r=m[t];return u(r,e)}function v(m,t=!1,e=!1){const r=m.textContent;return x(r,t,e)}function x(m,t,e){return t&&(m=(0,c.zr)(m)),e&&(m=m.replace(",",".")),+m}function N(m){return[...m.childNodes].find(t=>t.nodeType===Node.TEXT_NODE)}function f(m){const t=e=>e.nodeType===Node.TEXT_NODE&&e.textContent.trim()!==""?[e]:[...e.childNodes].flatMap(t);return t(m)}function a(m,t){Object.assign(m.style,t)}function C(m){return Object.entries(m).map(([t,e])=>`${t.replace(/([A-Z])/g,"-$1").toLowerCase()}: ${e};`).join(" ")}function S(m){return m?m.split(";").filter(t=>t.trim()!=="").reduce((t,e)=>{const[r,b]=e.split(":").map(F=>F.trim()),w=r.replace(/-([a-z])/g,(F,D)=>D.toUpperCase());return t[w]=b,t},{}):{}}},5539:(g,s,n)=>{n.d(s,{D9:()=>x,iV:()=>f,vJ:()=>N});function c(t,e){t.parentNode.insertBefore(e,t.nextSibling)}function h(t){v(t),u(t,"none")}function d(t){t.intersectionObserver||runOnceOnIntersection(t,()=>h(t))}function l(t){const e=o(t);u(t,e)}function p(t,e){e?h(t):l(t)}function i(t,e){e?d(t):(clearIntersectionObserver(t),l(t))}function u(t,e){t.style.display=e}function o(t){return v(t),t.defaultDisplay}function v(t){if(t.defaultDisplay)return;const{display:e}=getComputedStyle(t);t.defaultDisplay=e}function x(t,e,r=.3){e?f(t,r):N(t)}function N(t){t.style.opacity=""}function f(t,e=.3){t.style.opacity=e}function a(t){t.style.order=""}function C(t,e){t.style.order=e}function S(t,e){t.style.background=e}function m(t,e="custom-global-style"){let r=document.getElementById(e);r||(r=document.createElement("style"),r.id=e,r.type="text/css",document.head.appendChild(r)),r.textContent=t}},4921:(g,s,n)=>{n.d(s,{sg:()=>d,xk:()=>c});async function c(i,u,o=null){const v=i.querySelector(u);return v?Promise.resolve(v):new Promise(x=>{const N=new MutationObserver(a);N.observe(i,{childList:!0,subtree:!0});let f=null;o&&(f=setTimeout(()=>{N.disconnect(),console.log(`No element found for selector: ${u}`),x(null)},o));function a(){const C=i.querySelector(u);C&&(f&&clearTimeout(f),N.disconnect(),x(C))}})}async function h(i,u){return i.querySelector(u)?new Promise(v=>{const x=new MutationObserver(N);x.observe(i,{childList:!0,subtree:!0});function N(){i.querySelector(u)||(x.disconnect(),v())}}):Promise.resolve()}function d(i,u=250){let o;return(...v)=>{clearTimeout(o),o=setTimeout(()=>i(...v),u)}}function l(i,u){const o=new IntersectionObserver(v=>{v.forEach(x=>{x.isIntersecting&&(u(),p(i))})});i.intersectionObserver=o,o.observe(i)}function p(i){i.intersectionObserver&&(i.intersectionObserver.disconnect(),i.intersectionObserver=null)}},3829:(g,s,n)=>{n.d(s,{Ay:()=>h,JE:()=>l});var c=n(8355);function h(u,o){return!d(u,o)}function d(u,o){if(!o.value)return!0;const v=u.toLowerCase(),x=(0,c.R)(o),N=[],f=[];return x.forEach(a=>{if(a.startsWith("!")){const C=a.substring(1);C&&f.push(C)}else N.push(a)}),N.every(a=>v.includes(a))&&f.every(a=>!v.includes(a))}function l(u,o){return o.value!=null&&u<o.value}function p(u,o){return o.value!=null&&u>o.value}function i(u,o){return o.value&&u!==o.value}},4521:(g,s,n)=>{n.d(s,{z:()=>h});var c=n(3048);function h(d,l=null){return{createGlobalFilter(p,i=null,u=d){return c.V.create(p,i,u)},createSectionFilter(p,i=null,u=d){if(!l)throw new Error("sectionId must be provided to use createSectionFilter.");return c.V.createWithCompositeKey(l,p,i,u)}}}},5884:(g,s,n)=>{n.d(s,{Hw:()=>l,Nm:()=>h,nW:()=>d});var c=n(9928);function h(p,i,u={},o={}){const v=(0,c.Sw)(u,p),x=(0,c.kU)(o,i.updateValueFromEvent,i.value);return v.append(x),v}function d(p,i,u,o,v,x={},N={}){const f=(0,c.Sw)(x,p),a=(0,c.o5)(N,i.updateValueFromEvent,i.value,u,o,v);return f.append(a),f}function l(p,i,u={},o={}){const v=(0,c.Sw)(u,p),x=(0,c.S)(o,i.updateValueFromEvent,i.value);return v.append(x),v}},7877:(g,s,n)=>{n.d(s,{E9:()=>h,pW:()=>t});var c=n(5884);function h(e,r={},b={}){return(0,c.Nm)("\u041F\u043E\u0438\u0441\u043A: ",e,r,b)}function d(e,r={},b={},w=.1,F=3){return createNumberFilterControl("\u041C\u0438\u043D. \u0440\u0435\u0439\u0442\u0438\u043D\u0433: ",e,w,F,5,r,b)}function l(e,r={},b={},w=.1,F=3){return createNumberFilterControl("\u041C\u0430\u043A\u0441. \u0440\u0435\u0439\u0442\u0438\u043D\u0433: ",e,w,F,5,r,b)}function p(e,r={},b={}){return u("\u041C\u0438\u043D. \u043E\u0442\u0437\u044B\u0432\u043E\u0432: ",e,r,b)}function i(e,r={},b={}){return u("\u041C\u0430\u043A\u0441. \u043E\u0442\u0437\u044B\u0432\u043E\u0432: ",e,r,b)}function u(e,r,b={},w={}){return createNumberFilterControl(e,r,"1","1","999999",b,w)}function o(e,r={},b={}){return v("\u041C\u0438\u043D. \u0441\u043A\u0438\u0434\u043A\u0430: ",e,r,b)}function v(e,r,b={},w={}){return createNumberFilterControl(e,r,"5","0","100",b,w)}function x(e,r={},b={}){return createNumberFilterControl("\u041C\u0438\u043D. \u043A\u0435\u0448\u0431\u0435\u043A: ",e,"5","0","100",r,b)}function N(e,r,b={},w={},F="250"){return createNumberFilterControl(e,r,F,"0","1000000",b,w)}function f(e,r={},b={},w="25"){return N("\u041C\u0438\u043D. \u0446\u0435\u043D\u0430: ",e,r,b,w)}function a(e,r={},b={},w="25"){return N("\u041C\u0430\u043A\u0441. \u0446\u0435\u043D\u0430: ",e,r,b,w)}function C(e,r,b={},w={}){return createNumberFilterControl(e,r,"1","0","99999",b,w)}function S(e,r={},b={}){return createCheckboxFilterControl("\u0411\u0435\u0437 \u0440\u0435\u0439\u0442\u0438\u043D\u0433\u0430: ",e,r,b)}function m(e,r={},b={}){return createCheckboxFilterControl("\u0421 \u0444\u043E\u0442\u043E: ",e,r,b)}function t(e,r={},b={}){return(0,c.Hw)("\u0412\u043A\u043B: ",e,r,b)}},8355:(g,s,n)=>{n.d(s,{R:()=>c});function c(d){return d.value.toLowerCase().split(",").map(l=>l.trim()).filter(l=>l!=="")}function h(d){return c(d).filter(l=>!l.startsWith("!"))}},5213:(g,s,n)=>{n.d(s,{b:()=>d});var c=n(9928),h=n(573);function d(l,p,i=!1,u="customFiltersContainer"){let o=(0,h.Fi)(`#${u}`,l);if(o)if(i)o.remove();else return;o=(0,c.Sw)(),o.id=u,p(o,l)}},8200:(g,s,n)=>{n.d(s,{s:()=>c});function c(h){const{target:d}=h,{type:l}=d;switch(l){case"text":return`"${d.value}"`;case"number":return d.value;case"checkbox":return d.checked;default:return console.log(`Unknown input type: ${l}`),null}}},157:(g,s,n)=>{n.d(s,{Fg:()=>c,vx:()=>d});const c=window.GM_setValue,h=window.GM.setValue,d=window.GM_getValue,l=window.GM_addValueChangeListener},1870:(g,s,n)=>{n.d(s,{j:()=>c});class c{constructor(d,l){this.value=d,this.onChange=l}onChangeIfDefined=()=>{this.onChange&&this.onChange()}}},3048:(g,s,n)=>{n.d(s,{V:()=>p});var c=n(1870),h=n(8200),d=n(3976),l=n(157);class p extends c.j{constructor(u,o=null,v=null){super((0,l.vx)(u,o),v),this.storageKey=u,this.defaultValue=o}static create(u,o=null,v=null){return new p(u,o,v)}static createWithCompositeKey(u,o,v=null,x=null){const N=`${u}-${o}`;return new p(N,v,x)}updateValueFromEvent=u=>{const o=(0,h.s)(u),v=(0,d.$)(o);this.updateValue(v)};updateValue(u){this.value!==u&&((0,l.Fg)(this.storageKey,u),this.value=u,this.onChangeIfDefined())}clearValue(){this.updateValue(null)}resetValue(){this.updateValue(this.defaultValue)}}},3976:(g,s,n)=>{n.d(s,{$:()=>c});function c(h){return h===""?null:JSON.parse(h)}},4214:(g,s,n)=>{n.d(s,{zr:()=>h});function c(p){return p.replace(/\D/g,"")}function h(p){return p.replace(/[^\d.,-]/g,"")}function d(p){return p.replace(/\s/g,"")}function l(p){return p.charAt(0).toUpperCase()+p.slice(1)}},1365:(g,s,n)=>{n.d(s,{i:()=>c});const c={MARK_AS_NEWEST_SEEN_APPENDED:"markAsNewestSeenAppended"}},7234:(g,s,n)=>{n.d(s,{CU:()=>d,Fr:()=>p,Su:()=>h,X0:()=>l});var c=n(157);function h(i){(0,c.Fg)("newest-seen-product-id",i)}function d(){return(0,c.vx)("newest-seen-product-id")}function l(i){(0,c.Fg)("prev-newest-seen-product-id",i)}function p(){return(0,c.vx)("prev-newest-seen-product-id")}},9374:(g,s,n)=>{n.a(g,async(c,h)=>{try{let b=function(){const y=(0,o.fI)(N.Z.PRODUCT_CARD);if(y.length){const E=y[0].parentElement;(0,l.b)(E,w),F(),new MutationObserver(F).observe(E,{childList:!0,subtree:!0})}},w=function(y,E){(0,o.ZM)(y,f.r.FILTERS_CONTAINER);const I=(0,v.E9)(m,f.r.CONTROL,f.r.TEXT_INPUT),k=(0,i.nW)("\u041C\u0438\u043D\u0438\u043C\u0430\u043B\u044C\u043D\u043E \u0433\u043E\u043B\u043E\u0441\u043E\u0432: ",t,"50","0","10000",f.r.CONTROL,f.r.NUMBER_INPUT),A=(0,i.Hw)("\u0417\u0430\u0432\u0435\u0440\u0448\u0451\u043D\u043D\u044B\u0435: ",e,f.r.CONTROL,f.r.CHECKBOX_INPUT),R=(0,v.pW)(r,f.r.CONTROL,f.r.CHECKBOX_INPUT);y.append(I,k,A,R),E.prepend(y)},F=function(){(0,o.fI)(N.Z.PRODUCT_CARD).forEach(D)},D=function(y){const E=(0,o.Fi)(N.Z.PRODUCT_CARD_LINK,y),I=V(E);if(U(I,y),L(y,E,I),!r.value){(0,u.vJ)(y);return}if(y.classList.contains("expired-view")&&!e.value){(0,u.iV)(y);return}const A=(0,o.Fi)(N.Z.PRODUCT_CARD_RATING,y);if(A.innerText.includes("\u041D\u043E\u0432\u043E\u0435"))return;const R=(0,o.Fi)(N.Z.PRODUCT_NAME,y),Z=(0,o.YA)(A,!0),H=R.innerText,j=(0,p.Ay)(H,m)||(0,p.JE)(Z,t);(0,u.D9)(y,j)},V=function(y){return+y.getAttribute("href").split("-").pop()},U=function(y,E){y>(0,a.Fr)()?E.style.border="3px solid #8ab854":E.style.removeProperty("border")},L=function(y,E,I){y.hasAttribute(C.i.MARK_AS_NEWEST_SEEN_APPENDED)||(y.addEventListener("mousedown",k=>{k.button===1&&k.target!==E&&confirm("\u041F\u043E\u043C\u0435\u0442\u0438\u0442\u044C \u043A\u0430\u043A \u043D\u043E\u0432\u043E\u0435?")&&($(I),k.preventDefault())}),y.setAttribute(C.i.MARK_AS_NEWEST_SEEN_APPENDED,""))},$=function(y){const E=(0,a.CU)();(0,a.X0)(E),(0,a.Su)(y),F()};var d=n(4921),l=n(5213),p=n(3829),i=n(5884),u=n(5539),o=n(573),v=n(7877),x=n(4521),N=n(2756),f=n(8050),a=n(7234),C=n(1365);const{createGlobalFilter:S}=(0,x.z)(b),m=S("name-filter"),t=S("min-votes-filter",50),e=S("show-expired-filter",!1),r=S("filter-enabled",!0);await G(),b();async function G(){const y=await(0,d.xk)(document,N.Z.DISCUSSIONS);y&&(y.style.position="sticky",y.style.top="0")}h()}catch(S){h(S)}},1)},2756:(g,s,n)=>{n.d(s,{Z:()=>c});const c={DISCUSSIONS:"div.md\\:block.hidden.common-box:nth-of-type(3)",PRODUCT_CARD:".deal-card",PRODUCT_CARD_RATING:".common-box span",PRODUCT_NAME:".custom-card-title",PRODUCT_CARD_LINK:".custom-card-title > a"}},8050:(g,s,n)=>{n.d(s,{r:()=>h});const c={INPUT:{border:"1px solid #d1d5db",borderRadius:"8px",marginLeft:"7px"}},h={FILTERS_CONTAINER:{display:"flex",gridGap:"15px",padding:"11px 19px",marginBottom:".5rem",backgroundColor:"#fff",borderWidth:"1px",borderColor:"rgb(229, 229, 229)",borderRadius:"10px",position:"sticky",zIndex:"11",top:"-1px"},CONTROL:{display:"flex",alignItems:"center"},TEXT_INPUT:{...c.INPUT,width:"180px",padding:"7px 14px",backgroundColor:"#fff"},NUMBER_INPUT:{...c.INPUT,width:"90px",padding:"7px 14px",backgroundColor:"#fff"},CHECKBOX_INPUT:{...c.INPUT,width:"24px",height:"24px"}}}},O={};function T(g){var s=O[g];if(s!==void 0)return s.exports;var n=O[g]={exports:{}};return P[g](n,n.exports,T),n.exports}(()=>{var g=typeof Symbol=="function"?Symbol("webpack queues"):"__webpack_queues__",s=typeof Symbol=="function"?Symbol("webpack exports"):"__webpack_exports__",n=typeof Symbol=="function"?Symbol("webpack error"):"__webpack_error__",c=d=>{d&&d.d<1&&(d.d=1,d.forEach(l=>l.r--),d.forEach(l=>l.r--?l.r++:l()))},h=d=>d.map(l=>{if(l!==null&&typeof l=="object"){if(l[g])return l;if(l.then){var p=[];p.d=0,l.then(o=>{i[s]=o,c(p)},o=>{i[n]=o,c(p)});var i={};return i[g]=o=>o(p),i}}var u={};return u[g]=o=>{},u[s]=l,u});T.a=(d,l,p)=>{var i;p&&((i=[]).d=-1);var u=new Set,o=d.exports,v,x,N,f=new Promise((a,C)=>{N=C,x=a});f[s]=o,f[g]=a=>(i&&a(i),u.forEach(a),f.catch(C=>{})),d.exports=f,l(a=>{v=h(a);var C,S=()=>v.map(t=>{if(t[n])throw t[n];return t[s]}),m=new Promise(t=>{C=()=>t(S),C.r=0;var e=r=>r!==i&&!u.has(r)&&(u.add(r),r&&!r.d&&(C.r++,r.push(C)));v.map(r=>r[g](e))});return C.r?m:S()},a=>(a?N(f[n]=a):x(o),c(i))),i&&i.d<0&&(i.d=0)}})(),T.d=(g,s)=>{for(var n in s)T.o(s,n)&&!T.o(g,n)&&Object.defineProperty(g,n,{enumerable:!0,get:s[n]})},T.o=(g,s)=>Object.prototype.hasOwnProperty.call(g,s);var B=T(9374)})();})();
