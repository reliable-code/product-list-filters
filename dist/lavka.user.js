// ==UserScript==
// @name         Lavka List Clean
// @description  Remove product cards without discount
// @grant        GM_notification
// @match        https://lavka.yandex.ru/*
// @namespace    https://github.com/reliable-code/product-list-filters
// @version      0.6.73244666
// @icon         https://www.google.com/s2/favicons?sz=64&domain=yandex.ru
// @author       reliable-code
// ==/UserScript==

(()=>{(()=>{"use strict";var nn={};function tn(e,n){var t=arguments.length>2&&arguments[2]!==void 0?arguments[2]:null;return new Promise(function(r){var u=e.querySelector(n);if(u){r(u);return}var a=new MutationObserver(i);a.observe(e,{childList:!0,subtree:!0});var l=null;t&&(l=setTimeout(function(){a.disconnect(),console.log("No element found for selector: ".concat(n)),r(null)},t));function i(){e.querySelector(n)&&(l&&clearTimeout(l),a.disconnect(),r(e.querySelector(n)))}})}function h(e){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:250,t;return function(){for(var r=arguments.length,u=new Array(r),a=0;a<r;a++)u[a]=arguments[a];clearTimeout(t),t=setTimeout(function(){return e.apply(void 0,u)},n)}}function v(e){"@babel/helpers - typeof";return v=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(n){return typeof n}:function(n){return n&&typeof Symbol=="function"&&n.constructor===Symbol&&n!==Symbol.prototype?"symbol":typeof n},v(e)}function de(e,n){if(v(e)!="object"||!e)return e;var t=e[Symbol.toPrimitive];if(t!==void 0){var r=t.call(e,n||"default");if(v(r)!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(n==="string"?String:Number)(e)}function k(e){var n=de(e,"string");return v(n)=="symbol"?n:n+""}function A(e,n){for(var t=0;t<n.length;t++){var r=n[t];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,k(r.key),r)}}function M(e,n,t){return n&&A(e.prototype,n),t&&A(e,t),Object.defineProperty(e,"prototype",{writable:!1}),e}function j(e,n){if(!(e instanceof n))throw new TypeError("Cannot call a class as a function")}function ve(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function pe(e,n){if(n&&(v(n)=="object"||typeof n=="function"))return n;if(n!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return ve(e)}function y(e){return y=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(n){return n.__proto__||Object.getPrototypeOf(n)},y(e)}function w(e,n){return w=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,r){return t.__proto__=r,t},w(e,n)}function he(e,n){if(typeof n!="function"&&n!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(n&&n.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),n&&w(e,n)}function V(e,n,t){return(n=k(n))in e?Object.defineProperty(e,n,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[n]=t,e}var ye=M(function e(n,t){var r=this;j(this,e),V(this,"onChangeIfDefined",function(){r.onChange&&r.onChange()}),this.value=n,this.onChange=t});function be(e){var n=e.target,t=n.type;switch(t){case"text":return'"'.concat(n.value,'"');case"number":return n.value;case"checkbox":return n.checked;default:return console.log("Unknown input type: ".concat(t)),null}}function B(e){return e===""?null:JSON.parse(e)}function Se(e,n,t){return n=y(n),pe(e,U()?Reflect.construct(n,t||[],y(e).constructor):n.apply(e,t))}function U(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(U=function(){return!!e})()}var H=localStorage;function Ee(e){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:null,t=H.getItem(e);return t===null?n:B(t)}var m=function(e){function n(t){var r,u=arguments.length>1&&arguments[1]!==void 0?arguments[1]:null,a=arguments.length>2&&arguments[2]!==void 0?arguments[2]:null;return j(this,n),r=Se(this,n,[Ee(t,u),a]),V(r,"updateValueFromEvent",function(l){var i=be(l),o=B(i);r.value!==o&&(H.setItem(r.storageKey,i),r.value=o,r.onChangeIfDefined())}),r.storageKey=t,r}return he(n,e),M(n)}(ye);function Ce(e){return e.replace(/\D/g,"")}function we(e){return e.replace(/[^\d.,-]/g,"")}function rn(e){return e.replace(/\s/g,"")}function un(e){return e.charAt(0).toUpperCase()+e.slice(1)}function Te(e){if(Array.isArray(e))return e}function xe(e,n){var t=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(t!=null){var r,u,a,l,i=[],o=!0,p=!1;try{if(a=(t=t.call(e)).next,n===0){if(Object(t)!==t)return;o=!1}else for(;!(o=(r=a.call(t)).done)&&(i.push(r.value),i.length!==n);o=!0);}catch(en){p=!0,u=en}finally{try{if(!o&&t.return!=null&&(l=t.return(),Object(l)!==l))return}finally{if(p)throw u}}return i}}function q(e,n){(n==null||n>e.length)&&(n=e.length);for(var t=0,r=Array(n);t<n;t++)r[t]=e[t];return r}function _e(e,n){if(e){if(typeof e=="string")return q(e,n);var t={}.toString.call(e).slice(8,-1);return t==="Object"&&e.constructor&&(t=e.constructor.name),t==="Map"||t==="Set"?Array.from(e):t==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t)?q(e,n):void 0}}function Oe(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Ie(e,n){return Te(e)||xe(e,n)||_e(e,n)||Oe()}function f(e){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:document,t=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1,r=n.querySelector(e);return t&&!r&&console.log("No element found for selector: ".concat(e)),r}function T(e){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:document,t=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1,r=n.querySelectorAll(e);return t&&!r.length&&console.log("No elements found for selector: ".concat(e)),r}function an(e,n){var t=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1,r=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1,u=f(n,e,!0),a=x(u,t,r);return a}function x(e){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1,t=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1,r=arguments.length>3&&arguments[3]!==void 0?arguments[3]:null;if(!e)if(r===null)console.log("No element found");else return r;var u=e.innerText;return Y(u,n,t)}function ln(e,n){var t=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1,r=e[n],u=x(r,t);return u}function on(e){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1,t=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1,r=e.textContent;return Y(r,n,t)}function Y(e,n,t){n&&(e=we(e)),t&&(e=e.replace(",","."));var r=+e;return r}function Ne(e,n){Object.entries(n).forEach(function(t){var r=Ie(t,2),u=r[0],a=r[1];e.style[u]=a})}function sn(e,n,t){var r=_("text",e,n);return r.value=t,r}function Fe(e,n,t,r,u,a){var l=_("number",e,n);return l.value=t,l.step=r,l.min=u,l.max=a,l}function Le(e,n,t){var r=_("checkbox",e,n);return r.checked=t,r}function _(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null,n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:null,t=arguments.length>2&&arguments[2]!==void 0?arguments[2]:null,r=document.createElement("input");return e&&(r.type=e),n&&(r.addEventListener("keyup",h(n,200)),r.addEventListener("change",h(n,100))),t&&(r.style=t),r}function cn(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:null;return b("span",e,n)}function gn(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:null,t=arguments.length>2&&arguments[2]!==void 0?arguments[2]:null,r=b("a",e,n);return t&&(r.href=t),r}function mn(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:null,t=arguments.length>2&&arguments[2]!==void 0?arguments[2]:null,r=b("button",e,n);return t&&(r.onclick=t),r}function O(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null,n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:null,t=document.createElement("div");return e&&(t.textContent=e),n&&(t.style=n),t}function Pe(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:null;return b("div",e,n)}function b(e,n){var t=arguments.length>2&&arguments[2]!==void 0?arguments[2]:null,r=document.createElement(e);return Object.keys(n).length>0&&Ne(r,n),t&&(r.innerHTML=t),r}function K(e,n){var t=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1,r=arguments.length>3&&arguments[3]!==void 0?arguments[3]:"customFiltersContainer",u=f("#".concat(r),e);if(u)if(t)u.remove();else return;u=Pe(),u.id=r,n(u,e)}function Re(e){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"common",t=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1,r=window.location.pathname;return G(r,e,n,t)}function G(e,n,t){var r=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1,u=e.split("/"),a=u[n]||t;return r&&console.log("Pathname element: ".concat(a)),a}function fn(e){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"common",t=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1,r=Re(e,"",t);return W(r,n,t)}function W(e,n,t){if(!e)return n;var r=e.split("-").at(-1);return t&&console.log("Pathname element ending: ".concat(r)),r}function dn(e,n){var t=arguments.length>2&&arguments[2]!==void 0?arguments[2]:"common",r=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1,u=G(e,n,"",r);return W(u,t,r)}function vn(e){var n=window.location.search;return De(n,e)}function De(e,n){var t=new URLSearchParams(e);return t.get(n)}function ke(e){return window.location.pathname.includes(e)}function Ae(e){var n=window.location.pathname.split("/");return n.some(function(t){return t===e})}function pn(e,n){return!Me(e,n)}function Me(e,n){if(!n.value)return!0;var t=e.toLowerCase(),r=n.value.toLowerCase().split(",").map(function(i){return i.trim()}),u=r.reduce(function(i,o){if(!o.startsWith("!"))i.include.push(o);else{var p=o.substring(1);p.length&&i.notInclude.push(p)}return i},{include:[],notInclude:[]}),a=u.include,l=u.notInclude;return a.every(function(i){return t.includes(i)})&&l.every(function(i){return!t.includes(i)})}function je(e,n){return n.value&&e<n.value}function Ve(e,n){return n.value&&e>n.value}function z(e,n){var t=arguments.length>2&&arguments[2]!==void 0?arguments[2]:null,r=arguments.length>3&&arguments[3]!==void 0?arguments[3]:null,u=createDivObsolete(e,t),a=createTextInput(n.updateValueFromEvent,r,n.value);return u.append(a),u}function s(e,n,t,r,u){var a=arguments.length>5&&arguments[5]!==void 0?arguments[5]:null,l=arguments.length>6&&arguments[6]!==void 0?arguments[6]:null,i=O(e,a),o=Fe(n.updateValueFromEvent,l,n.value,t,r,u);return i.append(o),i}function I(e,n){var t=arguments.length>2&&arguments[2]!==void 0?arguments[2]:null,r=arguments.length>3&&arguments[3]!==void 0?arguments[3]:null,u=O(e,t),a=Le(n.updateValueFromEvent,r,n.value);return u.append(a),u}function hn(e){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:null,t=arguments.length>2&&arguments[2]!==void 0?arguments[2]:null;return z("\u0421\u043E\u0434\u0435\u0440\u0436\u0438\u0442: ",e,n,t)}function yn(e){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:null,t=arguments.length>2&&arguments[2]!==void 0?arguments[2]:null;return z("\u041F\u0440\u043E\u0434\u0430\u0432\u0435\u0446: ",e,n,t)}function bn(e){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:null,t=arguments.length>2&&arguments[2]!==void 0?arguments[2]:null,r=arguments.length>3&&arguments[3]!==void 0?arguments[3]:.1;return s("\u041C\u0438\u043D. \u0440\u0435\u0439\u0442\u0438\u043D\u0433: ",e,r,3,5,n,t)}function Sn(e){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:null,t=arguments.length>2&&arguments[2]!==void 0?arguments[2]:null;return Q("\u041C\u0438\u043D. \u043E\u0442\u0437\u044B\u0432\u043E\u0432: ",e,n,t)}function En(e){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:null,t=arguments.length>2&&arguments[2]!==void 0?arguments[2]:null;return Q("\u041C\u0430\u043A\u0441. \u043E\u0442\u0437\u044B\u0432\u043E\u0432: ",e,n,t)}function Q(e,n){var t=arguments.length>2&&arguments[2]!==void 0?arguments[2]:null,r=arguments.length>3&&arguments[3]!==void 0?arguments[3]:null;return s(e,n,"1","1","999999",t,r)}function Be(e){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:null,t=arguments.length>2&&arguments[2]!==void 0?arguments[2]:null;return $("\u041C\u0438\u043D. \u0441\u043A\u0438\u0434\u043A\u0430: ",e,n,t)}function Cn(e){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:null,t=arguments.length>2&&arguments[2]!==void 0?arguments[2]:null;return $("\u0421\u043A\u0438\u0434\u043A\u0430: ",e,n,t)}function $(e,n){var t=arguments.length>2&&arguments[2]!==void 0?arguments[2]:null,r=arguments.length>3&&arguments[3]!==void 0?arguments[3]:null;return s(e,n,"5","0","100",t,r)}function wn(e){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:null,t=arguments.length>2&&arguments[2]!==void 0?arguments[2]:null;return s("\u041C\u0438\u043D\u0438\u043C\u0430\u043B\u044C\u043D\u043E \u0433\u043E\u043B\u043E\u0441\u043E\u0432: ",e,"50","0","10000",n,t)}function Tn(e){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:null,t=arguments.length>2&&arguments[2]!==void 0?arguments[2]:null;return s("\u041C\u0438\u043D. \u043A\u0435\u0448\u0431\u0435\u043A: ",e,"5","0","100",n,t)}function J(e,n,t,r,u){return s(e,n,u,"0","1000000",t,r)}function xn(e,n,t){return s("\u041A\u0443\u043F\u043E\u043D: ",e,"500","0","100000",n,t)}function Ue(e){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:null,t=arguments.length>2&&arguments[2]!==void 0?arguments[2]:null,r=arguments.length>3&&arguments[3]!==void 0?arguments[3]:"250";return J("\u041C\u0430\u043A\u0441. \u0446\u0435\u043D\u0430: ",e,n,t,r)}function _n(e){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:null,t=arguments.length>2&&arguments[2]!==void 0?arguments[2]:null;return J("\u041C\u0430\u043A\u0441. \u0446\u0435\u043D\u0430 \u0441\u043E \u0441\u043A\u0438\u0434\u043A\u043E\u0439: ",e,n,t,"250")}function On(e){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:null,t=arguments.length>2&&arguments[2]!==void 0?arguments[2]:null;return I("\u0411\u0435\u0437 \u0440\u0435\u0439\u0442\u0438\u043D\u0433\u0430: ",e,n,t)}function X(e){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:null,t=arguments.length>2&&arguments[2]!==void 0?arguments[2]:null;return I("\u0412\u043A\u043B: ",e,n,t)}function Z(e,n){e.parentNode.insertBefore(n,e.nextSibling)}function He(e){re(e),ne(e,"none")}function ee(e,n){n=n||te(e),ne(e,n)}function qe(e,n,t){n?He(e):(t=t||te(e),ee(e,t))}function ne(e,n){e.style.display=n}function te(e){return re(e),e.getAttribute("display")}function re(e){if(!e.hasAttribute("display")){var n=getComputedStyle(e),t=n.display;e.setAttribute("display",t)}}function In(e,n){var t=arguments.length>2&&arguments[2]!==void 0?arguments[2]:.2;n?Ke(e,t):Ye(e)}function Ye(e){e.style.opacity=""}function Ke(e){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:.2;e.style.opacity=n}function Nn(e){e.style.order=""}function Fn(e,n){e.style.order=n}function Ln(e,n){e.style.background=n}function Pn(e){var n=document.createElement("style");n.type="text/css",n.textContent=e,document.head.appendChild(n)}var ue=new m("min-discount-filter",null,C),ae=new m("max-price-filter",null,C),le=new m("filter-enabled",!0,C),N=new m("observer-reload-interval",3.5,D),ie=new m("min-observer-section-length",10),oe=new m("show-observer-notification",!0),F=new m("observer-enabled",!0,D),Ge="#main-content-id",L='[data-type="product-card-link"]',se="display: flex;margin-top: 14px;grid-gap: 15px;",c="display: flex;align-items: center;",We="margin-left: 5px;border: 2px solid #b3bcc5;border-radius: 6px;padding: 6px 10px;",S=We+"width: 90px;",P="margin-left: 5px;width: 25px;height: 25px;",g,ce=!0,R,d=null,E;ge(),ze();function ze(){var e=new MutationObserver(h(ge,750));e.observe(document.head,{childList:!0})}function ge(){if(g=f(Ge),!(!g||!ke("category"))){var e=new MutationObserver(h($e,100));e.observe(g,{childList:!0,subtree:!0})}}function me(e,n){var t=n?`
(`.concat(n," \u0442\u043E\u0432\u0430\u0440\u043E\u0432)"):"";window.GM_notification({text:'\u041F\u043E\u044F\u0432\u0438\u043B\u0441\u044F \u0440\u0430\u0437\u0434\u0435\u043B "'.concat(e,'"').concat(t),tag:"section-appear",highlight:!0,silent:!0})}function Rn(e){var n=getAllElements("h2",g),t=_toConsumableArray(n).some(function(r){return r.innerText.includes(e)});t&&me(e)}function Qe(e,n){var t=f(e);if(t){var r=T(L,t).length,u=f("h2",t);u.innerText+=" (".concat(r,")"),F.value&&oe.value&&r>=ie.value&&me(n,r)}}function D(){d&&(d=null),R&&clearInterval(R),E.textContent=null,!(!F.value||!N.value)&&(d=N.value*60,fe(),R=setInterval(fe,1e3))}function fe(){if(E.textContent="\u0414\u043E \u043E\u0431\u043D\u043E\u0432\u043B\u0435\u043D\u0438\u044F: ".concat(d," c."),d>0){d-=1;return}window.location.reload()}function $e(){var e=T(L,g);e.length&&(Ae("promo_and_cashback")&&K(g,Xe,!1,"observerControlsContainer"),K(g,Je),ce&&(ce=!1,D(),Qe('[data-id="promo-expiring-products"]',"\u041F\u043E\u0441\u043B\u0435\u0434\u043D\u0438\u0439 \u0434\u0435\u043D\u044C")),C())}function Je(e,n){e.style=se;var t=Be(ue,c,S),r=Ue(ae,c,S,"25"),u=X(le,c,P);e.append(t,r,u),Z(n.firstChild,e)}function Xe(e,n){e.style=se;var t=c+"margin-left: auto;width: 170px;",r=s("\u041E\u0431\u043D\u043E\u0432\u043B\u0435\u043D\u0438\u0435, \u043C\u0438\u043D.: ",N,.5,1,60,c,S),u=s("\u041C\u0438\u043D. \u0432 \u0441\u0435\u043A\u0446\u0438\u0438: ",ie,1,1,50,c,S),a=I("\u041E\u043F\u043E\u0432\u0435\u0449\u0435\u043D\u0438\u0435: ",oe,c,P),l=X(F,c,P);E=O(d,t),e.append(r,u,a,l,E),Z(n.firstChild,e)}function C(){var e=T(L,g);e.forEach(function(n){var t=n.parentNode,r=t.parentNode.parentNode.parentNode;if(r.style.flex="none",r.style.width="25%",!le.value){ee(r);return}var u=Ze(t),a=f('span [aria-hidden="true"]',r),l=x(a,!0),i=je(u,ue)||Ve(l,ae);qe(r,i)})}function Ze(e){var n=f("li",e);if(!n)return 0;var t=n.innerText;return t.includes("%")?+Ce(t):0}})();})();
