// ==UserScript==
// @name         Vseins product cards filter
// @description  Hide product cards by filter
// @grant        GM_addValueChangeListener
// @grant        GM_setValue
// @grant        GM_getValue
// @match        https://www.vseinstrumenti.ru/tag-page/*
// @match        https://www.vseinstrumenti.ru/category/*
// @namespace    https://github.com/reliable-code/product-list-filters
// @version      0.1.73634211
// @icon         https://www.google.com/s2/favicons?sz=64&domain=vseinstrumenti.ru
// @author       reliable-code
// ==/UserScript==

(()=>{(()=>{"use strict";var A={9928:(C,m,n)=>{n.d(m,{S:()=>h,Sw:()=>b,kU:()=>v,o5:()=>f});var p=n(4921),w=n(573);function v(r,i,d){const u=l(r,"text",i);return u.value=d,u}function f(r,i,d,u,g,t){const e=l(r,"number",i);return e.value=d,e.step=u,e.min=g,e.max=t,e}function h(r,i,d){const u=l(r,"checkbox",i);return u.checked=d,u}function l(r={},i=null,d=null){const u=o("input",r);return i&&(u.type=i),d&&(u.addEventListener("keyup",(0,p.sg)(d,200)),u.addEventListener("change",(0,p.sg)(d,100))),u}function a(r={},i=null){return o("span",r,i)}function c(r={},i=null,d=null){const u=o("a",r,i);return d&&(u.href=d),u}function S(r={},i=null,d=null){const u=o("button",r,i);return d&&(u.onclick=d),u}function b(r={},i=null){return o("div",r,i)}function o(r,i,d=null){if(typeof i!="object"||i===null)throw new TypeError("styles should be an object");const u=document.createElement(r);return(0,w.ZM)(u,i),d&&(u.innerHTML=d),u}},573:(C,m,n)=>{n.d(m,{Fi:()=>v,ML:()=>S,ZM:()=>o,fI:()=>f});var p=n(4214);function w(u,g=document){return!!g.querySelector(u)}function v(u,g=document,t=!1){const e=g.querySelector(u);return t&&!e&&console.log(`No element found for selector: ${u}`),e}function f(u,g=document,t=!1){const e=g.querySelectorAll(u);return t&&!e.length&&console.log(`No elements found for selector: ${u}`),e}function h(u,g,t){return[...u.querySelectorAll(g)].find(e=>e.textContent.trim().includes(t))}function l(u,g,t=!1,e=!1){const s=v(g,u,!0);return a(s,t,e)}function a(u,g=!1,t=!1,e=null){if(!u)return e===null?(console.log("No element found"),null):e;const s=u.innerText;return b(s,g,t)}function c(u,g,t=!1){const e=u[g];return a(e,t)}function S(u,g=!1,t=!1){const e=u.textContent;return b(e,g,t)}function b(u,g,t){return g&&(u=(0,p.zr)(u)),t&&(u=u.replace(",",".")),+u}function o(u,g){Object.assign(u.style,g)}function r(u){return Object.entries(u).map(([g,t])=>`${g.replace(/([A-Z])/g,"-$1").toLowerCase()}: ${t};`).join(" ")}function i(u){return u?u.split(";").filter(g=>g.trim()!=="").reduce((g,t)=>{const[e,s]=t.split(":").map(x=>x.trim()),y=e.replace(/-([a-z])/g,(x,E)=>E.toUpperCase());return g[y]=s,g},{}):{}}function d(u){const g=t=>t.nodeType===Node.TEXT_NODE&&t.textContent.trim()!==""?[t]:[...t.childNodes].flatMap(g);return g(u)}},5539:(C,m,n)=>{n.d(m,{Bt:()=>w,UC:()=>h,kl:()=>f});function p(t,e){t.parentNode.insertBefore(e,t.nextSibling)}function w(t){S(t),a(t,"none")}function v(t){t.intersectionObserver||runOnceOnIntersection(t,()=>w(t))}function f(t){const e=c(t);a(t,e)}function h(t,e){e?w(t):f(t)}function l(t,e){e?v(t):(clearIntersectionObserver(t),f(t))}function a(t,e){t.style.display=e}function c(t){return S(t),t.defaultDisplay}function S(t){if(t.defaultDisplay)return;const{display:e}=getComputedStyle(t);t.defaultDisplay=e}function b(t,e,s=.3){e?r(t,s):o(t)}function o(t){t.style.opacity=""}function r(t,e=.3){t.style.opacity=e}function i(t){t.style.order=""}function d(t,e){t.style.order=e}function u(t,e){t.style.background=e}function g(t,e="custom-global-style"){let s=document.getElementById(e);s||(s=document.createElement("style"),s.id=e,s.type="text/css",document.head.appendChild(s)),s.textContent=t}},4921:(C,m,n)=>{n.d(m,{sg:()=>v,xk:()=>p});async function p(l,a,c=null){const S=l.querySelector(a);return S?Promise.resolve(S):new Promise(b=>{const o=new MutationObserver(i);o.observe(l,{childList:!0,subtree:!0});let r=null;c&&(r=setTimeout(()=>{o.disconnect(),console.log(`No element found for selector: ${a}`),b(null)},c));function i(){const d=l.querySelector(a);d&&(r&&clearTimeout(r),o.disconnect(),b(d))}})}async function w(l,a){return l.querySelector(a)?new Promise(S=>{const b=new MutationObserver(o);b.observe(l,{childList:!0,subtree:!0});function o(){l.querySelector(a)||(b.disconnect(),S())}}):Promise.resolve()}function v(l,a=250){let c;return(...S)=>{clearTimeout(c),c=setTimeout(()=>l(...S),a)}}function f(l,a){const c=new IntersectionObserver(S=>{S.forEach(b=>{b.isIntersecting&&(a(),h(l))})});l.intersectionObserver=c,c.observe(l)}function h(l){l.intersectionObserver&&(l.intersectionObserver.disconnect(),l.intersectionObserver=null)}},3829:(C,m,n)=>{n.d(m,{Ay:()=>w,JE:()=>f});var p=n(8355);function w(a,c){return!v(a,c)}function v(a,c){if(!c.value)return!0;const S=a.toLowerCase(),b=(0,p.R)(c),o=[],r=[];return b.forEach(i=>{if(i.startsWith("!")){const d=i.substring(1);d&&r.push(d)}else o.push(i)}),o.every(i=>S.includes(i))&&r.every(i=>!S.includes(i))}function f(a,c){return c.value!=null&&a<c.value}function h(a,c){return c.value!=null&&a>c.value}function l(a,c){return c.value!=null&&a!==c.value}},4521:(C,m,n)=>{n.d(m,{z:()=>w});var p=n(4160);function w(v,f=null){return{createGlobalFilter(h,l=null,a=v){return p.VB.create(h,l,a)},createSectionFilter(h,l=null,a=v){if(!f)throw new Error("sectionId must be provided to use createSectionFilter.");return p.VB.createWithCompositeKey(f,h,l,a)}}}},5884:(C,m,n)=>{n.d(m,{Hw:()=>f,Nm:()=>w,nW:()=>v});var p=n(9928);function w(h,l,a={},c={}){const S=(0,p.Sw)(a,h),b=(0,p.kU)(c,l.updateValueFromEvent,l.value);return S.append(b),S}function v(h,l,a,c,S,b={},o={}){const r=(0,p.Sw)(b,h),i=(0,p.o5)(o,l.updateValueFromEvent,l.value,a,c,S);return r.append(i),r}function f(h,l,a={},c={}){const S=(0,p.Sw)(a,h),b=(0,p.S)(c,l.updateValueFromEvent,l.value);return S.append(b),S}},7877:(C,m,n)=>{n.d(m,{E9:()=>w,HX:()=>v,X0:()=>h,pW:()=>t});var p=n(5884);function w(e,s={},y={}){return(0,p.Nm)("\u041F\u043E\u0438\u0441\u043A: ",e,s,y)}function v(e,s={},y={},x=.1,E=3){return(0,p.nW)("\u041C\u0438\u043D. \u0440\u0435\u0439\u0442\u0438\u043D\u0433: ",e,x,E,5,s,y)}function f(e,s={},y={},x=.1,E=3){return createNumberFilterControl("\u041C\u0430\u043A\u0441. \u0440\u0435\u0439\u0442\u0438\u043D\u0433: ",e,x,E,5,s,y)}function h(e,s={},y={}){return a("\u041C\u0438\u043D. \u043E\u0442\u0437\u044B\u0432\u043E\u0432: ",e,s,y)}function l(e,s={},y={}){return a("\u041C\u0430\u043A\u0441. \u043E\u0442\u0437\u044B\u0432\u043E\u0432: ",e,s,y)}function a(e,s,y={},x={}){return(0,p.nW)(e,s,"1","1","999999",y,x)}function c(e,s={},y={}){return S("\u041C\u0438\u043D. \u0441\u043A\u0438\u0434\u043A\u0430: ",e,s,y)}function S(e,s,y={},x={}){return createNumberFilterControl(e,s,"5","0","100",y,x)}function b(e,s={},y={}){return createNumberFilterControl("\u041C\u0438\u043D. \u043A\u0435\u0448\u0431\u0435\u043A: ",e,"5","0","100",s,y)}function o(e,s,y={},x={},E="250"){return createNumberFilterControl(e,s,E,"0","1000000",y,x)}function r(e,s={},y={},x="25"){return o("\u041C\u0438\u043D. \u0446\u0435\u043D\u0430: ",e,s,y,x)}function i(e,s={},y={},x="25"){return o("\u041C\u0430\u043A\u0441. \u0446\u0435\u043D\u0430: ",e,s,y,x)}function d(e,s,y={},x={}){return createNumberFilterControl(e,s,"1","0","99999",y,x)}function u(e,s={},y={}){return createCheckboxFilterControl("\u0411\u0435\u0437 \u0440\u0435\u0439\u0442\u0438\u043D\u0433\u0430: ",e,s,y)}function g(e,s={},y={}){return createCheckboxFilterControl("\u0421 \u0444\u043E\u0442\u043E: ",e,s,y)}function t(e,s={},y={}){return(0,p.Hw)("\u0412\u043A\u043B: ",e,s,y)}},8355:(C,m,n)=>{n.d(m,{R:()=>p});function p(v){return v.value.toLowerCase().split(",").map(f=>f.trim()).filter(f=>f!=="")}function w(v){return p(v).filter(f=>!f.startsWith("!"))}},5213:(C,m,n)=>{n.d(m,{b:()=>v});var p=n(9928),w=n(573);function v(f,h,l=!1,a="customFiltersContainer"){let c=(0,w.Fi)(`#${a}`,f);if(c)if(l)c.remove();else return;c=(0,p.Sw)(),c.id=a,h(c,f)}},8200:(C,m,n)=>{n.d(m,{s:()=>p});function p(w){const{target:v}=w,{type:f}=v;switch(f){case"text":return`"${v.value}"`;case"number":return v.value;case"checkbox":return v.checked;default:return console.log(`Unknown input type: ${f}`),null}}},1870:(C,m,n)=>{n.d(m,{j:()=>p});class p{constructor(v,f){this.value=v,this.onChange=f}onChangeIfDefined=()=>{this.onChange&&this.onChange()}}},4160:(C,m,n)=>{n.d(m,{VB:()=>c});var p=n(1870),w=n(8200),v=n(3976);const f=window.GM_setValue,h=window.GM.setValue,l=window.GM_getValue,a=window.GM_addValueChangeListener;class c extends p.j{constructor(b,o=null,r=null){super(l(b,o),r),this.storageKey=b,this.defaultValue=o}static create(b,o=null,r=null){return new c(b,o,r)}static createWithCompositeKey(b,o,r=null,i=null){const d=`${b}-${o}`;return new c(d,r,i)}updateValueFromEvent=b=>{const o=(0,w.s)(b),r=(0,v.$)(o);this.updateValue(r)};updateValue(b){this.value!==b&&(f(this.storageKey,b),this.value=b,this.onChangeIfDefined())}clearValue(){this.updateValue(null)}resetValue(){this.updateValue(this.defaultValue)}}},3976:(C,m,n)=>{n.d(m,{$:()=>p});function p(w){return w===""?null:JSON.parse(w)}},4214:(C,m,n)=>{n.d(m,{zr:()=>w});function p(h){return h.replace(/\D/g,"")}function w(h){return h.replace(/[^\d.,-]/g,"")}function v(h){return h.replace(/\s/g,"")}function f(h){return h.charAt(0).toUpperCase()+h.slice(1)}},5406:(C,m,n)=>{n.d(m,{Fc:()=>p});function p(o,r="common",i=!1){const{pathname:d}=window.location;return w(d,o,r,i)}function w(o,r,i,d=!1){const g=o.split("/")[r]||i;return d&&console.log(`Pathname element: ${g}`),g}function v(o,r="common",i=!1){const d=p(o,"",i);return f(d,r,i)}function f(o,r,i){if(!o)return r;const d=o.split("-").at(-1);return i&&console.log(`Pathname element ending: ${d}`),d}function h(o,r,i="common",d=!1){const u=w(o,r,"",d);return f(u,i,d)}function l(o){const r=window.location.search;return a(r,o)}function a(o,r){return new URLSearchParams(o).get(r)}function c(o){return window.location.pathname.includes(o)}function S(o){return o.some(r=>c(r))}function b(o){return window.location.pathname.split("/").some(i=>i===o)}},6220:(C,m,n)=>{n.a(C,async(p,w)=>{try{let y=function(F,N){(0,a.ZM)(F,o.r.filtersContainer);const k=(0,c.E9)(u,o.r.control,o.r.textInput),I=(0,c.X0)(g,o.r.control,o.r.numberInput),R=(0,c.HX)(t,o.r.control,o.r.numberInput),L=(0,c.pW)(e,o.r.control,o.r.checkboxInput);F.append(k,I,R,L),N.parentNode.insertBefore(F,N)},x=function(){(0,a.fI)(`${r.Z.PRODUCT_LIST} > div`).forEach(E)},E=function(F){if(!e.value){(0,l.kl)(F);return}const N=(0,a.Fi)(r.Z.PRODUCT_NAME_WRAP,F),k=(0,a.Fi)(r.Z.PRODUCT_RATING_WRAP,F);if(!N||!k){(0,l.Bt)(F);return}const I=N.innerText,R=(0,a.ML)(k.childNodes[2],!0),D=+(0,a.Fi)(r.Z.PRODUCT_RATING,k).getAttribute("value"),$=(0,h.Ay)(I,u)||(0,h.JE)(R,g)||(0,h.JE)(D,t);(0,l.UC)(F,$)};var v=n(4921),f=n(5213),h=n(3829),l=n(5539),a=n(573),c=n(7877),S=n(5406),b=n(4521),o=n(6504),r=n(4858);const i=(0,S.Fc)(2),{createSectionFilter:d}=(0,b.z)(x,i),u=d("name-filter"),g=d("min-reviews-filter"),t=d("min-rating-filter",4.8),e=d("filter-enabled",!0);await s();async function s(){if(!await(0,v.xk)(document,r.Z.PRODUCT_LIST_TOP))return;const N=(0,a.Fi)(r.Z.PRODUCT_LIST,document,!0);(0,f.b)(N,y,!0),new MutationObserver(x).observe(N,{childList:!0,subtree:!0})}w()}catch(i){w(i)}},1)},4858:(C,m,n)=>{n.d(m,{Z:()=>p});const p={PRODUCT_LIST:'[data-qa="listing"]',PRODUCT_LIST_TOP:"#product-listing-top",PRODUCT_NAME_WRAP:'[data-qa="product-name"]',PRODUCT_RATING_WRAP:'[data-qa="product-rating"]',PRODUCT_RATING:'[name="rating"]'}},6504:(C,m,n)=>{n.d(m,{r:()=>w});const p={input:{marginLeft:"5px",border:"1px solid #dadcde",borderRadius:"8px",padding:"8px 16px",fontSize:"16px"}},w={filtersContainer:{display:"flex",gridGap:"11px",marginBottom:"18px"},control:{display:"flex",alignItems:"center",fontSize:"16px"},textInput:{...p.input,width:"180px"},numberInput:{...p.input,width:"90px"},checkboxInput:{marginLeft:"5px",width:"22px",height:"22px"}}}},V={};function T(C){var m=V[C];if(m!==void 0)return m.exports;var n=V[C]={exports:{}};return A[C](n,n.exports,T),n.exports}(()=>{var C=typeof Symbol=="function"?Symbol("webpack queues"):"__webpack_queues__",m=typeof Symbol=="function"?Symbol("webpack exports"):"__webpack_exports__",n=typeof Symbol=="function"?Symbol("webpack error"):"__webpack_error__",p=v=>{v&&v.d<1&&(v.d=1,v.forEach(f=>f.r--),v.forEach(f=>f.r--?f.r++:f()))},w=v=>v.map(f=>{if(f!==null&&typeof f=="object"){if(f[C])return f;if(f.then){var h=[];h.d=0,f.then(c=>{l[m]=c,p(h)},c=>{l[n]=c,p(h)});var l={};return l[C]=c=>c(h),l}}var a={};return a[C]=c=>{},a[m]=f,a});T.a=(v,f,h)=>{var l;h&&((l=[]).d=-1);var a=new Set,c=v.exports,S,b,o,r=new Promise((i,d)=>{o=d,b=i});r[m]=c,r[C]=i=>(l&&i(l),a.forEach(i),r.catch(d=>{})),v.exports=r,f(i=>{S=w(i);var d,u=()=>S.map(t=>{if(t[n])throw t[n];return t[m]}),g=new Promise(t=>{d=()=>t(u),d.r=0;var e=s=>s!==l&&!a.has(s)&&(a.add(s),s&&!s.d&&(d.r++,s.push(d)));S.map(s=>s[C](e))});return d.r?g:u()},i=>(i?o(r[n]=i):b(c),p(l))),l&&l.d<0&&(l.d=0)}})(),T.d=(C,m)=>{for(var n in m)T.o(m,n)&&!T.o(C,n)&&Object.defineProperty(C,n,{enumerable:!0,get:m[n]})},T.o=(C,m)=>Object.prototype.hasOwnProperty.call(C,m);var P=T(6220)})();})();
