// ==UserScript==
// @name         Vseins product cards filter
// @description  Hide product cards by filter
// @grant        GM_addValueChangeListener
// @grant        GM_setValue
// @grant        GM_getValue
// @match        https://www.vseinstrumenti.ru/tag-page/*
// @match        https://www.vseinstrumenti.ru/category/*
// @namespace    https://github.com/reliable-code/product-list-filters
// @version      0.1.73672377
// @icon         https://www.google.com/s2/favicons?sz=64&domain=vseinstrumenti.ru
// @author       reliable-code
// ==/UserScript==

(()=>{(()=>{"use strict";var P={9928:(w,f,t)=>{t.d(f,{S:()=>p,Sw:()=>S,kU:()=>m,o5:()=>s});var d=t(4921),b=t(5539);function m(a,e,n){const l=i(a,"text",e);return l.value=n,l}function s(a,e,n,l,x,N){const v=i(a,"number",e);return v.value=n,v.step=l,v.min=x,v.max=N,v}function p(a,e,n){const l=i(a,"checkbox",e);return l.checked=n,l}function i(a={},e=null,n=null){const l=c("input",a);return e&&(l.type=e),n&&(l.addEventListener("keyup",(0,d.sg)(n,200)),l.addEventListener("change",(0,d.sg)(n,100))),l}function r(a={},e=null){return c("span",a,e)}function o(a={},e=null,n=null){const l=c("a",a,e);return n&&(l.href=n),l}function g(a={},e=null,n=null){const l=c("button",a,e);return n&&(l.onclick=n),l}function S(a={},e=null){return c("div",a,e)}function c(a,e,n=null){if(typeof e!="object"||e===null)throw new TypeError("styles should be an object");const l=document.createElement(a);return(0,b.ZM)(l,e),n&&(l.innerHTML=n),l}},573:(w,f,t)=>{t.d(f,{Fi:()=>m,ML:()=>g,fI:()=>s});var d=t(4214);function b(e,n=document){return!!n.querySelector(e)}function m(e,n=document,l=!1){const x=n.querySelector(e);return l&&!x&&console.log(`No element found for selector: ${e}`),x}function s(e,n=document,l=!1){const x=n.querySelectorAll(e);return l&&!x.length&&console.log(`No elements found for selector: ${e}`),x}function p(e,n,l){return[...e.querySelectorAll(n)].find(x=>x.textContent.trim().includes(l))}function i(e,n,l=!1,x=!1){const N=m(n,e,!0);return r(N,l,x)}function r(e,n=!1,l=!1,x=null){if(!e)return x===null?(console.log("No element found"),null):x;const N=e.innerText;return S(N,n,l)}function o(e,n,l=!1){const x=e[n];return r(x,l)}function g(e,n=!1,l=!1){const x=e.textContent;return S(x,n,l)}function S(e,n,l){return n&&(e=(0,d.zr)(e)),l&&(e=e.replace(",",".")),+e}function c(e){return[...e.childNodes].find(n=>n.nodeType===Node.TEXT_NODE)}function a(e){const n=l=>l.nodeType===Node.TEXT_NODE&&l.textContent.trim()!==""?[l]:[...l.childNodes].flatMap(n);return n(e)}},5539:(w,f,t)=>{t.d(f,{Bt:()=>b,UC:()=>r,ZM:()=>F,kl:()=>p});function d(u,y){u.parentNode.insertBefore(y,u.nextSibling)}function b(u){u.style.display="none"}function m(u){S(u),b(u)}function s(u){u.intersectionObserver||runOnceOnIntersection(u,()=>b(u))}function p(u){u.style.display=""}function i(u){const y=g(u);u.style.display=y}function r(u,y){y?b(u):p(u)}function o(u,y){y?s(u):(clearIntersectionObserver(u),p(u))}function g(u){return S(u),u.defaultDisplay}function S(u){if(u.defaultDisplay)return;const{display:y}=getComputedStyle(u);u.defaultDisplay=y}function c(){return{show:[],hide:[]}}function a(u,y,E){u?y.hide.push(E):y.show.push(E)}function e(u){u.show.forEach(p),u.hide.forEach(b)}function n(u,y,E=.3){y?x(u,E):l(u)}function l(u){u.style.opacity=""}function x(u,y=.3){u.style.opacity=y}function N(u){u.style.order=""}function v(u,y){u.style.order=y}function h(u,y){u.style.background=y}function C(u,y="custom-global-style"){let E=document.getElementById(y);E||(E=document.createElement("style"),E.id=y,E.type="text/css",document.head.appendChild(E)),E.textContent=u}function F(u,y){Object.assign(u.style,y)}function k(u){return Object.entries(u).map(([y,E])=>`${y.replace(/([A-Z])/g,"-$1").toLowerCase()}: ${E};`).join(" ")}function T(u){return u?u.split(";").filter(y=>y.trim()!=="").reduce((y,E)=>{const[R,D]=E.split(":").map(V=>V.trim()),A=R.replace(/-([a-z])/g,(V,O)=>O.toUpperCase());return y[A]=D,y},{}):{}}},4921:(w,f,t)=>{t.d(f,{sg:()=>m,xk:()=>d});async function d(i,r,o=null){const g=i.querySelector(r);return g?Promise.resolve(g):new Promise(S=>{const c=new MutationObserver(e);c.observe(i,{childList:!0,subtree:!0});let a=null;o&&(a=setTimeout(()=>{c.disconnect(),console.log(`No element found for selector: ${r}`),S(null)},o));function e(){const n=i.querySelector(r);n&&(a&&clearTimeout(a),c.disconnect(),S(n))}})}async function b(i,r){return i.querySelector(r)?new Promise(g=>{const S=new MutationObserver(c);S.observe(i,{childList:!0,subtree:!0});function c(){i.querySelector(r)||(S.disconnect(),g())}}):Promise.resolve()}function m(i,r=250){let o;return(...g)=>{clearTimeout(o),o=setTimeout(()=>i(...g),r)}}function s(i,r){const o=new IntersectionObserver(g=>{g.forEach(S=>{S.isIntersecting&&(r(),p(i))})});i.intersectionObserver=o,o.observe(i)}function p(i){i.intersectionObserver&&(i.intersectionObserver.disconnect(),i.intersectionObserver=null)}},3829:(w,f,t)=>{t.d(f,{Ay:()=>b,JE:()=>s});var d=t(8355);function b(r,o){return!m(r,o)}function m(r,o){if(!o.value)return!0;const g=r.toLowerCase(),S=(0,d.R)(o),c=[],a=[];return S.forEach(e=>{if(e.startsWith("!")){const n=e.substring(1);n&&a.push(n)}else c.push(e)}),c.every(e=>g.includes(e))&&a.every(e=>!g.includes(e))}function s(r,o){return o.value!=null&&r<o.value}function p(r,o){return o.value!=null&&r>o.value}function i(r,o){return o.value&&r!==o.value}},4521:(w,f,t)=>{t.d(f,{z:()=>b});var d=t(3048);function b(m,s=null){return{createGlobalFilter(p,i=null,r=m){return d.V.create(p,i,r)},createSectionFilter(p,i=null,r=m){if(!s)throw new Error("sectionId must be provided to use createSectionFilter.");return d.V.createWithCompositeKey(s,p,i,r)}}}},5884:(w,f,t)=>{t.d(f,{Hw:()=>s,Nm:()=>b,nW:()=>m});var d=t(9928);function b(p,i,r={},o={}){const g=(0,d.Sw)(r,p),S=(0,d.kU)(o,i.updateValueFromEvent,i.value);return g.append(S),g}function m(p,i,r,o,g,S={},c={}){const a=(0,d.Sw)(S,p),e=(0,d.o5)(c,i.updateValueFromEvent,i.value,r,o,g);return a.append(e),a}function s(p,i,r={},o={}){const g=(0,d.Sw)(r,p),S=(0,d.S)(o,i.updateValueFromEvent,i.value);return g.append(S),g}},7877:(w,f,t)=>{t.d(f,{E9:()=>b,HX:()=>m,X0:()=>p,pW:()=>N});var d=t(5884);function b(v,h={},C={}){return(0,d.Nm)("\u041F\u043E\u0438\u0441\u043A: ",v,h,C)}function m(v,h={},C={},F=.1,k=3){return(0,d.nW)("\u041C\u0438\u043D. \u0440\u0435\u0439\u0442\u0438\u043D\u0433: ",v,F,k,5,h,C)}function s(v,h={},C={},F=.1,k=3){return createNumberFilterControl("\u041C\u0430\u043A\u0441. \u0440\u0435\u0439\u0442\u0438\u043D\u0433: ",v,F,k,5,h,C)}function p(v,h={},C={}){return r("\u041C\u0438\u043D. \u043E\u0442\u0437\u044B\u0432\u043E\u0432: ",v,h,C)}function i(v,h={},C={}){return r("\u041C\u0430\u043A\u0441. \u043E\u0442\u0437\u044B\u0432\u043E\u0432: ",v,h,C)}function r(v,h,C={},F={}){return(0,d.nW)(v,h,"1","1","999999",C,F)}function o(v,h={},C={}){return g("\u041C\u0438\u043D. \u0441\u043A\u0438\u0434\u043A\u0430: ",v,h,C)}function g(v,h,C={},F={}){return createNumberFilterControl(v,h,"5","0","100",C,F)}function S(v,h={},C={}){return createNumberFilterControl("\u041C\u0438\u043D. \u043A\u0435\u0448\u0431\u0435\u043A: ",v,"5","0","100",h,C)}function c(v,h,C={},F={},k="250"){return createNumberFilterControl(v,h,k,"0","1000000",C,F)}function a(v,h={},C={},F="25"){return c("\u041C\u0438\u043D. \u0446\u0435\u043D\u0430: ",v,h,C,F)}function e(v,h={},C={},F="25"){return c("\u041C\u0430\u043A\u0441. \u0446\u0435\u043D\u0430: ",v,h,C,F)}function n(v,h,C={},F={}){return createNumberFilterControl(v,h,"1","0","99999",C,F)}function l(v,h={},C={}){return createCheckboxFilterControl("\u0411\u0435\u0437 \u0440\u0435\u0439\u0442\u0438\u043D\u0433\u0430: ",v,h,C)}function x(v,h={},C={}){return createCheckboxFilterControl("\u0421 \u0444\u043E\u0442\u043E: ",v,h,C)}function N(v,h={},C={}){return(0,d.Hw)("\u0412\u043A\u043B: ",v,h,C)}},8355:(w,f,t)=>{t.d(f,{R:()=>d});function d(m){return m.value.toLowerCase().split(",").map(s=>s.trim()).filter(s=>s!=="")}function b(m){return d(m).filter(s=>!s.startsWith("!"))}},5213:(w,f,t)=>{t.d(f,{b:()=>m});var d=t(9928),b=t(573);function m(s,p,i=!1,r="customFiltersContainer"){let o=(0,b.Fi)(`#${r}`,s);if(o)if(i)o.remove();else return;o=(0,d.Sw)(),o.id=r,p(o,s)}},8200:(w,f,t)=>{t.d(f,{s:()=>d});function d(b){const{target:m}=b,{type:s}=m;switch(s){case"text":return`"${m.value}"`;case"number":return m.value;case"checkbox":return m.checked;default:return console.log(`Unknown input type: ${s}`),null}}},157:(w,f,t)=>{t.d(f,{Fg:()=>d,vx:()=>m});const d=window.GM_setValue,b=window.GM.setValue,m=window.GM_getValue,s=window.GM_addValueChangeListener},1870:(w,f,t)=>{t.d(f,{j:()=>d});class d{constructor(m,s){this.value=m,this.onChange=s}onChangeIfDefined=()=>{this.onChange&&this.onChange()}}},3048:(w,f,t)=>{t.d(f,{V:()=>p});var d=t(1870),b=t(8200),m=t(3976),s=t(157);class p extends d.j{constructor(r,o=null,g=null){super((0,s.vx)(r,o),g),this.storageKey=r,this.defaultValue=o}static create(r,o=null,g=null){return new p(r,o,g)}static createWithCompositeKey(r,o,g=null,S=null){const c=`${r}-${o}`;return new p(c,g,S)}updateValueFromEvent=r=>{const o=(0,b.s)(r),g=(0,m.$)(o);this.updateValue(g)};updateValue(r){this.value!==r&&((0,s.Fg)(this.storageKey,r),this.value=r,this.onChangeIfDefined())}clearValue(){this.updateValue(null)}resetValue(){this.updateValue(this.defaultValue)}}},3976:(w,f,t)=>{t.d(f,{$:()=>d});function d(b){return b===""?null:JSON.parse(b)}},4214:(w,f,t)=>{t.d(f,{zr:()=>b});function d(p){return p.replace(/\D/g,"")}function b(p){return p.replace(/[^\d.,-]/g,"")}function m(p){return p.replace(/\s/g,"")}function s(p){return p.charAt(0).toUpperCase()+p.slice(1)}},5406:(w,f,t)=>{t.d(f,{Fc:()=>d});function d(c,a="common",e=!1){const{pathname:n}=window.location;return b(n,c,a,e)}function b(c,a,e,n=!1){const x=c.split("/")[a]||e;return n&&console.log(`Pathname element: ${x}`),x}function m(c,a="common",e=!1){const n=d(c,"",e);return s(n,a,e)}function s(c,a,e){if(!c)return a;const n=c.split("-").at(-1);return e&&console.log(`Pathname element ending: ${n}`),n}function p(c,a,e="common",n=!1){const l=b(c,a,"",n);return s(l,e,n)}function i(c){const a=window.location.search;return r(a,c)}function r(c,a){return new URLSearchParams(c).get(a)}function o(c){return window.location.pathname.includes(c)}function g(c){return c.some(a=>o(a))}function S(c){return window.location.pathname.split("/").some(e=>e===c)}},6220:(w,f,t)=>{t.a(w,async(d,b)=>{try{let C=function(T,u){(0,i.ZM)(T,c.r.filtersContainer);const y=(0,o.E9)(l,c.r.control,c.r.textInput),E=(0,o.X0)(x,c.r.control,c.r.numberInput),R=(0,o.HX)(N,c.r.control,c.r.numberInput),D=(0,o.pW)(v,c.r.control,c.r.checkboxInput);T.append(y,E,R,D),u.parentNode.insertBefore(T,u)},F=function(){(0,r.fI)(`${a.Z.PRODUCT_LIST} > div`).forEach(k)},k=function(T){if(!v.value){(0,i.kl)(T);return}const u=(0,r.Fi)(a.Z.PRODUCT_NAME_WRAP,T),y=(0,r.Fi)(a.Z.PRODUCT_RATING_WRAP,T);if(!u||!y){(0,i.Bt)(T);return}const E=u.innerText,R=(0,r.ML)(y.childNodes[2],!0),A=+(0,r.Fi)(a.Z.PRODUCT_RATING,y).getAttribute("value"),V=(0,p.Ay)(E,l)||(0,p.JE)(R,x)||(0,p.JE)(A,N);(0,i.UC)(T,V)};var m=t(4921),s=t(5213),p=t(3829),i=t(5539),r=t(573),o=t(7877),g=t(5406),S=t(4521),c=t(6504),a=t(4858);const e=(0,g.Fc)(2),{createSectionFilter:n}=(0,S.z)(F,e),l=n("name-filter"),x=n("min-reviews-filter"),N=n("min-rating-filter",4.8),v=n("filter-enabled",!0);await h();async function h(){if(!await(0,m.xk)(document,a.Z.PRODUCT_LIST_TOP))return;const u=(0,r.Fi)(a.Z.PRODUCT_LIST,document,!0);(0,s.b)(u,C,!0),new MutationObserver(F).observe(u,{childList:!0,subtree:!0})}b()}catch(e){b(e)}},1)},4858:(w,f,t)=>{t.d(f,{Z:()=>d});const d={PRODUCT_LIST:'[data-qa="listing"]',PRODUCT_LIST_TOP:"#product-listing-top",PRODUCT_NAME_WRAP:'[data-qa="product-name"]',PRODUCT_RATING_WRAP:'[data-qa="product-rating"]',PRODUCT_RATING:'[name="rating"]'}},6504:(w,f,t)=>{t.d(f,{r:()=>b});const d={input:{marginLeft:"5px",border:"1px solid #dadcde",borderRadius:"8px",padding:"8px 16px",fontSize:"16px"}},b={filtersContainer:{display:"flex",gridGap:"11px",marginBottom:"18px"},control:{display:"flex",alignItems:"center",fontSize:"16px"},textInput:{...d.input,width:"180px"},numberInput:{...d.input,width:"90px"},checkboxInput:{marginLeft:"5px",width:"22px",height:"22px"}}}},L={};function I(w){var f=L[w];if(f!==void 0)return f.exports;var t=L[w]={exports:{}};return P[w](t,t.exports,I),t.exports}(()=>{var w=typeof Symbol=="function"?Symbol("webpack queues"):"__webpack_queues__",f=typeof Symbol=="function"?Symbol("webpack exports"):"__webpack_exports__",t=typeof Symbol=="function"?Symbol("webpack error"):"__webpack_error__",d=m=>{m&&m.d<1&&(m.d=1,m.forEach(s=>s.r--),m.forEach(s=>s.r--?s.r++:s()))},b=m=>m.map(s=>{if(s!==null&&typeof s=="object"){if(s[w])return s;if(s.then){var p=[];p.d=0,s.then(o=>{i[f]=o,d(p)},o=>{i[t]=o,d(p)});var i={};return i[w]=o=>o(p),i}}var r={};return r[w]=o=>{},r[f]=s,r});I.a=(m,s,p)=>{var i;p&&((i=[]).d=-1);var r=new Set,o=m.exports,g,S,c,a=new Promise((e,n)=>{c=n,S=e});a[f]=o,a[w]=e=>(i&&e(i),r.forEach(e),a.catch(n=>{})),m.exports=a,s(e=>{g=b(e);var n,l=()=>g.map(N=>{if(N[t])throw N[t];return N[f]}),x=new Promise(N=>{n=()=>N(l),n.r=0;var v=h=>h!==i&&!r.has(h)&&(r.add(h),h&&!h.d&&(n.r++,h.push(n)));g.map(h=>h[w](v))});return n.r?x:l()},e=>(e?c(a[t]=e):S(o),d(i))),i&&i.d<0&&(i.d=0)}})(),I.d=(w,f)=>{for(var t in f)I.o(f,t)&&!I.o(w,t)&&Object.defineProperty(w,t,{enumerable:!0,get:f[t]})},I.o=(w,f)=>Object.prototype.hasOwnProperty.call(w,f);var $=I(6220)})();})();
