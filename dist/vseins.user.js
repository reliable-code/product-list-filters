// ==UserScript==
// @name         Vseins product cards filter
// @description  Hide product cards by filter
// @grant        GM_addValueChangeListener
// @grant        GM_setValue
// @grant        GM_getValue
// @match        https://www.vseinstrumenti.ru/tag-page/*
// @match        https://www.vseinstrumenti.ru/category/*
// @namespace    https://github.com/reliable-code/product-list-filters
// @version      1.0.73877098
// @icon         https://www.google.com/s2/favicons?sz=64&domain=vseinstrumenti.ru
// @author       reliable-code
// ==/UserScript==

(()=>{(()=>{"use strict";var j={5467:(x,s,n)=>{n.d(s,{E2:()=>m});var d=n(9928);function m(g,a={},e=null){const r=(0,d.Sw)(a,e);return r.append(g),r}function f(g,a=null,e={},r={}){const h=createActionLink(g,a,r);return m(h,e)}function l(g,a=null,e=null,r={},h={}){const C=createActionLinkWithIcon(g,e,a,h);return m(C,r)}},9928:(x,s,n)=>{n.d(s,{S:()=>g,Sw:()=>k,kU:()=>f,o5:()=>l});var d=n(4921),m=n(5539);function f(u,o,y){const p=a(u,"text",o);return p.value=y,p}function l(u,o,y,p,w,E){const b=a(u,"number",o);return b.value=y,b.step=p,b.min=w,b.max=E,b}function g(u,o,y){const p=a(u,"checkbox",o);return p.checked=y,p}function a(u={},o=null,y=null){const p=c("input",u);return o&&(p.type=o),y&&(p.addEventListener("keyup",(0,d.sg)(y,200)),p.addEventListener("change",(0,d.sg)(y,100))),p}function e(u={},o=null){return c("span",u,o)}function r(u={},o=null,y=null){const p=c("a",u,o);return y&&(p.href=y),p}function h(u,o=null,y={}){y.cursor||="pointer";const p=r(y,o);return u&&p.addEventListener("click",u),p}function C(u,o,y=null,p={}){p.display||="inline-flex",p.alignItems||="center",p.gap||="0.25em";const w=h(u,y,p);return w.prepend(t(o)),w}function F(u={},o=null,y=null){const p=c("button",u,o);return y&&p.addEventListener("click",y),p}function k(u={},o=null){return c("div",u,o)}function S(u={}){return c("i",u)}function t(u,o={}){o.width||="1em",o.height||="1em",o.paddingBottom||="1px";const y=S(o);return y.setAttribute("data-lucide",u),y}function c(u,o,y=null){if(typeof o!="object"||o===null)throw new TypeError("styles should be an object");const p=document.createElement(u);return(0,m.ZM)(p,o),y&&(p.innerHTML=y),p}},573:(x,s,n)=>{n.d(s,{Fi:()=>f,ML:()=>h,fI:()=>l});var d=n(4214);function m(t,c=document){return!!c.querySelector(t)}function f(t,c=document,u=!1){const o=c.querySelector(t);return u&&!o&&console.log(`No element found for selector: ${t}`),o}function l(t,c=document,u=!1){const o=c.querySelectorAll(t);return u&&!o.length&&console.log(`No elements found for selector: ${t}`),o}function g(t,c,u){return[...t.querySelectorAll(c)].find(o=>o.textContent.trim().includes(u))}function a(t,c,u=!1,o=!1){const y=f(c,t,!0);return e(y,u,o)}function e(t,c=!1,u=!1,o=null){if(!t)return o===null?(console.log("No element found"),null):o;const y=t.innerText;return C(y,c,u)}function r(t,c,u=!1){const o=t[c];return e(o,u)}function h(t,c=!1,u=!1){const o=t.textContent;return C(o,c,u)}function C(t,c,u){c&&(t=(0,d.zr)(t)),u&&(t=t.replace(",","."));const o=Number(t);return Number.isNaN(o)?(console.log(`Invalid number: ${t}`),0):o}function F(t){return[...t.childNodes].find(c=>c.nodeType===Node.TEXT_NODE)}function k(t){const c=u=>u.nodeType===Node.TEXT_NODE&&u.textContent.trim()!==""?[u]:[...u.childNodes].flatMap(c);return c(t)}function S(t){return normalizeSpacing(t.textContent)}},5539:(x,s,n)=>{n.d(s,{Bt:()=>m,UC:()=>e,ZM:()=>L,kl:()=>g});function d(i,v){i.parentNode.insertBefore(v,i.nextSibling)}function m(i){i.style.display="none"}function f(i){C(i),m(i)}function l(i){i.intersectionObserver||runOnceOnIntersection(i,()=>m(i))}function g(i){i.style.display=""}function a(i){const v=h(i);i.style.display=v}function e(i,v){v?m(i):g(i)}function r(i,v){v?l(i):(clearIntersectionObserver(i),g(i))}function h(i){return C(i),i.defaultDisplay}function C(i){if(i.defaultDisplay)return;const{display:v}=getComputedStyle(i);i.defaultDisplay=v}function F(){return{show:[],hide:[]}}function k(i,v,T){i?v.hide.push(T):v.show.push(T)}function S(i){i.show.forEach(g),i.hide.forEach(m)}function t(i,v,T=.3){v?u(i,T):c(i)}function c(i){i.style.opacity=""}function u(i,v=.3){i.style.opacity=v}function o(i){i.style.order=""}function y(i,v){i.style.order=v}function p(i,v){i.style.background=v}function w(i,v){const T=getFirstElement(v);if(!T)return;const A=createLink();A.href=i,T.parentNode.append(A),A.append(T)}function E(i,v){const T=getFirstElement(v);T&&b(i,T)}function b(i,v){const T=createLink();T.href=i,T.append(...v.childNodes),v.append(T)}function N(){const i=getURLQueryParam("scrollTo");if(!i)return;const v=document.getElementById(i);v?v.scrollIntoView():console.log(`Element with ID "${i}" was not found.`)}function I(i,v="custom-global-style"){let T=document.getElementById(v);T||(T=document.createElement("style"),T.id=v,T.type="text/css",document.head.appendChild(T)),T.textContent=i}function L(i,v){Object.assign(i.style,v)}function P(i){return Object.entries(i).map(([v,T])=>`${v.replace(/([A-Z])/g,"-$1").toLowerCase()}: ${T};`).join(" ")}function O(i){return i?i.split(";").filter(v=>v.trim()!=="").reduce((v,T)=>{const[A,V]=T.split(":").map(G=>G.trim()),D=A.replace(/-([a-z])/g,(G,z)=>z.toUpperCase());return v[D]=V,v},{}):{}}function U(i,v,T="text/plain"){const A=new Blob([i],{type:T}),V=URL.createObjectURL(A),D=document.createElement("a");D.href=V,D.download=v,document.body.appendChild(D),D.click(),document.body.removeChild(D),requestAnimationFrame(()=>URL.revokeObjectURL(V))}},4921:(x,s,n)=>{n.d(s,{sg:()=>l,xk:()=>d});function d(e,r,h=null){const C=e.querySelector(r);return C?Promise.resolve(C):new Promise(F=>{const k=new MutationObserver(t);k.observe(e,{childList:!0,subtree:!0});let S;h&&(S=setTimeout(()=>{k.disconnect(),console.log(`No element found for selector: ${r}`),F(null)},h));function t(){const c=e.querySelector(r);c&&(S&&clearTimeout(S),k.disconnect(),F(c))}})}function m(e,r){return e.querySelector(r)?new Promise(C=>{const F=new MutationObserver(k);F.observe(e,{childList:!0,subtree:!0});function k(){e.querySelector(r)||(F.disconnect(),C())}}):Promise.resolve()}function f(e,r=400){return new Promise(h=>{let C;const F=new MutationObserver(()=>{clearTimeout(C),k()});function k(){C=setTimeout(()=>{F.disconnect(),h()},r)}k(),F.observe(e,{childList:!0,subtree:!0})})}function l(e,r=250){let h;return(...C)=>{clearTimeout(h),h=setTimeout(()=>e(...C),r)}}function g(e,r){const h=new IntersectionObserver(C=>{C.forEach(F=>{F.isIntersecting&&(r(),a(e))})});e.intersectionObserver=h,h.observe(e)}function a(e){e.intersectionObserver&&(e.intersectionObserver.disconnect(),e.intersectionObserver=null)}},3829:(x,s,n)=>{n.d(s,{Ay:()=>m,JE:()=>l});var d=n(8355);function m(e,r){return!f(e,r)}function f(e,r){if(!r.value)return!0;const h=e.toLowerCase(),C=(0,d.R)(r),F=[],k=[];return C.forEach(S=>{if(S.startsWith("!")){const t=S.substring(1);t&&k.push(t)}else F.push(S)}),F.every(S=>h.includes(S))&&k.every(S=>!h.includes(S))}function l(e,r){return r.value!=null&&e<r.value}function g(e,r){return r.value!=null&&e>r.value}function a(e,r){return r.value&&e!==r.value}},4521:(x,s,n)=>{n.d(s,{z:()=>m});var d=n(3048);function m(f,l=null){return{createGlobalFilter(g,a=null,e=f){return d.V.create(g,a,e)},createSectionFilter(g,a=null,e=f){if(!l)throw new Error("sectionId must be provided to use createSectionFilter.");return d.V.createWithCompositeKey(l,g,a,e)}}}},5884:(x,s,n)=>{n.d(s,{Hw:()=>g,Nm:()=>f,nW:()=>l});var d=n(9928),m=n(5467);function f(a,e,r={},h={}){const C=(0,d.kU)(h,e.updateValueFromEvent,e.value);return(0,m.E2)(C,r,a)}function l(a,e,r,h,C,F={},k={}){const S=(0,d.o5)(k,e.updateValueFromEvent,e.value,r,h,C);return(0,m.E2)(S,F,a)}function g(a,e,r={},h={}){const C=(0,d.S)(h,e.updateValueFromEvent,e.value);return(0,m.E2)(C,r,a)}},7877:(x,s,n)=>{n.d(s,{E9:()=>m,HX:()=>f,X0:()=>g,pW:()=>p});var d=n(5884);function m(w,E={},b={}){return(0,d.Nm)("\u041F\u043E\u0438\u0441\u043A: ",w,E,b)}function f(w,E={},b={},N=.1,I=3){return(0,d.nW)("\u041C\u0438\u043D. \u0440\u0435\u0439\u0442\u0438\u043D\u0433: ",w,N,I,5,E,b)}function l(w,E={},b={},N=.1,I=3){return createNumberFilterControl("\u041C\u0430\u043A\u0441. \u0440\u0435\u0439\u0442\u0438\u043D\u0433: ",w,N,I,5,E,b)}function g(w,E={},b={}){return e("\u041C\u0438\u043D. \u043E\u0442\u0437\u044B\u0432\u043E\u0432: ",w,E,b)}function a(w,E={},b={}){return e("\u041C\u0430\u043A\u0441. \u043E\u0442\u0437\u044B\u0432\u043E\u0432: ",w,E,b)}function e(w,E,b={},N={}){return(0,d.nW)(w,E,"1","1","999999",b,N)}function r(w,E={},b={}){return h("\u041C\u0438\u043D. \u0441\u043A\u0438\u0434\u043A\u0430: ",w,E,b)}function h(w,E,b={},N={}){return createNumberFilterControl(w,E,"5","0","100",b,N)}function C(w,E={},b={}){return createNumberFilterControl("\u041C\u0438\u043D. \u043A\u0435\u0448\u0431\u0435\u043A: ",w,"5","0","100",E,b)}function F(w,E,b={},N={},I="250"){return createNumberFilterControl(w,E,I,"0","1000000",b,N)}function k(w,E={},b={},N="25"){return F("\u041C\u0438\u043D. \u0446\u0435\u043D\u0430: ",w,E,b,N)}function S(w,E={},b={},N="25"){return F("\u041C\u0430\u043A\u0441. \u0446\u0435\u043D\u0430: ",w,E,b,N)}function t(w,E={},b={}){return c("\u041C\u0438\u043D. \u043B\u0430\u0438\u0306\u043A\u043E\u0432: ",w,E,b)}function c(w,E,b={},N={}){return createNumberFilterControl(w,E,"1","0","99999",b,N)}function u(w,E={},b={}){return createCheckboxFilterControl("\u0411\u0435\u0437 \u0440\u0435\u0439\u0442\u0438\u043D\u0433\u0430: ",w,E,b)}function o(w,E={},b={}){return createCheckboxFilterControl("\u0421 \u0444\u043E\u0442\u043E: ",w,E,b)}function y(w,E={},b={}){return createCheckboxFilterControl("\u041F\u0440\u043E\u0433\u0440\u0443\u0437\u043A\u0430: ",w,E,b)}function p(w,E={},b={}){return(0,d.Hw)("\u0412\u043A\u043B: ",w,E,b)}},8355:(x,s,n)=>{n.d(s,{R:()=>d});function d(f){return f.value.toLowerCase().split(",").map(l=>l.trim()).filter(l=>l!=="")}function m(f){return d(f).filter(l=>!l.startsWith("!"))}},5213:(x,s,n)=>{n.d(s,{b:()=>f});var d=n(9928),m=n(573);function f(l,g,a=!1,e="customFiltersContainer"){let r=(0,m.Fi)(`#${e}`,l);if(r)if(a)r.remove();else return;r=(0,d.Sw)(),r.id=e,g(r,l)}},8200:(x,s,n)=>{n.d(s,{s:()=>d});function d(m){const{target:f}=m,{type:l}=f;switch(l){case"text":return`"${f.value}"`;case"number":return f.value;case"checkbox":return f.checked;default:return console.log(`Unknown input type: ${l}`),null}}},157:(x,s,n)=>{n.d(s,{Fg:()=>d,vx:()=>f});const d=window.GM_setValue,m=window.GM.setValue,f=window.GM_getValue,l=window.GM_addValueChangeListener},1870:(x,s,n)=>{n.d(s,{j:()=>d});class d{constructor(f,l){this.value=f,this.onChange=l}onChangeIfDefined=()=>{this.onChange&&this.onChange()}}},3048:(x,s,n)=>{n.d(s,{V:()=>g});var d=n(1870),m=n(8200),f=n(3976),l=n(157);class g extends d.j{constructor(e,r=null,h=null){super((0,l.vx)(e,r),h),this.storageKey=e,this.defaultValue=r}static create(e,r=null,h=null){return new g(e,r,h)}static createWithCompositeKey(e,r,h=null,C=null){const F=`${e}-${r}`;return new g(F,h,C)}updateValueFromEvent=e=>{const r=(0,m.s)(e),h=(0,f.$)(r);this.updateValue(h)};updateValue(e,r=!0){this.value!==e&&((0,l.Fg)(this.storageKey,e),this.value=e,r&&this.onChangeIfDefined())}clearValue(e=!1){this.updateValue(null,e)}resetValue(e=!1){this.updateValue(this.defaultValue,e)}}},3976:(x,s,n)=>{n.d(s,{$:()=>d});function d(m){return m===""?null:JSON.parse(m)}},4214:(x,s,n)=>{n.d(s,{zr:()=>m});function d(a){return a.replace(/\D/g,"")}function m(a){return a.replace(/[^\d.,-]/g,"")}function f(a){return a.replace(/\s/g,"")}function l(a){return a.charAt(0).toUpperCase()+a.slice(1)}function g(a){return a.replace(/\s+/g," ").trim()}},5406:(x,s,n)=>{n.d(s,{Fc:()=>d});function d(t,c="common",u=!1){const{pathname:o}=window.location;return m(o,t,c,u)}function m(t,c,u,o=!1){const p=t.split("/")[c]||u;return o&&console.log(`Pathname element: ${p}`),p}function f(t,c="common",u=!1){const o=d(t,"",u);return l(o,c,u)}function l(t,c,u){if(!t)return c;const o=t.split("-").at(-1);return u&&console.log(`Pathname element ending: ${o}`),o}function g(t,c,u="common",o=!1){const y=m(t,c,"",o);return l(y,u,o)}function a(t){return new URLSearchParams(window.location.search).get(t)}function e(t){return t.split("?")[0]}function r(t){return window.location.pathname.includes(t)}function h(t){return t.some(c=>r(c))}function C(t){return window.location.pathname.split("/").some(u=>u===t)}function F(t){try{const c=new URL(window.location.href);Object.entries(t).forEach(([u,o])=>{c.searchParams.set(u,o)}),window.location.href=c.toString()}catch(c){console.error("Failed to redirect:",c)}}function k(t,c){return function(...u){t.apply(this,u),c()}}function S(t,c){return async function(...u){t.apply(this,u),await c()}}},6220:(x,s,n)=>{n.a(x,async(d,m)=>{try{let w=function(N,I){(0,a.ZM)(N,F.r.filtersContainer);const L=(0,r.E9)(c,F.r.control,F.r.textInput),P=(0,r.X0)(u,F.r.control,F.r.numberInput),O=(0,r.HX)(o,F.r.control,F.r.numberInput),U=(0,r.pW)(y,F.r.control,F.r.checkboxInput);N.append(L,P,O,U),I.parentNode.insertBefore(N,I)},E=function(){(0,e.fI)(`${k.Z.PRODUCT_LIST} > div`).forEach(b)},b=function(N){if(!y.value){(0,a.kl)(N);return}const I=(0,e.Fi)(k.Z.PRODUCT_NAME_WRAP,N),L=(0,e.Fi)(k.Z.PRODUCT_RATING_WRAP,N);if(!I||!L){(0,a.Bt)(N);return}const P=I.innerText,O=(0,e.ML)(L.childNodes[2],!0),i=+(0,e.Fi)(k.Z.PRODUCT_RATING,L).getAttribute("value"),v=(0,g.Ay)(P,c)||(0,g.JE)(O,u)||(0,g.JE)(i,o);(0,a.UC)(N,v)};var f=n(4921),l=n(5213),g=n(3829),a=n(5539),e=n(573),r=n(7877),h=n(5406),C=n(4521),F=n(6504),k=n(4858);const S=(0,h.Fc)(2),{createSectionFilter:t}=(0,C.z)(E,S),c=t("name-filter"),u=t("min-reviews-filter"),o=t("min-rating-filter",4.8),y=t("filter-enabled",!0);await p();async function p(){if(!await(0,f.xk)(document,k.Z.PRODUCT_LIST_TOP))return;const I=(0,e.Fi)(k.Z.PRODUCT_LIST,document,!0);(0,l.b)(I,w,!0),new MutationObserver(E).observe(I,{childList:!0,subtree:!0})}m()}catch(S){m(S)}},1)},4858:(x,s,n)=>{n.d(s,{Z:()=>d});const d={PRODUCT_LIST:'[data-qa="listing"]',PRODUCT_LIST_TOP:"#product-listing-top",PRODUCT_NAME_WRAP:'[data-qa="product-name"]',PRODUCT_RATING_WRAP:'[data-qa="product-rating"]',PRODUCT_RATING:'[name="rating"]'}},6504:(x,s,n)=>{n.d(s,{r:()=>m});const d={input:{marginLeft:"5px",border:"1px solid #dadcde",borderRadius:"8px",padding:"8px 16px",fontSize:"16px"}},m={filtersContainer:{display:"flex",gridGap:"11px",marginBottom:"18px"},control:{display:"flex",alignItems:"center",fontSize:"16px"},textInput:{...d.input,width:"180px"},numberInput:{...d.input,width:"90px"},checkboxInput:{marginLeft:"5px",width:"22px",height:"22px"}}}},$={};function R(x){var s=$[x];if(s!==void 0)return s.exports;var n=$[x]={exports:{}};return j[x](n,n.exports,R),n.exports}(()=>{var x=typeof Symbol=="function"?Symbol("webpack queues"):"__webpack_queues__",s=typeof Symbol=="function"?Symbol("webpack exports"):"__webpack_exports__",n=typeof Symbol=="function"?Symbol("webpack error"):"__webpack_error__",d=f=>{f&&f.d<1&&(f.d=1,f.forEach(l=>l.r--),f.forEach(l=>l.r--?l.r++:l()))},m=f=>f.map(l=>{if(l!==null&&typeof l=="object"){if(l[x])return l;if(l.then){var g=[];g.d=0,l.then(r=>{a[s]=r,d(g)},r=>{a[n]=r,d(g)});var a={};return a[x]=r=>r(g),a}}var e={};return e[x]=r=>{},e[s]=l,e});R.a=(f,l,g)=>{var a;g&&((a=[]).d=-1);var e=new Set,r=f.exports,h,C,F,k=new Promise((S,t)=>{F=t,C=S});k[s]=r,k[x]=S=>(a&&S(a),e.forEach(S),k.catch(t=>{})),f.exports=k,l(S=>{h=m(S);var t,c=()=>h.map(o=>{if(o[n])throw o[n];return o[s]}),u=new Promise(o=>{t=()=>o(c),t.r=0;var y=p=>p!==a&&!e.has(p)&&(e.add(p),p&&!p.d&&(t.r++,p.push(t)));h.map(p=>p[x](y))});return t.r?u:c()},S=>(S?F(k[n]=S):C(r),d(a))),a&&a.d<0&&(a.d=0)}})(),R.d=(x,s)=>{for(var n in s)R.o(s,n)&&!R.o(x,n)&&Object.defineProperty(x,n,{enumerable:!0,get:s[n]})},R.o=(x,s)=>Object.prototype.hasOwnProperty.call(x,s);var W=R(6220)})();})();
