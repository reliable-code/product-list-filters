// ==UserScript==
// @name         Vseins product cards filter
// @description  Hide product cards by filter
// @grant        GM_addValueChangeListener
// @grant        GM_setValue
// @grant        GM_getValue
// @match        https://www.vseinstrumenti.ru/tag-page/*
// @match        https://www.vseinstrumenti.ru/category/*
// @namespace    https://github.com/reliable-code/product-list-filters
// @version      1.0.73697271
// @icon         https://www.google.com/s2/favicons?sz=64&domain=vseinstrumenti.ru
// @author       reliable-code
// ==/UserScript==

(()=>{(()=>{"use strict";var O={9928:(C,d,n)=>{n.d(d,{S:()=>f,Sw:()=>F,kU:()=>p,o5:()=>l});var s=n(4921),h=n(5539);function p(o,e,t){const i=c(o,"text",e);return i.value=t,i}function l(o,e,t,i,x,S){const I=c(o,"number",e);return I.value=t,I.step=i,I.min=x,I.max=S,I}function f(o,e,t){const i=c(o,"checkbox",e);return i.checked=t,i}function c(o={},e=null,t=null){const i=g("input",o);return e&&(i.type=e),t&&(i.addEventListener("keyup",(0,s.sg)(t,200)),i.addEventListener("change",(0,s.sg)(t,100))),i}function r(o={},e=null){return g("span",o,e)}function a(o={},e=null,t=null){const i=g("a",o,e);return t&&(i.href=t),i}function v(o={},e=null,t=null){const i=g("button",o,e);return t&&(i.onclick=t),i}function F(o={},e=null){return g("div",o,e)}function g(o,e,t=null){if(typeof e!="object"||e===null)throw new TypeError("styles should be an object");const i=document.createElement(o);return(0,h.ZM)(i,e),t&&(i.innerHTML=t),i}},573:(C,d,n)=>{n.d(d,{Fi:()=>p,ML:()=>v,fI:()=>l});var s=n(4214);function h(e,t=document){return!!t.querySelector(e)}function p(e,t=document,i=!1){const x=t.querySelector(e);return i&&!x&&console.log(`No element found for selector: ${e}`),x}function l(e,t=document,i=!1){const x=t.querySelectorAll(e);return i&&!x.length&&console.log(`No elements found for selector: ${e}`),x}function f(e,t,i){return[...e.querySelectorAll(t)].find(x=>x.textContent.trim().includes(i))}function c(e,t,i=!1,x=!1){const S=p(t,e,!0);return r(S,i,x)}function r(e,t=!1,i=!1,x=null){if(!e)return x===null?(console.log("No element found"),null):x;const S=e.innerText;return F(S,t,i)}function a(e,t,i=!1){const x=e[t];return r(x,i)}function v(e,t=!1,i=!1){const x=e.textContent;return F(x,t,i)}function F(e,t,i){return t&&(e=(0,s.zr)(e)),i&&(e=e.replace(",",".")),+e}function g(e){return[...e.childNodes].find(t=>t.nodeType===Node.TEXT_NODE)}function o(e){const t=i=>i.nodeType===Node.TEXT_NODE&&i.textContent.trim()!==""?[i]:[...i.childNodes].flatMap(t);return t(e)}},5539:(C,d,n)=>{n.d(d,{Bt:()=>h,UC:()=>r,ZM:()=>E,kl:()=>f});function s(u,b){u.parentNode.insertBefore(b,u.nextSibling)}function h(u){u.style.display="none"}function p(u){F(u),h(u)}function l(u){u.intersectionObserver||runOnceOnIntersection(u,()=>h(u))}function f(u){u.style.display=""}function c(u){const b=v(u);u.style.display=b}function r(u,b){b?h(u):f(u)}function a(u,b){b?l(u):(clearIntersectionObserver(u),f(u))}function v(u){return F(u),u.defaultDisplay}function F(u){if(u.defaultDisplay)return;const{display:b}=getComputedStyle(u);u.defaultDisplay=b}function g(){return{show:[],hide:[]}}function o(u,b,N){u?b.hide.push(N):b.show.push(N)}function e(u){u.show.forEach(f),u.hide.forEach(h)}function t(u,b,N=.3){b?x(u,N):i(u)}function i(u){u.style.opacity=""}function x(u,b=.3){u.style.opacity=b}function S(u){u.style.order=""}function I(u,b){u.style.order=b}function m(u,b){u.style.background=b}function w(){const u=getURLQueryParam("scrollTo");if(!u)return;const b=document.getElementById(u);b?b.scrollIntoView():console.log(`Element with ID "${u}" was not found.`)}function y(u,b="custom-global-style"){let N=document.getElementById(b);N||(N=document.createElement("style"),N.id=b,N.type="text/css",document.head.appendChild(N)),N.textContent=u}function E(u,b){Object.assign(u.style,b)}function T(u){return Object.entries(u).map(([b,N])=>`${b.replace(/([A-Z])/g,"-$1").toLowerCase()}: ${N};`).join(" ")}function k(u){return u?u.split(";").filter(b=>b.trim()!=="").reduce((b,N)=>{const[D,L]=N.split(":").map(V=>V.trim()),P=D.replace(/-([a-z])/g,(V,$)=>$.toUpperCase());return b[P]=L,b},{}):{}}},4921:(C,d,n)=>{n.d(d,{sg:()=>p,xk:()=>s});async function s(c,r,a=null){const v=c.querySelector(r);return v?Promise.resolve(v):new Promise(F=>{const g=new MutationObserver(e);g.observe(c,{childList:!0,subtree:!0});let o=null;a&&(o=setTimeout(()=>{g.disconnect(),console.log(`No element found for selector: ${r}`),F(null)},a));function e(){const t=c.querySelector(r);t&&(o&&clearTimeout(o),g.disconnect(),F(t))}})}async function h(c,r){return c.querySelector(r)?new Promise(v=>{const F=new MutationObserver(g);F.observe(c,{childList:!0,subtree:!0});function g(){c.querySelector(r)||(F.disconnect(),v())}}):Promise.resolve()}function p(c,r=250){let a;return(...v)=>{clearTimeout(a),a=setTimeout(()=>c(...v),r)}}function l(c,r){const a=new IntersectionObserver(v=>{v.forEach(F=>{F.isIntersecting&&(r(),f(c))})});c.intersectionObserver=a,a.observe(c)}function f(c){c.intersectionObserver&&(c.intersectionObserver.disconnect(),c.intersectionObserver=null)}},3829:(C,d,n)=>{n.d(d,{Ay:()=>h,JE:()=>l});var s=n(8355);function h(r,a){return!p(r,a)}function p(r,a){if(!a.value)return!0;const v=r.toLowerCase(),F=(0,s.R)(a),g=[],o=[];return F.forEach(e=>{if(e.startsWith("!")){const t=e.substring(1);t&&o.push(t)}else g.push(e)}),g.every(e=>v.includes(e))&&o.every(e=>!v.includes(e))}function l(r,a){return a.value!=null&&r<a.value}function f(r,a){return a.value!=null&&r>a.value}function c(r,a){return a.value&&r!==a.value}},4521:(C,d,n)=>{n.d(d,{z:()=>h});var s=n(3048);function h(p,l=null){return{createGlobalFilter(f,c=null,r=p){return s.V.create(f,c,r)},createSectionFilter(f,c=null,r=p){if(!l)throw new Error("sectionId must be provided to use createSectionFilter.");return s.V.createWithCompositeKey(l,f,c,r)}}}},5884:(C,d,n)=>{n.d(d,{Hw:()=>l,Nm:()=>h,nW:()=>p});var s=n(9928);function h(f,c,r={},a={}){const v=(0,s.Sw)(r,f),F=(0,s.kU)(a,c.updateValueFromEvent,c.value);return v.append(F),v}function p(f,c,r,a,v,F={},g={}){const o=(0,s.Sw)(F,f),e=(0,s.o5)(g,c.updateValueFromEvent,c.value,r,a,v);return o.append(e),o}function l(f,c,r={},a={}){const v=(0,s.Sw)(r,f),F=(0,s.S)(a,c.updateValueFromEvent,c.value);return v.append(F),v}},7877:(C,d,n)=>{n.d(d,{E9:()=>h,HX:()=>p,X0:()=>f,pW:()=>I});var s=n(5884);function h(m,w={},y={}){return(0,s.Nm)("\u041F\u043E\u0438\u0441\u043A: ",m,w,y)}function p(m,w={},y={},E=.1,T=3){return(0,s.nW)("\u041C\u0438\u043D. \u0440\u0435\u0439\u0442\u0438\u043D\u0433: ",m,E,T,5,w,y)}function l(m,w={},y={},E=.1,T=3){return createNumberFilterControl("\u041C\u0430\u043A\u0441. \u0440\u0435\u0439\u0442\u0438\u043D\u0433: ",m,E,T,5,w,y)}function f(m,w={},y={}){return r("\u041C\u0438\u043D. \u043E\u0442\u0437\u044B\u0432\u043E\u0432: ",m,w,y)}function c(m,w={},y={}){return r("\u041C\u0430\u043A\u0441. \u043E\u0442\u0437\u044B\u0432\u043E\u0432: ",m,w,y)}function r(m,w,y={},E={}){return(0,s.nW)(m,w,"1","1","999999",y,E)}function a(m,w={},y={}){return v("\u041C\u0438\u043D. \u0441\u043A\u0438\u0434\u043A\u0430: ",m,w,y)}function v(m,w,y={},E={}){return createNumberFilterControl(m,w,"5","0","100",y,E)}function F(m,w={},y={}){return createNumberFilterControl("\u041C\u0438\u043D. \u043A\u0435\u0448\u0431\u0435\u043A: ",m,"5","0","100",w,y)}function g(m,w,y={},E={},T="250"){return createNumberFilterControl(m,w,T,"0","1000000",y,E)}function o(m,w={},y={},E="25"){return g("\u041C\u0438\u043D. \u0446\u0435\u043D\u0430: ",m,w,y,E)}function e(m,w={},y={},E="25"){return g("\u041C\u0430\u043A\u0441. \u0446\u0435\u043D\u0430: ",m,w,y,E)}function t(m,w,y={},E={}){return createNumberFilterControl(m,w,"1","0","99999",y,E)}function i(m,w={},y={}){return createCheckboxFilterControl("\u0411\u0435\u0437 \u0440\u0435\u0439\u0442\u0438\u043D\u0433\u0430: ",m,w,y)}function x(m,w={},y={}){return createCheckboxFilterControl("\u0421 \u0444\u043E\u0442\u043E: ",m,w,y)}function S(m,w={},y={}){return createCheckboxFilterControl("\u041F\u0440\u043E\u0433\u0440\u0443\u0437\u043A\u0430: ",m,w,y)}function I(m,w={},y={}){return(0,s.Hw)("\u0412\u043A\u043B: ",m,w,y)}},8355:(C,d,n)=>{n.d(d,{R:()=>s});function s(p){return p.value.toLowerCase().split(",").map(l=>l.trim()).filter(l=>l!=="")}function h(p){return s(p).filter(l=>!l.startsWith("!"))}},5213:(C,d,n)=>{n.d(d,{b:()=>p});var s=n(9928),h=n(573);function p(l,f,c=!1,r="customFiltersContainer"){let a=(0,h.Fi)(`#${r}`,l);if(a)if(c)a.remove();else return;a=(0,s.Sw)(),a.id=r,f(a,l)}},8200:(C,d,n)=>{n.d(d,{s:()=>s});function s(h){const{target:p}=h,{type:l}=p;switch(l){case"text":return`"${p.value}"`;case"number":return p.value;case"checkbox":return p.checked;default:return console.log(`Unknown input type: ${l}`),null}}},157:(C,d,n)=>{n.d(d,{Fg:()=>s,vx:()=>p});const s=window.GM_setValue,h=window.GM.setValue,p=window.GM_getValue,l=window.GM_addValueChangeListener},1870:(C,d,n)=>{n.d(d,{j:()=>s});class s{constructor(p,l){this.value=p,this.onChange=l}onChangeIfDefined=()=>{this.onChange&&this.onChange()}}},3048:(C,d,n)=>{n.d(d,{V:()=>f});var s=n(1870),h=n(8200),p=n(3976),l=n(157);class f extends s.j{constructor(r,a=null,v=null){super((0,l.vx)(r,a),v),this.storageKey=r,this.defaultValue=a}static create(r,a=null,v=null){return new f(r,a,v)}static createWithCompositeKey(r,a,v=null,F=null){const g=`${r}-${a}`;return new f(g,v,F)}updateValueFromEvent=r=>{const a=(0,h.s)(r),v=(0,p.$)(a);this.updateValue(v)};updateValue(r){this.value!==r&&((0,l.Fg)(this.storageKey,r),this.value=r,this.onChangeIfDefined())}clearValue(){this.updateValue(null)}resetValue(){this.updateValue(this.defaultValue)}}},3976:(C,d,n)=>{n.d(d,{$:()=>s});function s(h){return h===""?null:JSON.parse(h)}},4214:(C,d,n)=>{n.d(d,{zr:()=>h});function s(f){return f.replace(/\D/g,"")}function h(f){return f.replace(/[^\d.,-]/g,"")}function p(f){return f.replace(/\s/g,"")}function l(f){return f.charAt(0).toUpperCase()+f.slice(1)}},5406:(C,d,n)=>{n.d(d,{Fc:()=>s});function s(o,e="common",t=!1){const{pathname:i}=window.location;return h(i,o,e,t)}function h(o,e,t,i=!1){const S=o.split("/")[e]||t;return i&&console.log(`Pathname element: ${S}`),S}function p(o,e="common",t=!1){const i=s(o,"",t);return l(i,e,t)}function l(o,e,t){if(!o)return e;const i=o.split("-").at(-1);return t&&console.log(`Pathname element ending: ${i}`),i}function f(o,e,t="common",i=!1){const x=h(o,e,"",i);return l(x,t,i)}function c(o){return new URLSearchParams(window.location.search).get(o)}function r(o){return o.split("?")[0]}function a(o){return window.location.pathname.includes(o)}function v(o){return o.some(e=>a(e))}function F(o){return window.location.pathname.split("/").some(t=>t===o)}function g(o){try{const e=new URL(window.location.href);Object.entries(o).forEach(([t,i])=>{e.searchParams.set(t,i)}),window.location.href=e.toString()}catch(e){console.error("Failed to redirect:",e)}}},6220:(C,d,n)=>{n.a(C,async(s,h)=>{try{let w=function(T,k){(0,c.ZM)(T,g.r.filtersContainer);const u=(0,a.E9)(i,g.r.control,g.r.textInput),b=(0,a.X0)(x,g.r.control,g.r.numberInput),N=(0,a.HX)(S,g.r.control,g.r.numberInput),D=(0,a.pW)(I,g.r.control,g.r.checkboxInput);T.append(u,b,N,D),k.parentNode.insertBefore(T,k)},y=function(){(0,r.fI)(`${o.Z.PRODUCT_LIST} > div`).forEach(E)},E=function(T){if(!I.value){(0,c.kl)(T);return}const k=(0,r.Fi)(o.Z.PRODUCT_NAME_WRAP,T),u=(0,r.Fi)(o.Z.PRODUCT_RATING_WRAP,T);if(!k||!u){(0,c.Bt)(T);return}const b=k.innerText,N=(0,r.ML)(u.childNodes[2],!0),L=+(0,r.Fi)(o.Z.PRODUCT_RATING,u).getAttribute("value"),P=(0,f.Ay)(b,i)||(0,f.JE)(N,x)||(0,f.JE)(L,S);(0,c.UC)(T,P)};var p=n(4921),l=n(5213),f=n(3829),c=n(5539),r=n(573),a=n(7877),v=n(5406),F=n(4521),g=n(6504),o=n(4858);const e=(0,v.Fc)(2),{createSectionFilter:t}=(0,F.z)(y,e),i=t("name-filter"),x=t("min-reviews-filter"),S=t("min-rating-filter",4.8),I=t("filter-enabled",!0);await m();async function m(){if(!await(0,p.xk)(document,o.Z.PRODUCT_LIST_TOP))return;const k=(0,r.Fi)(o.Z.PRODUCT_LIST,document,!0);(0,l.b)(k,w,!0),new MutationObserver(y).observe(k,{childList:!0,subtree:!0})}h()}catch(e){h(e)}},1)},4858:(C,d,n)=>{n.d(d,{Z:()=>s});const s={PRODUCT_LIST:'[data-qa="listing"]',PRODUCT_LIST_TOP:"#product-listing-top",PRODUCT_NAME_WRAP:'[data-qa="product-name"]',PRODUCT_RATING_WRAP:'[data-qa="product-rating"]',PRODUCT_RATING:'[name="rating"]'}},6504:(C,d,n)=>{n.d(d,{r:()=>h});const s={input:{marginLeft:"5px",border:"1px solid #dadcde",borderRadius:"8px",padding:"8px 16px",fontSize:"16px"}},h={filtersContainer:{display:"flex",gridGap:"11px",marginBottom:"18px"},control:{display:"flex",alignItems:"center",fontSize:"16px"},textInput:{...s.input,width:"180px"},numberInput:{...s.input,width:"90px"},checkboxInput:{marginLeft:"5px",width:"22px",height:"22px"}}}},A={};function R(C){var d=A[C];if(d!==void 0)return d.exports;var n=A[C]={exports:{}};return O[C](n,n.exports,R),n.exports}(()=>{var C=typeof Symbol=="function"?Symbol("webpack queues"):"__webpack_queues__",d=typeof Symbol=="function"?Symbol("webpack exports"):"__webpack_exports__",n=typeof Symbol=="function"?Symbol("webpack error"):"__webpack_error__",s=p=>{p&&p.d<1&&(p.d=1,p.forEach(l=>l.r--),p.forEach(l=>l.r--?l.r++:l()))},h=p=>p.map(l=>{if(l!==null&&typeof l=="object"){if(l[C])return l;if(l.then){var f=[];f.d=0,l.then(a=>{c[d]=a,s(f)},a=>{c[n]=a,s(f)});var c={};return c[C]=a=>a(f),c}}var r={};return r[C]=a=>{},r[d]=l,r});R.a=(p,l,f)=>{var c;f&&((c=[]).d=-1);var r=new Set,a=p.exports,v,F,g,o=new Promise((e,t)=>{g=t,F=e});o[d]=a,o[C]=e=>(c&&e(c),r.forEach(e),o.catch(t=>{})),p.exports=o,l(e=>{v=h(e);var t,i=()=>v.map(S=>{if(S[n])throw S[n];return S[d]}),x=new Promise(S=>{t=()=>S(i),t.r=0;var I=m=>m!==c&&!r.has(m)&&(r.add(m),m&&!m.d&&(t.r++,m.push(t)));v.map(m=>m[C](I))});return t.r?x:i()},e=>(e?g(o[n]=e):F(a),s(c))),c&&c.d<0&&(c.d=0)}})(),R.d=(C,d)=>{for(var n in d)R.o(d,n)&&!R.o(C,n)&&Object.defineProperty(C,n,{enumerable:!0,get:d[n]})},R.o=(C,d)=>Object.prototype.hasOwnProperty.call(C,d);var G=R(6220)})();})();
