// ==UserScript==
// @name         Vseins product cards filter
// @description  Hide product cards by filter
// @grant        GM_addValueChangeListener
// @grant        GM_setValue
// @grant        GM_getValue
// @match        https://www.vseinstrumenti.ru/tag-page/*
// @match        https://www.vseinstrumenti.ru/category/*
// @namespace    https://github.com/reliable-code/product-list-filters
// @version      0.1.73688152
// @icon         https://www.google.com/s2/favicons?sz=64&domain=vseinstrumenti.ru
// @author       reliable-code
// ==/UserScript==

(()=>{(()=>{"use strict";var O={9928:(C,s,n)=>{n.d(s,{S:()=>d,Sw:()=>x,kU:()=>f,o5:()=>c});var l=n(4921),g=n(5539);function f(h,t,e){const r=a(h,"text",t);return r.value=e,r}function c(h,t,e,r,v,F){const p=a(h,"number",t);return p.value=e,p.step=r,p.min=v,p.max=F,p}function d(h,t,e){const r=a(h,"checkbox",t);return r.checked=e,r}function a(h={},t=null,e=null){const r=w("input",h);return t&&(r.type=t),e&&(r.addEventListener("keyup",(0,l.sg)(e,200)),r.addEventListener("change",(0,l.sg)(e,100))),r}function u(h={},t=null){return w("span",h,t)}function i(h={},t=null,e=null){const r=w("a",h,t);return e&&(r.href=e),r}function b(h={},t=null,e=null){const r=w("button",h,t);return e&&(r.onclick=e),r}function x(h={},t=null){return w("div",h,t)}function w(h,t,e=null){if(typeof t!="object"||t===null)throw new TypeError("styles should be an object");const r=document.createElement(h);return(0,g.ZM)(r,t),e&&(r.innerHTML=e),r}},573:(C,s,n)=>{n.d(s,{Fi:()=>f,ML:()=>b,fI:()=>c});var l=n(4214);function g(t,e=document){return!!e.querySelector(t)}function f(t,e=document,r=!1){const v=e.querySelector(t);return r&&!v&&console.log(`No element found for selector: ${t}`),v}function c(t,e=document,r=!1){const v=e.querySelectorAll(t);return r&&!v.length&&console.log(`No elements found for selector: ${t}`),v}function d(t,e,r){return[...t.querySelectorAll(e)].find(v=>v.textContent.trim().includes(r))}function a(t,e,r=!1,v=!1){const F=f(e,t,!0);return u(F,r,v)}function u(t,e=!1,r=!1,v=null){if(!t)return v===null?(console.log("No element found"),null):v;const F=t.innerText;return x(F,e,r)}function i(t,e,r=!1){const v=t[e];return u(v,r)}function b(t,e=!1,r=!1){const v=t.textContent;return x(v,e,r)}function x(t,e,r){return e&&(t=(0,l.zr)(t)),r&&(t=t.replace(",",".")),+t}function w(t){return[...t.childNodes].find(e=>e.nodeType===Node.TEXT_NODE)}function h(t){const e=r=>r.nodeType===Node.TEXT_NODE&&r.textContent.trim()!==""?[r]:[...r.childNodes].flatMap(e);return e(t)}},5539:(C,s,n)=>{n.d(s,{Bt:()=>g,UC:()=>u,ZM:()=>I,kl:()=>d});function l(o,y){o.parentNode.insertBefore(y,o.nextSibling)}function g(o){o.style.display="none"}function f(o){x(o),g(o)}function c(o){o.intersectionObserver||runOnceOnIntersection(o,()=>g(o))}function d(o){o.style.display=""}function a(o){const y=b(o);o.style.display=y}function u(o,y){y?g(o):d(o)}function i(o,y){y?c(o):(clearIntersectionObserver(o),d(o))}function b(o){return x(o),o.defaultDisplay}function x(o){if(o.defaultDisplay)return;const{display:y}=getComputedStyle(o);o.defaultDisplay=y}function w(){return{show:[],hide:[]}}function h(o,y,N){o?y.hide.push(N):y.show.push(N)}function t(o){o.show.forEach(d),o.hide.forEach(g)}function e(o,y,N=.3){y?v(o,N):r(o)}function r(o){o.style.opacity=""}function v(o,y=.3){o.style.opacity=y}function F(o){o.style.order=""}function p(o,y){o.style.order=y}function m(o,y){o.style.background=y}function S(){const o=getQueryParam("scrollTo");if(!o)return;const y=document.getElementById(o);y?y.scrollIntoView():console.log(`Element with ID "${o}" was not found.`)}function E(o,y="custom-global-style"){let N=document.getElementById(y);N||(N=document.createElement("style"),N.id=y,N.type="text/css",document.head.appendChild(N)),N.textContent=o}function I(o,y){Object.assign(o.style,y)}function T(o){return Object.entries(o).map(([y,N])=>`${y.replace(/([A-Z])/g,"-$1").toLowerCase()}: ${N};`).join(" ")}function k(o){return o?o.split(";").filter(y=>y.trim()!=="").reduce((y,N)=>{const[P,D]=N.split(":").map(A=>A.trim()),L=P.replace(/-([a-z])/g,(A,$)=>$.toUpperCase());return y[L]=D,y},{}):{}}},4921:(C,s,n)=>{n.d(s,{sg:()=>f,xk:()=>l});async function l(a,u,i=null){const b=a.querySelector(u);return b?Promise.resolve(b):new Promise(x=>{const w=new MutationObserver(t);w.observe(a,{childList:!0,subtree:!0});let h=null;i&&(h=setTimeout(()=>{w.disconnect(),console.log(`No element found for selector: ${u}`),x(null)},i));function t(){const e=a.querySelector(u);e&&(h&&clearTimeout(h),w.disconnect(),x(e))}})}async function g(a,u){return a.querySelector(u)?new Promise(b=>{const x=new MutationObserver(w);x.observe(a,{childList:!0,subtree:!0});function w(){a.querySelector(u)||(x.disconnect(),b())}}):Promise.resolve()}function f(a,u=250){let i;return(...b)=>{clearTimeout(i),i=setTimeout(()=>a(...b),u)}}function c(a,u){const i=new IntersectionObserver(b=>{b.forEach(x=>{x.isIntersecting&&(u(),d(a))})});a.intersectionObserver=i,i.observe(a)}function d(a){a.intersectionObserver&&(a.intersectionObserver.disconnect(),a.intersectionObserver=null)}},3829:(C,s,n)=>{n.d(s,{Ay:()=>g,JE:()=>c});var l=n(8355);function g(u,i){return!f(u,i)}function f(u,i){if(!i.value)return!0;const b=u.toLowerCase(),x=(0,l.R)(i),w=[],h=[];return x.forEach(t=>{if(t.startsWith("!")){const e=t.substring(1);e&&h.push(e)}else w.push(t)}),w.every(t=>b.includes(t))&&h.every(t=>!b.includes(t))}function c(u,i){return i.value!=null&&u<i.value}function d(u,i){return i.value!=null&&u>i.value}function a(u,i){return i.value&&u!==i.value}},4521:(C,s,n)=>{n.d(s,{z:()=>g});var l=n(3048);function g(f,c=null){return{createGlobalFilter(d,a=null,u=f){return l.V.create(d,a,u)},createSectionFilter(d,a=null,u=f){if(!c)throw new Error("sectionId must be provided to use createSectionFilter.");return l.V.createWithCompositeKey(c,d,a,u)}}}},5884:(C,s,n)=>{n.d(s,{Hw:()=>c,Nm:()=>g,nW:()=>f});var l=n(9928);function g(d,a,u={},i={}){const b=(0,l.Sw)(u,d),x=(0,l.kU)(i,a.updateValueFromEvent,a.value);return b.append(x),b}function f(d,a,u,i,b,x={},w={}){const h=(0,l.Sw)(x,d),t=(0,l.o5)(w,a.updateValueFromEvent,a.value,u,i,b);return h.append(t),h}function c(d,a,u={},i={}){const b=(0,l.Sw)(u,d),x=(0,l.S)(i,a.updateValueFromEvent,a.value);return b.append(x),b}},7877:(C,s,n)=>{n.d(s,{E9:()=>g,HX:()=>f,X0:()=>d,pW:()=>F});var l=n(5884);function g(p,m={},S={}){return(0,l.Nm)("\u041F\u043E\u0438\u0441\u043A: ",p,m,S)}function f(p,m={},S={},E=.1,I=3){return(0,l.nW)("\u041C\u0438\u043D. \u0440\u0435\u0439\u0442\u0438\u043D\u0433: ",p,E,I,5,m,S)}function c(p,m={},S={},E=.1,I=3){return createNumberFilterControl("\u041C\u0430\u043A\u0441. \u0440\u0435\u0439\u0442\u0438\u043D\u0433: ",p,E,I,5,m,S)}function d(p,m={},S={}){return u("\u041C\u0438\u043D. \u043E\u0442\u0437\u044B\u0432\u043E\u0432: ",p,m,S)}function a(p,m={},S={}){return u("\u041C\u0430\u043A\u0441. \u043E\u0442\u0437\u044B\u0432\u043E\u0432: ",p,m,S)}function u(p,m,S={},E={}){return(0,l.nW)(p,m,"1","1","999999",S,E)}function i(p,m={},S={}){return b("\u041C\u0438\u043D. \u0441\u043A\u0438\u0434\u043A\u0430: ",p,m,S)}function b(p,m,S={},E={}){return createNumberFilterControl(p,m,"5","0","100",S,E)}function x(p,m={},S={}){return createNumberFilterControl("\u041C\u0438\u043D. \u043A\u0435\u0448\u0431\u0435\u043A: ",p,"5","0","100",m,S)}function w(p,m,S={},E={},I="250"){return createNumberFilterControl(p,m,I,"0","1000000",S,E)}function h(p,m={},S={},E="25"){return w("\u041C\u0438\u043D. \u0446\u0435\u043D\u0430: ",p,m,S,E)}function t(p,m={},S={},E="25"){return w("\u041C\u0430\u043A\u0441. \u0446\u0435\u043D\u0430: ",p,m,S,E)}function e(p,m,S={},E={}){return createNumberFilterControl(p,m,"1","0","99999",S,E)}function r(p,m={},S={}){return createCheckboxFilterControl("\u0411\u0435\u0437 \u0440\u0435\u0439\u0442\u0438\u043D\u0433\u0430: ",p,m,S)}function v(p,m={},S={}){return createCheckboxFilterControl("\u0421 \u0444\u043E\u0442\u043E: ",p,m,S)}function F(p,m={},S={}){return(0,l.Hw)("\u0412\u043A\u043B: ",p,m,S)}},8355:(C,s,n)=>{n.d(s,{R:()=>l});function l(f){return f.value.toLowerCase().split(",").map(c=>c.trim()).filter(c=>c!=="")}function g(f){return l(f).filter(c=>!c.startsWith("!"))}},5213:(C,s,n)=>{n.d(s,{b:()=>f});var l=n(9928),g=n(573);function f(c,d,a=!1,u="customFiltersContainer"){let i=(0,g.Fi)(`#${u}`,c);if(i)if(a)i.remove();else return;i=(0,l.Sw)(),i.id=u,d(i,c)}},8200:(C,s,n)=>{n.d(s,{s:()=>l});function l(g){const{target:f}=g,{type:c}=f;switch(c){case"text":return`"${f.value}"`;case"number":return f.value;case"checkbox":return f.checked;default:return console.log(`Unknown input type: ${c}`),null}}},157:(C,s,n)=>{n.d(s,{Fg:()=>l,vx:()=>f});const l=window.GM_setValue,g=window.GM.setValue,f=window.GM_getValue,c=window.GM_addValueChangeListener},1870:(C,s,n)=>{n.d(s,{j:()=>l});class l{constructor(f,c){this.value=f,this.onChange=c}onChangeIfDefined=()=>{this.onChange&&this.onChange()}}},3048:(C,s,n)=>{n.d(s,{V:()=>d});var l=n(1870),g=n(8200),f=n(3976),c=n(157);class d extends l.j{constructor(u,i=null,b=null){super((0,c.vx)(u,i),b),this.storageKey=u,this.defaultValue=i}static create(u,i=null,b=null){return new d(u,i,b)}static createWithCompositeKey(u,i,b=null,x=null){const w=`${u}-${i}`;return new d(w,b,x)}updateValueFromEvent=u=>{const i=(0,g.s)(u),b=(0,f.$)(i);this.updateValue(b)};updateValue(u){this.value!==u&&((0,c.Fg)(this.storageKey,u),this.value=u,this.onChangeIfDefined())}clearValue(){this.updateValue(null)}resetValue(){this.updateValue(this.defaultValue)}}},3976:(C,s,n)=>{n.d(s,{$:()=>l});function l(g){return g===""?null:JSON.parse(g)}},4214:(C,s,n)=>{n.d(s,{zr:()=>g});function l(d){return d.replace(/\D/g,"")}function g(d){return d.replace(/[^\d.,-]/g,"")}function f(d){return d.replace(/\s/g,"")}function c(d){return d.charAt(0).toUpperCase()+d.slice(1)}},5406:(C,s,n)=>{n.d(s,{Fc:()=>l});function l(e,r="common",v=!1){const{pathname:F}=window.location;return g(F,e,r,v)}function g(e,r,v,F=!1){const m=e.split("/")[r]||v;return F&&console.log(`Pathname element: ${m}`),m}function f(e,r="common",v=!1){const F=l(e,"",v);return c(F,r,v)}function c(e,r,v){if(!e)return r;const F=e.split("-").at(-1);return v&&console.log(`Pathname element ending: ${F}`),F}function d(e,r,v="common",F=!1){const p=g(e,r,"",F);return c(p,v,F)}function a(e){const r=window.location.search;return u(r,e)}function u(e,r){return new URLSearchParams(e).get(r)}function i(e){return window.location.pathname.includes(e)}function b(e){return e.some(r=>i(r))}function x(e){return window.location.pathname.split("/").some(v=>v===e)}function w(e){return new URLSearchParams(window.location.search).get(e)}function h(e){return e.split("?")[0]}function t(e){try{const r=new URL(window.location.href);Object.entries(e).forEach(([v,F])=>{r.searchParams.set(v,F)}),window.location.href=r.toString()}catch(r){console.error("Failed to redirect:",r)}}},6220:(C,s,n)=>{n.a(C,async(l,g)=>{try{let S=function(T,k){(0,a.ZM)(T,w.r.filtersContainer);const o=(0,i.E9)(r,w.r.control,w.r.textInput),y=(0,i.X0)(v,w.r.control,w.r.numberInput),N=(0,i.HX)(F,w.r.control,w.r.numberInput),P=(0,i.pW)(p,w.r.control,w.r.checkboxInput);T.append(o,y,N,P),k.parentNode.insertBefore(T,k)},E=function(){(0,u.fI)(`${h.Z.PRODUCT_LIST} > div`).forEach(I)},I=function(T){if(!p.value){(0,a.kl)(T);return}const k=(0,u.Fi)(h.Z.PRODUCT_NAME_WRAP,T),o=(0,u.Fi)(h.Z.PRODUCT_RATING_WRAP,T);if(!k||!o){(0,a.Bt)(T);return}const y=k.innerText,N=(0,u.ML)(o.childNodes[2],!0),D=+(0,u.Fi)(h.Z.PRODUCT_RATING,o).getAttribute("value"),L=(0,d.Ay)(y,r)||(0,d.JE)(N,v)||(0,d.JE)(D,F);(0,a.UC)(T,L)};var f=n(4921),c=n(5213),d=n(3829),a=n(5539),u=n(573),i=n(7877),b=n(5406),x=n(4521),w=n(6504),h=n(4858);const t=(0,b.Fc)(2),{createSectionFilter:e}=(0,x.z)(E,t),r=e("name-filter"),v=e("min-reviews-filter"),F=e("min-rating-filter",4.8),p=e("filter-enabled",!0);await m();async function m(){if(!await(0,f.xk)(document,h.Z.PRODUCT_LIST_TOP))return;const k=(0,u.Fi)(h.Z.PRODUCT_LIST,document,!0);(0,c.b)(k,S,!0),new MutationObserver(E).observe(k,{childList:!0,subtree:!0})}g()}catch(t){g(t)}},1)},4858:(C,s,n)=>{n.d(s,{Z:()=>l});const l={PRODUCT_LIST:'[data-qa="listing"]',PRODUCT_LIST_TOP:"#product-listing-top",PRODUCT_NAME_WRAP:'[data-qa="product-name"]',PRODUCT_RATING_WRAP:'[data-qa="product-rating"]',PRODUCT_RATING:'[name="rating"]'}},6504:(C,s,n)=>{n.d(s,{r:()=>g});const l={input:{marginLeft:"5px",border:"1px solid #dadcde",borderRadius:"8px",padding:"8px 16px",fontSize:"16px"}},g={filtersContainer:{display:"flex",gridGap:"11px",marginBottom:"18px"},control:{display:"flex",alignItems:"center",fontSize:"16px"},textInput:{...l.input,width:"180px"},numberInput:{...l.input,width:"90px"},checkboxInput:{marginLeft:"5px",width:"22px",height:"22px"}}}},V={};function R(C){var s=V[C];if(s!==void 0)return s.exports;var n=V[C]={exports:{}};return O[C](n,n.exports,R),n.exports}(()=>{var C=typeof Symbol=="function"?Symbol("webpack queues"):"__webpack_queues__",s=typeof Symbol=="function"?Symbol("webpack exports"):"__webpack_exports__",n=typeof Symbol=="function"?Symbol("webpack error"):"__webpack_error__",l=f=>{f&&f.d<1&&(f.d=1,f.forEach(c=>c.r--),f.forEach(c=>c.r--?c.r++:c()))},g=f=>f.map(c=>{if(c!==null&&typeof c=="object"){if(c[C])return c;if(c.then){var d=[];d.d=0,c.then(i=>{a[s]=i,l(d)},i=>{a[n]=i,l(d)});var a={};return a[C]=i=>i(d),a}}var u={};return u[C]=i=>{},u[s]=c,u});R.a=(f,c,d)=>{var a;d&&((a=[]).d=-1);var u=new Set,i=f.exports,b,x,w,h=new Promise((t,e)=>{w=e,x=t});h[s]=i,h[C]=t=>(a&&t(a),u.forEach(t),h.catch(e=>{})),f.exports=h,c(t=>{b=g(t);var e,r=()=>b.map(F=>{if(F[n])throw F[n];return F[s]}),v=new Promise(F=>{e=()=>F(r),e.r=0;var p=m=>m!==a&&!u.has(m)&&(u.add(m),m&&!m.d&&(e.r++,m.push(e)));b.map(m=>m[C](p))});return e.r?v:r()},t=>(t?w(h[n]=t):x(i),l(a))),a&&a.d<0&&(a.d=0)}})(),R.d=(C,s)=>{for(var n in s)R.o(s,n)&&!R.o(C,n)&&Object.defineProperty(C,n,{enumerable:!0,get:s[n]})},R.o=(C,s)=>Object.prototype.hasOwnProperty.call(C,s);var G=R(6220)})();})();
