// ==UserScript==
// @name         Vseins product cards filter
// @description  Hide product cards by filter
// @grant        GM_addValueChangeListener
// @grant        GM_setValue
// @grant        GM_getValue
// @match        https://www.vseinstrumenti.ru/tag-page/*
// @match        https://www.vseinstrumenti.ru/category/*
// @namespace    https://github.com/reliable-code/product-list-filters
// @version      0.1.73661282
// @icon         https://www.google.com/s2/favicons?sz=64&domain=vseinstrumenti.ru
// @author       reliable-code
// ==/UserScript==

(()=>{(()=>{"use strict";var A={9928:(w,p,n)=>{n.d(p,{S:()=>v,Sw:()=>S,kU:()=>m,o5:()=>s});var d=n(4921),y=n(573);function m(a,i,f){const C=c(a,"text",i);return C.value=f,C}function s(a,i,f,C,h,t){const e=c(a,"number",i);return e.value=f,e.step=C,e.min=h,e.max=t,e}function v(a,i,f){const C=c(a,"checkbox",i);return C.checked=f,C}function c(a={},i=null,f=null){const C=l("input",a);return i&&(C.type=i),f&&(C.addEventListener("keyup",(0,d.sg)(f,200)),C.addEventListener("change",(0,d.sg)(f,100))),C}function r(a={},i=null){return l("span",a,i)}function o(a={},i=null,f=null){const C=l("a",a,i);return f&&(C.href=f),C}function b(a={},i=null,f=null){const C=l("button",a,i);return f&&(C.onclick=f),C}function S(a={},i=null){return l("div",a,i)}function l(a,i,f=null){if(typeof i!="object"||i===null)throw new TypeError("styles should be an object");const C=document.createElement(a);return(0,y.ZM)(C,i),f&&(C.innerHTML=f),C}},573:(w,p,n)=>{n.d(p,{Fi:()=>m,ML:()=>b,ZM:()=>i,fI:()=>s});var d=n(4214);function y(h,t=document){return!!t.querySelector(h)}function m(h,t=document,e=!1){const u=t.querySelector(h);return e&&!u&&console.log(`No element found for selector: ${h}`),u}function s(h,t=document,e=!1){const u=t.querySelectorAll(h);return e&&!u.length&&console.log(`No elements found for selector: ${h}`),u}function v(h,t,e){return[...h.querySelectorAll(t)].find(u=>u.textContent.trim().includes(e))}function c(h,t,e=!1,u=!1){const g=m(t,h,!0);return r(g,e,u)}function r(h,t=!1,e=!1,u=null){if(!h)return u===null?(console.log("No element found"),null):u;const g=h.innerText;return S(g,t,e)}function o(h,t,e=!1){const u=h[t];return r(u,e)}function b(h,t=!1,e=!1){const u=h.textContent;return S(u,t,e)}function S(h,t,e){return t&&(h=(0,d.zr)(h)),e&&(h=h.replace(",",".")),+h}function l(h){return[...h.childNodes].find(t=>t.nodeType===Node.TEXT_NODE)}function a(h){const t=e=>e.nodeType===Node.TEXT_NODE&&e.textContent.trim()!==""?[e]:[...e.childNodes].flatMap(t);return t(h)}function i(h,t){Object.assign(h.style,t)}function f(h){return Object.entries(h).map(([t,e])=>`${t.replace(/([A-Z])/g,"-$1").toLowerCase()}: ${e};`).join(" ")}function C(h){return h?h.split(";").filter(t=>t.trim()!=="").reduce((t,e)=>{const[u,g]=e.split(":").map(E=>E.trim()),x=u.replace(/-([a-z])/g,(E,F)=>F.toUpperCase());return t[x]=g,t},{}):{}}},5539:(w,p,n)=>{n.d(p,{Bt:()=>y,UC:()=>v,kl:()=>s});function d(t,e){t.parentNode.insertBefore(e,t.nextSibling)}function y(t){b(t),r(t,"none")}function m(t){t.intersectionObserver||runOnceOnIntersection(t,()=>y(t))}function s(t){const e=o(t);r(t,e)}function v(t,e){e?y(t):s(t)}function c(t,e){e?m(t):(clearIntersectionObserver(t),s(t))}function r(t,e){t.style.display=e}function o(t){return b(t),t.defaultDisplay}function b(t){if(t.defaultDisplay)return;const{display:e}=getComputedStyle(t);t.defaultDisplay=e}function S(t,e,u=.3){e?a(t,u):l(t)}function l(t){t.style.opacity=""}function a(t,e=.3){t.style.opacity=e}function i(t){t.style.order=""}function f(t,e){t.style.order=e}function C(t,e){t.style.background=e}function h(t,e="custom-global-style"){let u=document.getElementById(e);u||(u=document.createElement("style"),u.id=e,u.type="text/css",document.head.appendChild(u)),u.textContent=t}},4921:(w,p,n)=>{n.d(p,{sg:()=>m,xk:()=>d});async function d(c,r,o=null){const b=c.querySelector(r);return b?Promise.resolve(b):new Promise(S=>{const l=new MutationObserver(i);l.observe(c,{childList:!0,subtree:!0});let a=null;o&&(a=setTimeout(()=>{l.disconnect(),console.log(`No element found for selector: ${r}`),S(null)},o));function i(){const f=c.querySelector(r);f&&(a&&clearTimeout(a),l.disconnect(),S(f))}})}async function y(c,r){return c.querySelector(r)?new Promise(b=>{const S=new MutationObserver(l);S.observe(c,{childList:!0,subtree:!0});function l(){c.querySelector(r)||(S.disconnect(),b())}}):Promise.resolve()}function m(c,r=250){let o;return(...b)=>{clearTimeout(o),o=setTimeout(()=>c(...b),r)}}function s(c,r){const o=new IntersectionObserver(b=>{b.forEach(S=>{S.isIntersecting&&(r(),v(c))})});c.intersectionObserver=o,o.observe(c)}function v(c){c.intersectionObserver&&(c.intersectionObserver.disconnect(),c.intersectionObserver=null)}},3829:(w,p,n)=>{n.d(p,{Ay:()=>y,JE:()=>s});var d=n(8355);function y(r,o){return!m(r,o)}function m(r,o){if(!o.value)return!0;const b=r.toLowerCase(),S=(0,d.R)(o),l=[],a=[];return S.forEach(i=>{if(i.startsWith("!")){const f=i.substring(1);f&&a.push(f)}else l.push(i)}),l.every(i=>b.includes(i))&&a.every(i=>!b.includes(i))}function s(r,o){return o.value!=null&&r<o.value}function v(r,o){return o.value!=null&&r>o.value}function c(r,o){return o.value&&r!==o.value}},4521:(w,p,n)=>{n.d(p,{z:()=>y});var d=n(3048);function y(m,s=null){return{createGlobalFilter(v,c=null,r=m){return d.V.create(v,c,r)},createSectionFilter(v,c=null,r=m){if(!s)throw new Error("sectionId must be provided to use createSectionFilter.");return d.V.createWithCompositeKey(s,v,c,r)}}}},5884:(w,p,n)=>{n.d(p,{Hw:()=>s,Nm:()=>y,nW:()=>m});var d=n(9928);function y(v,c,r={},o={}){const b=(0,d.Sw)(r,v),S=(0,d.kU)(o,c.updateValueFromEvent,c.value);return b.append(S),b}function m(v,c,r,o,b,S={},l={}){const a=(0,d.Sw)(S,v),i=(0,d.o5)(l,c.updateValueFromEvent,c.value,r,o,b);return a.append(i),a}function s(v,c,r={},o={}){const b=(0,d.Sw)(r,v),S=(0,d.S)(o,c.updateValueFromEvent,c.value);return b.append(S),b}},7877:(w,p,n)=>{n.d(p,{E9:()=>y,HX:()=>m,X0:()=>v,pW:()=>t});var d=n(5884);function y(e,u={},g={}){return(0,d.Nm)("\u041F\u043E\u0438\u0441\u043A: ",e,u,g)}function m(e,u={},g={},x=.1,E=3){return(0,d.nW)("\u041C\u0438\u043D. \u0440\u0435\u0439\u0442\u0438\u043D\u0433: ",e,x,E,5,u,g)}function s(e,u={},g={},x=.1,E=3){return createNumberFilterControl("\u041C\u0430\u043A\u0441. \u0440\u0435\u0439\u0442\u0438\u043D\u0433: ",e,x,E,5,u,g)}function v(e,u={},g={}){return r("\u041C\u0438\u043D. \u043E\u0442\u0437\u044B\u0432\u043E\u0432: ",e,u,g)}function c(e,u={},g={}){return r("\u041C\u0430\u043A\u0441. \u043E\u0442\u0437\u044B\u0432\u043E\u0432: ",e,u,g)}function r(e,u,g={},x={}){return(0,d.nW)(e,u,"1","1","999999",g,x)}function o(e,u={},g={}){return b("\u041C\u0438\u043D. \u0441\u043A\u0438\u0434\u043A\u0430: ",e,u,g)}function b(e,u,g={},x={}){return createNumberFilterControl(e,u,"5","0","100",g,x)}function S(e,u={},g={}){return createNumberFilterControl("\u041C\u0438\u043D. \u043A\u0435\u0448\u0431\u0435\u043A: ",e,"5","0","100",u,g)}function l(e,u,g={},x={},E="250"){return createNumberFilterControl(e,u,E,"0","1000000",g,x)}function a(e,u={},g={},x="25"){return l("\u041C\u0438\u043D. \u0446\u0435\u043D\u0430: ",e,u,g,x)}function i(e,u={},g={},x="25"){return l("\u041C\u0430\u043A\u0441. \u0446\u0435\u043D\u0430: ",e,u,g,x)}function f(e,u,g={},x={}){return createNumberFilterControl(e,u,"1","0","99999",g,x)}function C(e,u={},g={}){return createCheckboxFilterControl("\u0411\u0435\u0437 \u0440\u0435\u0439\u0442\u0438\u043D\u0433\u0430: ",e,u,g)}function h(e,u={},g={}){return createCheckboxFilterControl("\u0421 \u0444\u043E\u0442\u043E: ",e,u,g)}function t(e,u={},g={}){return(0,d.Hw)("\u0412\u043A\u043B: ",e,u,g)}},8355:(w,p,n)=>{n.d(p,{R:()=>d});function d(m){return m.value.toLowerCase().split(",").map(s=>s.trim()).filter(s=>s!=="")}function y(m){return d(m).filter(s=>!s.startsWith("!"))}},5213:(w,p,n)=>{n.d(p,{b:()=>m});var d=n(9928),y=n(573);function m(s,v,c=!1,r="customFiltersContainer"){let o=(0,y.Fi)(`#${r}`,s);if(o)if(c)o.remove();else return;o=(0,d.Sw)(),o.id=r,v(o,s)}},8200:(w,p,n)=>{n.d(p,{s:()=>d});function d(y){const{target:m}=y,{type:s}=m;switch(s){case"text":return`"${m.value}"`;case"number":return m.value;case"checkbox":return m.checked;default:return console.log(`Unknown input type: ${s}`),null}}},157:(w,p,n)=>{n.d(p,{Fg:()=>d,vx:()=>m});const d=window.GM_setValue,y=window.GM.setValue,m=window.GM_getValue,s=window.GM_addValueChangeListener},1870:(w,p,n)=>{n.d(p,{j:()=>d});class d{constructor(m,s){this.value=m,this.onChange=s}onChangeIfDefined=()=>{this.onChange&&this.onChange()}}},3048:(w,p,n)=>{n.d(p,{V:()=>v});var d=n(1870),y=n(8200),m=n(3976),s=n(157);class v extends d.j{constructor(r,o=null,b=null){super((0,s.vx)(r,o),b),this.storageKey=r,this.defaultValue=o}static create(r,o=null,b=null){return new v(r,o,b)}static createWithCompositeKey(r,o,b=null,S=null){const l=`${r}-${o}`;return new v(l,b,S)}updateValueFromEvent=r=>{const o=(0,y.s)(r),b=(0,m.$)(o);this.updateValue(b)};updateValue(r){this.value!==r&&((0,s.Fg)(this.storageKey,r),this.value=r,this.onChangeIfDefined())}clearValue(){this.updateValue(null)}resetValue(){this.updateValue(this.defaultValue)}}},3976:(w,p,n)=>{n.d(p,{$:()=>d});function d(y){return y===""?null:JSON.parse(y)}},4214:(w,p,n)=>{n.d(p,{zr:()=>y});function d(v){return v.replace(/\D/g,"")}function y(v){return v.replace(/[^\d.,-]/g,"")}function m(v){return v.replace(/\s/g,"")}function s(v){return v.charAt(0).toUpperCase()+v.slice(1)}},5406:(w,p,n)=>{n.d(p,{Fc:()=>d});function d(l,a="common",i=!1){const{pathname:f}=window.location;return y(f,l,a,i)}function y(l,a,i,f=!1){const h=l.split("/")[a]||i;return f&&console.log(`Pathname element: ${h}`),h}function m(l,a="common",i=!1){const f=d(l,"",i);return s(f,a,i)}function s(l,a,i){if(!l)return a;const f=l.split("-").at(-1);return i&&console.log(`Pathname element ending: ${f}`),f}function v(l,a,i="common",f=!1){const C=y(l,a,"",f);return s(C,i,f)}function c(l){const a=window.location.search;return r(a,l)}function r(l,a){return new URLSearchParams(l).get(a)}function o(l){return window.location.pathname.includes(l)}function b(l){return l.some(a=>o(a))}function S(l){return window.location.pathname.split("/").some(i=>i===l)}},6220:(w,p,n)=>{n.a(w,async(d,y)=>{try{let g=function(F,N){(0,r.ZM)(F,l.r.filtersContainer);const k=(0,o.E9)(C,l.r.control,l.r.textInput),I=(0,o.X0)(h,l.r.control,l.r.numberInput),R=(0,o.HX)(t,l.r.control,l.r.numberInput),L=(0,o.pW)(e,l.r.control,l.r.checkboxInput);F.append(k,I,R,L),N.parentNode.insertBefore(F,N)},x=function(){(0,r.fI)(`${a.Z.PRODUCT_LIST} > div`).forEach(E)},E=function(F){if(!e.value){(0,c.kl)(F);return}const N=(0,r.Fi)(a.Z.PRODUCT_NAME_WRAP,F),k=(0,r.Fi)(a.Z.PRODUCT_RATING_WRAP,F);if(!N||!k){(0,c.Bt)(F);return}const I=N.innerText,R=(0,r.ML)(k.childNodes[2],!0),D=+(0,r.Fi)(a.Z.PRODUCT_RATING,k).getAttribute("value"),P=(0,v.Ay)(I,C)||(0,v.JE)(R,h)||(0,v.JE)(D,t);(0,c.UC)(F,P)};var m=n(4921),s=n(5213),v=n(3829),c=n(5539),r=n(573),o=n(7877),b=n(5406),S=n(4521),l=n(6504),a=n(4858);const i=(0,b.Fc)(2),{createSectionFilter:f}=(0,S.z)(x,i),C=f("name-filter"),h=f("min-reviews-filter"),t=f("min-rating-filter",4.8),e=f("filter-enabled",!0);await u();async function u(){if(!await(0,m.xk)(document,a.Z.PRODUCT_LIST_TOP))return;const N=(0,r.Fi)(a.Z.PRODUCT_LIST,document,!0);(0,s.b)(N,g,!0),new MutationObserver(x).observe(N,{childList:!0,subtree:!0})}y()}catch(i){y(i)}},1)},4858:(w,p,n)=>{n.d(p,{Z:()=>d});const d={PRODUCT_LIST:'[data-qa="listing"]',PRODUCT_LIST_TOP:"#product-listing-top",PRODUCT_NAME_WRAP:'[data-qa="product-name"]',PRODUCT_RATING_WRAP:'[data-qa="product-rating"]',PRODUCT_RATING:'[name="rating"]'}},6504:(w,p,n)=>{n.d(p,{r:()=>y});const d={input:{marginLeft:"5px",border:"1px solid #dadcde",borderRadius:"8px",padding:"8px 16px",fontSize:"16px"}},y={filtersContainer:{display:"flex",gridGap:"11px",marginBottom:"18px"},control:{display:"flex",alignItems:"center",fontSize:"16px"},textInput:{...d.input,width:"180px"},numberInput:{...d.input,width:"90px"},checkboxInput:{marginLeft:"5px",width:"22px",height:"22px"}}}},V={};function T(w){var p=V[w];if(p!==void 0)return p.exports;var n=V[w]={exports:{}};return A[w](n,n.exports,T),n.exports}(()=>{var w=typeof Symbol=="function"?Symbol("webpack queues"):"__webpack_queues__",p=typeof Symbol=="function"?Symbol("webpack exports"):"__webpack_exports__",n=typeof Symbol=="function"?Symbol("webpack error"):"__webpack_error__",d=m=>{m&&m.d<1&&(m.d=1,m.forEach(s=>s.r--),m.forEach(s=>s.r--?s.r++:s()))},y=m=>m.map(s=>{if(s!==null&&typeof s=="object"){if(s[w])return s;if(s.then){var v=[];v.d=0,s.then(o=>{c[p]=o,d(v)},o=>{c[n]=o,d(v)});var c={};return c[w]=o=>o(v),c}}var r={};return r[w]=o=>{},r[p]=s,r});T.a=(m,s,v)=>{var c;v&&((c=[]).d=-1);var r=new Set,o=m.exports,b,S,l,a=new Promise((i,f)=>{l=f,S=i});a[p]=o,a[w]=i=>(c&&i(c),r.forEach(i),a.catch(f=>{})),m.exports=a,s(i=>{b=y(i);var f,C=()=>b.map(t=>{if(t[n])throw t[n];return t[p]}),h=new Promise(t=>{f=()=>t(C),f.r=0;var e=u=>u!==c&&!r.has(u)&&(r.add(u),u&&!u.d&&(f.r++,u.push(f)));b.map(u=>u[w](e))});return f.r?h:C()},i=>(i?l(a[n]=i):S(o),d(c))),c&&c.d<0&&(c.d=0)}})(),T.d=(w,p)=>{for(var n in p)T.o(p,n)&&!T.o(w,n)&&Object.defineProperty(w,n,{enumerable:!0,get:p[n]})},T.o=(w,p)=>Object.prototype.hasOwnProperty.call(w,p);var O=T(6220)})();})();
