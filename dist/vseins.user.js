// ==UserScript==
// @name         Vseins product cards filter
// @description  Hide product cards by filter
// @grant        GM_addValueChangeListener
// @grant        GM_setValue
// @grant        GM_getValue
// @match        https://www.vseinstrumenti.ru/tag-page/*
// @match        https://www.vseinstrumenti.ru/category/*
// @namespace    https://github.com/reliable-code/product-list-filters
// @version      1.0.73938975
// @icon         https://www.google.com/s2/favicons?sz=64&domain=vseinstrumenti.ru
// @author       reliable-code
// @downloadURL  https://raw.githubusercontent.com/reliable-code/product-list-filters/main/dist/vseins.user.js
// ==/UserScript==

(()=>{(()=>{"use strict";var j={5467:(x,s,n)=>{n.d(s,{E2:()=>m});var d=n(9928);function m(y,a={},e=null){const r=(0,d.Sw)(a,e);return r.append(y),r}function p(y,a=null,e={},r={}){const h=createActionLink(y,a,r);return m(h,e)}function l(y,a=null,e=null,r={},h={}){const C=createActionLinkWithIcon(y,e,a,h);return m(C,r)}},9928:(x,s,n)=>{n.d(s,{S:()=>y,Sw:()=>N,kU:()=>p,o5:()=>l});var d=n(4921),m=n(5539);function p(u,o,E){const v=a(u,"text",o);return v.value=E,v}function l(u,o,E,v,L,g){const b=a(u,"number",o);return b.value=E,b.step=v,b.min=L,b.max=g,b}function y(u,o,E){const v=a(u,"checkbox",o);return v.checked=E,v}function a(u={},o=null,E=null){const v=c("input",u);return o&&(v.type=o),E&&(v.addEventListener("keyup",(0,d.sg)(E,200)),v.addEventListener("change",(0,d.sg)(E,100))),v}function e(u={},o=null){return c("span",u,o)}function r(u={},o=null,E=null){const v=c("a",u,o);return E&&(v.href=E),v}function h(u,o=null,E={}){E.cursor||="pointer";const v=r(E,o);return u&&v.addEventListener("click",u),v}function C(u,o,E=null,v={},L={}){v.display||="inline-flex",v.alignItems||="center",v.gap||="0.25em";const g=h(u,E,v);return g.prepend(t(o,L)),g}function F(u={},o=null,E=null){const v=c("button",u,o);return E&&v.addEventListener("click",E),v}function N(u={},o=null){return c("div",u,o)}function S(u={}){return c("i",u)}function t(u,o={}){o.width||="1em",o.height||="1em",o.paddingBottom||="1px";const E=S(o);return E.setAttribute("data-lucide",u),E}function c(u,o,E=null){if(typeof o!="object"||o===null)throw new TypeError("styles should be an object");const v=document.createElement(u);return(0,m.ZM)(v,o),E&&(v.innerHTML=E),v}},573:(x,s,n)=>{n.d(s,{Fi:()=>p,ML:()=>h,fI:()=>l});var d=n(4214);function m(t,c=document){return!!c.querySelector(t)}function p(t,c=document,u=!1){const o=c.querySelector(t);return u&&!o&&console.log(`No element found for selector: ${t}`),o}function l(t,c=document,u=!1){const o=c.querySelectorAll(t);return u&&!o.length&&console.log(`No elements found for selector: ${t}`),o}function y(t,c,u){return[...t.querySelectorAll(c)].find(o=>o.textContent.trim().includes(u))}function a(t,c,u=!1,o=!1){const E=p(c,t,!0);return e(E,u,o)}function e(t,c=!1,u=!1,o=null){if(!t)return o===null?(console.log("No element found"),null):o;const E=t.innerText;return C(E,c,u)}function r(t,c,u=!1){const o=t[c];return e(o,u)}function h(t,c=!1,u=!1){const o=t.textContent;return C(o,c,u)}function C(t,c,u){c&&(t=(0,d.zr)(t)),u&&(t=t.replace(",","."));const o=Number(t);return Number.isNaN(o)?(console.log(`Invalid number: ${t}`),0):o}function F(t){return[...t.childNodes].find(c=>c.nodeType===Node.TEXT_NODE)}function N(t){const c=u=>u.nodeType===Node.TEXT_NODE&&u.textContent.trim()!==""?[u]:[...u.childNodes].flatMap(c);return c(t)}function S(t){return normalizeSpacing(t.textContent)}},5539:(x,s,n)=>{n.d(s,{Bt:()=>m,UC:()=>e,ZM:()=>I,kl:()=>y});function d(i,w){i.parentNode.insertBefore(w,i.nextSibling)}function m(i){i.style.display="none"}function p(i){C(i),m(i)}function l(i){i.intersectionObserver||runOnceOnIntersection(i,()=>m(i))}function y(i){i.style.display=""}function a(i){const w=h(i);i.style.display=w}function e(i,w){w?m(i):y(i)}function r(i,w){w?l(i):(clearIntersectionObserver(i),y(i))}function h(i){return C(i),i.defaultDisplay}function C(i){if(i.defaultDisplay)return;const{display:w}=getComputedStyle(i);i.defaultDisplay=w}function F(){return{show:[],hide:[]}}function N(i,w,k){i?w.hide.push(k):w.show.push(k)}function S(i){i.show.forEach(y),i.hide.forEach(m)}function t(i,w,k=.3){w?u(i,k):c(i)}function c(i){i.style.opacity=""}function u(i,w=.3){i.style.opacity=w}function o(i){i.style.order=""}function E(i,w){i.style.order=w}function v(i,w){i.style.background=w}function L(i,w){const k=getFirstElement(w);if(!k)return;const A=createLink();A.href=i,k.parentNode.append(A),A.append(k)}function g(i,w){const k=getFirstElement(w);k&&b(i,k)}function b(i,w){const k=createLink();k.href=i,k.append(...w.childNodes),w.append(k)}function f(){const i=getURLQueryParam("scrollTo");if(!i)return;const w=document.getElementById(i);w?w.scrollIntoView():console.log(`Element with ID "${i}" was not found.`)}function T(i,w="custom-global-style"){let k=document.getElementById(w);k||(k=document.createElement("style"),k.id=w,k.type="text/css",document.head.appendChild(k)),k.textContent=i}function I(i,w){Object.assign(i.style,w)}function P(i){return Object.entries(i).map(([w,k])=>`${w.replace(/([A-Z])/g,"-$1").toLowerCase()}: ${k};`).join(" ")}function O(i){return i?i.split(";").filter(w=>w.trim()!=="").reduce((w,k)=>{const[A,V]=k.split(":").map(G=>G.trim()),D=A.replace(/-([a-z])/g,(G,z)=>z.toUpperCase());return w[D]=V,w},{}):{}}function U(i,w,k="text/plain"){const A=new Blob([i],{type:k}),V=URL.createObjectURL(A),D=document.createElement("a");D.href=V,D.download=w,document.body.appendChild(D),D.click(),document.body.removeChild(D),requestAnimationFrame(()=>URL.revokeObjectURL(V))}},4921:(x,s,n)=>{n.d(s,{sg:()=>l,xk:()=>d});function d(e,r,h=null){const C=e.querySelector(r);return C?Promise.resolve(C):new Promise(F=>{const N=new MutationObserver(t);N.observe(e,{childList:!0,subtree:!0});let S;h&&(S=setTimeout(()=>{N.disconnect(),console.log(`No element found for selector: ${r}`),F(null)},h));function t(){const c=e.querySelector(r);c&&(S&&clearTimeout(S),N.disconnect(),F(c))}})}function m(e,r){return e.querySelector(r)?new Promise(C=>{const F=new MutationObserver(N);F.observe(e,{childList:!0,subtree:!0});function N(){e.querySelector(r)||(F.disconnect(),C())}}):Promise.resolve()}function p(e,r=400){return new Promise(h=>{let C;const F=new MutationObserver(()=>{clearTimeout(C),N()});function N(){C=setTimeout(()=>{F.disconnect(),h()},r)}N(),F.observe(e,{childList:!0,subtree:!0})})}function l(e,r=250){let h;return(...C)=>{clearTimeout(h),h=setTimeout(()=>e(...C),r)}}function y(e,r){const h=new IntersectionObserver(C=>{C.forEach(F=>{F.isIntersecting&&(r(),a(e))})});e.intersectionObserver=h,h.observe(e)}function a(e){e.intersectionObserver&&(e.intersectionObserver.disconnect(),e.intersectionObserver=null)}},3829:(x,s,n)=>{n.d(s,{Ay:()=>m,JE:()=>l});var d=n(8355);function m(e,r){return!p(e,r)}function p(e,r){if(!r.value)return!0;const h=e.toLowerCase(),C=(0,d.R)(r),F=[],N=[];return C.forEach(S=>{if(S.startsWith("!")){const t=S.substring(1);t&&N.push(t)}else F.push(S)}),F.every(S=>h.includes(S))&&N.every(S=>!h.includes(S))}function l(e,r){return r.value!=null&&e<r.value}function y(e,r){return r.value!=null&&e>r.value}function a(e,r){return r.value&&e!==r.value}},4521:(x,s,n)=>{n.d(s,{z:()=>m});var d=n(3048);function m(p,l=null){return{createGlobalFilter(y,a=null,e=p){return d.V.create(y,a,e)},createSectionFilter(y,a=null,e=p){if(!l)throw new Error("sectionId must be provided to use createSectionFilter.");return d.V.createWithCompositeKey(l,y,a,e)}}}},5884:(x,s,n)=>{n.d(s,{Hw:()=>y,Nm:()=>p,nW:()=>l});var d=n(9928),m=n(5467);function p(a,e,r={},h={}){const C=(0,d.kU)(h,e.updateValueFromEvent,e.value);return(0,m.E2)(C,r,a)}function l(a,e,r,h,C,F={},N={}){const S=(0,d.o5)(N,e.updateValueFromEvent,e.value,r,h,C);return(0,m.E2)(S,F,a)}function y(a,e,r={},h={}){const C=(0,d.S)(h,e.updateValueFromEvent,e.value);return(0,m.E2)(C,r,a)}},7877:(x,s,n)=>{n.d(s,{E9:()=>m,HX:()=>p,X0:()=>y,pW:()=>L});var d=n(5884);function m(g,b={},f={}){return(0,d.Nm)("\u041F\u043E\u0438\u0441\u043A: ",g,b,f)}function p(g,b={},f={},T=.1,I=3){return(0,d.nW)("\u041C\u0438\u043D. \u0440\u0435\u0439\u0442\u0438\u043D\u0433: ",g,T,I,5,b,f)}function l(g,b={},f={},T=.1,I=3){return createNumberFilterControl("\u041C\u0430\u043A\u0441. \u0440\u0435\u0439\u0442\u0438\u043D\u0433: ",g,T,I,5,b,f)}function y(g,b={},f={}){return e("\u041C\u0438\u043D. \u043E\u0442\u0437\u044B\u0432\u043E\u0432: ",g,b,f)}function a(g,b={},f={}){return e("\u041C\u0430\u043A\u0441. \u043E\u0442\u0437\u044B\u0432\u043E\u0432: ",g,b,f)}function e(g,b,f={},T={}){return(0,d.nW)(g,b,"1","1","999999",f,T)}function r(g,b={},f={}){return h("\u041C\u0438\u043D. \u0441\u043A\u0438\u0434\u043A\u0430: ",g,b,f)}function h(g,b,f={},T={}){return createNumberFilterControl(g,b,"5","0","100",f,T)}function C(g,b={},f={}){return createNumberFilterControl("\u041C\u0438\u043D. \u043A\u0435\u0448\u0431\u0435\u043A: ",g,"5","0","100",b,f)}function F(g,b,f={},T={},I="250"){return createNumberFilterControl(g,b,I,"0","1000000",f,T)}function N(g,b={},f={},T="25"){return F("\u041C\u0438\u043D. \u0446\u0435\u043D\u0430: ",g,b,f,T)}function S(g,b={},f={},T="25"){return F("\u041C\u0430\u043A\u0441. \u0446\u0435\u043D\u0430: ",g,b,f,T)}function t(g,b={},f={}){return c("\u041C\u0438\u043D. \u043B\u0430\u0438\u0306\u043A\u043E\u0432: ",g,b,f)}function c(g,b,f={},T={}){return createNumberFilterControl(g,b,"1","0","99999",f,T)}function u(g,b={},f={}){return createNumberFilterControl("\u041A\u043E\u043B\u043E\u043D\u043E\u043A: ",g,"1","2","7",b,f)}function o(g,b={},f={}){return createCheckboxFilterControl("\u0411\u0435\u0437 \u0440\u0435\u0439\u0442\u0438\u043D\u0433\u0430: ",g,b,f)}function E(g,b={},f={}){return createCheckboxFilterControl("\u0421 \u0444\u043E\u0442\u043E: ",g,b,f)}function v(g,b={},f={}){return createCheckboxFilterControl("\u041F\u0440\u043E\u0433\u0440\u0443\u0437\u043A\u0430: ",g,b,f)}function L(g,b={},f={}){return(0,d.Hw)("\u0412\u043A\u043B: ",g,b,f)}},8355:(x,s,n)=>{n.d(s,{R:()=>d});function d(p){return p.value.toLowerCase().split(",").map(l=>l.trim()).filter(l=>l!=="")}function m(p){return d(p).filter(l=>!l.startsWith("!"))}},5213:(x,s,n)=>{n.d(s,{b:()=>p});var d=n(9928),m=n(573);function p(l,y,a=!1,e="customFiltersContainer"){let r=(0,m.Fi)(`#${e}`,l);if(r)if(a)r.remove();else return;r=(0,d.Sw)(),r.id=e,y(r,l)}},8200:(x,s,n)=>{n.d(s,{s:()=>d});function d(m){const{target:p}=m,{type:l}=p;switch(l){case"text":return`"${p.value}"`;case"number":return p.value;case"checkbox":return p.checked;default:return console.log(`Unknown input type: ${l}`),null}}},157:(x,s,n)=>{n.d(s,{Fg:()=>d,vx:()=>p});const d=window.GM_setValue,m=window.GM.setValue,p=window.GM_getValue,l=window.GM_addValueChangeListener},1870:(x,s,n)=>{n.d(s,{j:()=>d});class d{constructor(p,l){this.value=p,this.onChange=l}onChangeIfDefined=()=>{this.onChange&&this.onChange()}}},3048:(x,s,n)=>{n.d(s,{V:()=>y});var d=n(1870),m=n(8200),p=n(3976),l=n(157);class y extends d.j{constructor(e,r=null,h=null){super((0,l.vx)(e,r),h),this.storageKey=e,this.defaultValue=r}static create(e,r=null,h=null){return new y(e,r,h)}static createWithCompositeKey(e,r,h=null,C=null){const F=`${e}-${r}`;return new y(F,h,C)}updateValueFromEvent=e=>{const r=(0,m.s)(e),h=(0,p.$)(r);this.updateValue(h)};updateValue(e,r=!0){this.value!==e&&((0,l.Fg)(this.storageKey,e),this.value=e,r&&this.onChangeIfDefined())}clearValue(e=!1){this.updateValue(null,e)}resetValue(e=!1){this.updateValue(this.defaultValue,e)}}},3976:(x,s,n)=>{n.d(s,{$:()=>d});function d(m){return m===""?null:JSON.parse(m)}},4214:(x,s,n)=>{n.d(s,{zr:()=>m});function d(a){return a.replace(/\D/g,"")}function m(a){return a.replace(/[^\d.,-]/g,"")}function p(a){return a.replace(/\s/g,"")}function l(a){return a.charAt(0).toUpperCase()+a.slice(1)}function y(a){return a.replace(/\s+/g," ").trim()}},5406:(x,s,n)=>{n.d(s,{Fc:()=>d});function d(t,c="common",u=!1){const{pathname:o}=window.location;return m(o,t,c,u)}function m(t,c,u,o=!1){const v=t.split("/")[c]||u;return o&&console.log(`Pathname element: ${v}`),v}function p(t,c="common",u=!1){const o=d(t,"",u);return l(o,c,u)}function l(t,c,u){if(!t)return c;const o=t.split("-").at(-1);return u&&console.log(`Pathname element ending: ${o}`),o}function y(t,c,u="common",o=!1){const E=m(t,c,"",o);return l(E,u,o)}function a(t){return new URLSearchParams(window.location.search).get(t)}function e(t){return t.split("?")[0]}function r(t){return window.location.pathname.includes(t)}function h(t){return t.some(c=>r(c))}function C(t){return window.location.pathname.split("/").some(u=>u===t)}function F(t){try{const c=new URL(window.location.href);Object.entries(t).forEach(([u,o])=>{c.searchParams.set(u,o)}),window.location.href=c.toString()}catch(c){console.error("Failed to redirect:",c)}}function N(t,c){return function(...u){t.apply(this,u),c()}}function S(t,c){return async function(...u){t.apply(this,u),await c()}}},6220:(x,s,n)=>{n.a(x,async(d,m)=>{try{let L=function(f,T){(0,a.ZM)(f,F.r.filtersContainer);const I=(0,r.E9)(c,F.r.control,F.r.textInput),P=(0,r.X0)(u,F.r.control,F.r.numberInput),O=(0,r.HX)(o,F.r.control,F.r.numberInput),U=(0,r.pW)(E,F.r.control,F.r.checkboxInput);f.append(I,P,O,U),T.parentNode.insertBefore(f,T)},g=function(){(0,e.fI)(`${N.Z.PRODUCT_LIST} > div`).forEach(b)},b=function(f){if(!E.value){(0,a.kl)(f);return}const T=(0,e.Fi)(N.Z.PRODUCT_NAME_WRAP,f),I=(0,e.Fi)(N.Z.PRODUCT_RATING_WRAP,f);if(!T||!I){(0,a.Bt)(f);return}const P=T.innerText,O=(0,e.ML)(I.childNodes[2],!0),i=+(0,e.Fi)(N.Z.PRODUCT_RATING,I).getAttribute("value"),w=(0,y.Ay)(P,c)||(0,y.JE)(O,u)||(0,y.JE)(i,o);(0,a.UC)(f,w)};var p=n(4921),l=n(5213),y=n(3829),a=n(5539),e=n(573),r=n(7877),h=n(5406),C=n(4521),F=n(6504),N=n(4858);const S=(0,h.Fc)(2),{createSectionFilter:t}=(0,C.z)(g,S),c=t("name-filter"),u=t("min-reviews-filter"),o=t("min-rating-filter",4.8),E=t("filter-enabled",!0);await v();async function v(){if(!await(0,p.xk)(document,N.Z.PRODUCT_LIST_TOP))return;const T=(0,e.Fi)(N.Z.PRODUCT_LIST,document,!0);(0,l.b)(T,L,!0),new MutationObserver(g).observe(T,{childList:!0,subtree:!0})}m()}catch(S){m(S)}},1)},4858:(x,s,n)=>{n.d(s,{Z:()=>d});const d={PRODUCT_LIST:'[data-qa="listing"]',PRODUCT_LIST_TOP:"#product-listing-top",PRODUCT_NAME_WRAP:'[data-qa="product-name"]',PRODUCT_RATING_WRAP:'[data-qa="product-rating"]',PRODUCT_RATING:'[name="rating"]'}},6504:(x,s,n)=>{n.d(s,{r:()=>m});const d={input:{marginLeft:"5px",border:"1px solid #dadcde",borderRadius:"8px",padding:"8px 16px",fontSize:"16px"}},m={filtersContainer:{display:"flex",gridGap:"11px",marginBottom:"18px"},control:{display:"flex",alignItems:"center",fontSize:"16px"},textInput:{...d.input,width:"180px"},numberInput:{...d.input,width:"90px"},checkboxInput:{marginLeft:"5px",width:"22px",height:"22px"}}}},$={};function R(x){var s=$[x];if(s!==void 0)return s.exports;var n=$[x]={exports:{}};return j[x](n,n.exports,R),n.exports}(()=>{var x=typeof Symbol=="function"?Symbol("webpack queues"):"__webpack_queues__",s=typeof Symbol=="function"?Symbol("webpack exports"):"__webpack_exports__",n=typeof Symbol=="function"?Symbol("webpack error"):"__webpack_error__",d=p=>{p&&p.d<1&&(p.d=1,p.forEach(l=>l.r--),p.forEach(l=>l.r--?l.r++:l()))},m=p=>p.map(l=>{if(l!==null&&typeof l=="object"){if(l[x])return l;if(l.then){var y=[];y.d=0,l.then(r=>{a[s]=r,d(y)},r=>{a[n]=r,d(y)});var a={};return a[x]=r=>r(y),a}}var e={};return e[x]=r=>{},e[s]=l,e});R.a=(p,l,y)=>{var a;y&&((a=[]).d=-1);var e=new Set,r=p.exports,h,C,F,N=new Promise((S,t)=>{F=t,C=S});N[s]=r,N[x]=S=>(a&&S(a),e.forEach(S),N.catch(t=>{})),p.exports=N,l(S=>{h=m(S);var t,c=()=>h.map(o=>{if(o[n])throw o[n];return o[s]}),u=new Promise(o=>{t=()=>o(c),t.r=0;var E=v=>v!==a&&!e.has(v)&&(e.add(v),v&&!v.d&&(t.r++,v.push(t)));h.map(v=>v[x](E))});return t.r?u:c()},S=>(S?F(N[n]=S):C(r),d(a))),a&&a.d<0&&(a.d=0)}})(),R.d=(x,s)=>{for(var n in s)R.o(s,n)&&!R.o(x,n)&&Object.defineProperty(x,n,{enumerable:!0,get:s[n]})},R.o=(x,s)=>Object.prototype.hasOwnProperty.call(x,s);var B=R(6220)})();})();
