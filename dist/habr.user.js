// ==UserScript==
// @name         Habr comments filter
// @description  Hide comments by filter
// @grant        GM_addValueChangeListener
// @grant        GM_setValue
// @grant        GM_getValue
// @match        https://habr.com/*
// @namespace    https://github.com/reliable-code/product-list-filters
// @version      1.0.73897347
// @icon         https://www.google.com/s2/favicons?sz=64&domain=habr.com
// @author       reliable-code
// ==/UserScript==

(()=>{(()=>{"use strict";var V={5467:(x,a,t)=>{t.d(a,{E2:()=>v});var y=t(9928);function v(g,o={},e=null){const r=(0,y.Sw)(o,e);return r.append(g),r}function b(g,o=null,e={},r={}){const s=createActionLink(g,o,r);return v(s,e)}function d(g,o=null,e=null,r={},s={}){const w=createActionLinkWithIcon(g,e,o,s);return v(w,r)}},9928:(x,a,t)=>{t.d(a,{S:()=>g,Sw:()=>F,o5:()=>d});var y=t(4921),v=t(5539);function b(c,f,N){const m=o(c,"text",f);return m.value=N,m}function d(c,f,N,m,O,E){const l=o(c,"number",f);return l.value=N,l.step=m,l.min=O,l.max=E,l}function g(c,f,N){const m=o(c,"checkbox",f);return m.checked=N,m}function o(c={},f=null,N=null){const m=C("input",c);return f&&(m.type=f),N&&(m.addEventListener("keyup",(0,y.sg)(N,200)),m.addEventListener("change",(0,y.sg)(N,100))),m}function e(c={},f=null){return C("span",c,f)}function r(c={},f=null,N=null){const m=C("a",c,f);return N&&(m.href=N),m}function s(c,f=null,N={}){N.cursor||="pointer";const m=r(N,f);return c&&m.addEventListener("click",c),m}function w(c,f,N=null,m={}){m.display||="inline-flex",m.alignItems||="center",m.gap||="0.25em";const O=s(c,N,m);return O.prepend(h(f)),O}function T(c={},f=null,N=null){const m=C("button",c,f);return N&&m.addEventListener("click",N),m}function F(c={},f=null){return C("div",c,f)}function i(c={}){return C("i",c)}function h(c,f={}){f.width||="1em",f.height||="1em",f.paddingBottom||="1px";const N=i(f);return N.setAttribute("data-lucide",c),N}function C(c,f,N=null){if(typeof f!="object"||f===null)throw new TypeError("styles should be an object");const m=document.createElement(c);return(0,v.ZM)(m,f),N&&(m.innerHTML=N),m}},573:(x,a,t)=>{t.d(a,{Fi:()=>v,fI:()=>b});function y(i,h=document){return!!h.querySelector(i)}function v(i,h=document,C=!1){const c=h.querySelector(i);return C&&!c&&console.log(`No element found for selector: ${i}`),c}function b(i,h=document,C=!1){const c=h.querySelectorAll(i);return C&&!c.length&&console.log(`No elements found for selector: ${i}`),c}function d(i,h,C){return[...i.querySelectorAll(h)].find(c=>c.textContent.trim().includes(C))}function g(i,h,C=!1,c=!1){const f=v(h,i,!0);return o(f,C,c)}function o(i,h=!1,C=!1,c=null){if(!i)return c===null?(console.log("No element found"),null):c;const f=i.innerText;return s(f,h,C)}function e(i,h,C=!1){const c=i[h];return o(c,C)}function r(i,h=!1,C=!1){const c=i.textContent;return s(c,h,C)}function s(i,h,C){h&&(i=removeNonNumber(i)),C&&(i=i.replace(",","."));const c=Number(i);return Number.isNaN(c)?(console.log(`Invalid number: ${i}`),0):c}function w(i){return[...i.childNodes].find(h=>h.nodeType===Node.TEXT_NODE)}function T(i){const h=C=>C.nodeType===Node.TEXT_NODE&&C.textContent.trim()!==""?[C]:[...C.childNodes].flatMap(h);return h(i)}function F(i){return normalizeSpacing(i.textContent)}},5539:(x,a,t)=>{t.d(a,{Bt:()=>v,ZM:()=>I,kl:()=>g});function y(n,p){n.parentNode.insertBefore(p,n.nextSibling)}function v(n){n.style.display="none"}function b(n){w(n),v(n)}function d(n){n.intersectionObserver||runOnceOnIntersection(n,()=>v(n))}function g(n){n.style.display=""}function o(n){const p=s(n);n.style.display=p}function e(n,p){p?v(n):g(n)}function r(n,p){p?d(n):(clearIntersectionObserver(n),g(n))}function s(n){return w(n),n.defaultDisplay}function w(n){if(n.defaultDisplay)return;const{display:p}=getComputedStyle(n);n.defaultDisplay=p}function T(){return{show:[],hide:[]}}function F(n,p,k){n?p.hide.push(k):p.show.push(k)}function i(n){n.show.forEach(g),n.hide.forEach(v)}function h(n,p,k=.3){p?c(n,k):C(n)}function C(n){n.style.opacity=""}function c(n,p=.3){n.style.opacity=p}function f(n){n.style.order=""}function N(n,p){n.style.order=p}function m(n,p){n.style.background=p}function O(n,p){const k=getFirstElement(p);if(!k)return;const A=createLink();A.href=n,k.parentNode.append(A),A.append(k)}function E(n,p){const k=getFirstElement(p);k&&l(n,k)}function l(n,p){const k=createLink();k.href=n,k.append(...p.childNodes),p.append(k)}function u(){const n=getURLQueryParam("scrollTo");if(!n)return;const p=document.getElementById(n);p?p.scrollIntoView():console.log(`Element with ID "${n}" was not found.`)}function S(n,p="custom-global-style"){let k=document.getElementById(p);k||(k=document.createElement("style"),k.id=p,k.type="text/css",document.head.appendChild(k)),k.textContent=n}function I(n,p){Object.assign(n.style,p)}function M(n){return Object.entries(n).map(([p,k])=>`${p.replace(/([A-Z])/g,"-$1").toLowerCase()}: ${k};`).join(" ")}function _(n){return n?n.split(";").filter(p=>p.trim()!=="").reduce((p,k)=>{const[A,R]=k.split(":").map(B=>B.trim()),D=A.replace(/-([a-z])/g,(B,U)=>U.toUpperCase());return p[D]=R,p},{}):{}}function W(n,p,k="text/plain"){const A=new Blob([n],{type:k}),R=URL.createObjectURL(A),D=document.createElement("a");D.href=R,D.download=p,document.body.appendChild(D),D.click(),document.body.removeChild(D),requestAnimationFrame(()=>URL.revokeObjectURL(R))}},4921:(x,a,t)=>{t.d(a,{sg:()=>d,xk:()=>y});function y(e,r,s=null){const w=e.querySelector(r);return w?Promise.resolve(w):new Promise(T=>{const F=new MutationObserver(h);F.observe(e,{childList:!0,subtree:!0});let i;s&&(i=setTimeout(()=>{F.disconnect(),console.log(`No element found for selector: ${r}`),T(null)},s));function h(){const C=e.querySelector(r);C&&(i&&clearTimeout(i),F.disconnect(),T(C))}})}function v(e,r){return e.querySelector(r)?new Promise(w=>{const T=new MutationObserver(F);T.observe(e,{childList:!0,subtree:!0});function F(){e.querySelector(r)||(T.disconnect(),w())}}):Promise.resolve()}function b(e,r=400){return new Promise(s=>{let w;const T=new MutationObserver(()=>{clearTimeout(w),F()});function F(){w=setTimeout(()=>{T.disconnect(),s()},r)}F(),T.observe(e,{childList:!0,subtree:!0})})}function d(e,r=250){let s;return(...w)=>{clearTimeout(s),s=setTimeout(()=>e(...w),r)}}function g(e,r){const s=new IntersectionObserver(w=>{w.forEach(T=>{T.isIntersecting&&(r(),o(e))})});e.intersectionObserver=s,s.observe(e)}function o(e){e.intersectionObserver&&(e.intersectionObserver.disconnect(),e.intersectionObserver=null)}},3829:(x,a,t)=>{t.d(a,{JE:()=>b});function y(o,e){return!v(o,e)}function v(o,e){if(!e.value)return!0;const r=o.toLowerCase(),s=getSearchStrings(e),w=[],T=[];return s.forEach(F=>{if(F.startsWith("!")){const i=F.substring(1);i&&T.push(i)}else w.push(F)}),w.every(F=>r.includes(F))&&T.every(F=>!r.includes(F))}function b(o,e){return e.value!=null&&o<e.value}function d(o,e){return e.value!=null&&o>e.value}function g(o,e){return e.value&&o!==e.value}},4521:(x,a,t)=>{t.d(a,{z:()=>v});var y=t(3048);function v(b,d=null){return{createGlobalFilter(g,o=null,e=b){return y.V.create(g,o,e)},createSectionFilter(g,o=null,e=b){if(!d)throw new Error("sectionId must be provided to use createSectionFilter.");return y.V.createWithCompositeKey(d,g,o,e)}}}},5884:(x,a,t)=>{t.d(a,{Hw:()=>g,nW:()=>d});var y=t(9928),v=t(5467);function b(o,e,r={},s={}){const w=createTextInput(s,e.updateValueFromEvent,e.value);return createControl(w,r,o)}function d(o,e,r,s,w,T={},F={}){const i=(0,y.o5)(F,e.updateValueFromEvent,e.value,r,s,w);return(0,v.E2)(i,T,o)}function g(o,e,r={},s={}){const w=(0,y.S)(s,e.updateValueFromEvent,e.value);return(0,v.E2)(w,r,o)}},7877:(x,a,t)=>{t.d(a,{aW:()=>h,pW:()=>O});var y=t(5884);function v(E,l={},u={}){return createTextFilterControl("\u041F\u043E\u0438\u0441\u043A: ",E,l,u)}function b(E,l={},u={},S=.1,I=3){return createNumberFilterControl("\u041C\u0438\u043D. \u0440\u0435\u0439\u0442\u0438\u043D\u0433: ",E,S,I,5,l,u)}function d(E,l={},u={},S=.1,I=3){return createNumberFilterControl("\u041C\u0430\u043A\u0441. \u0440\u0435\u0439\u0442\u0438\u043D\u0433: ",E,S,I,5,l,u)}function g(E,l={},u={}){return e("\u041C\u0438\u043D. \u043E\u0442\u0437\u044B\u0432\u043E\u0432: ",E,l,u)}function o(E,l={},u={}){return e("\u041C\u0430\u043A\u0441. \u043E\u0442\u0437\u044B\u0432\u043E\u0432: ",E,l,u)}function e(E,l,u={},S={}){return createNumberFilterControl(E,l,"1","1","999999",u,S)}function r(E,l={},u={}){return s("\u041C\u0438\u043D. \u0441\u043A\u0438\u0434\u043A\u0430: ",E,l,u)}function s(E,l,u={},S={}){return createNumberFilterControl(E,l,"5","0","100",u,S)}function w(E,l={},u={}){return createNumberFilterControl("\u041C\u0438\u043D. \u043A\u0435\u0448\u0431\u0435\u043A: ",E,"5","0","100",l,u)}function T(E,l,u={},S={},I="250"){return createNumberFilterControl(E,l,I,"0","1000000",u,S)}function F(E,l={},u={},S="25"){return T("\u041C\u0438\u043D. \u0446\u0435\u043D\u0430: ",E,l,u,S)}function i(E,l={},u={},S="25"){return T("\u041C\u0430\u043A\u0441. \u0446\u0435\u043D\u0430: ",E,l,u,S)}function h(E,l={},u={}){return C("\u041C\u0438\u043D. \u043B\u0430\u0438\u0306\u043A\u043E\u0432: ",E,l,u)}function C(E,l,u={},S={}){return(0,y.nW)(E,l,"1","0","99999",u,S)}function c(E,l={},u={}){return createNumberFilterControl("\u041A\u043E\u043B\u043E\u043D\u043E\u043A: ",E,"1","2","6",l,u)}function f(E,l={},u={}){return createCheckboxFilterControl("\u0411\u0435\u0437 \u0440\u0435\u0439\u0442\u0438\u043D\u0433\u0430: ",E,l,u)}function N(E,l={},u={}){return createCheckboxFilterControl("\u0421 \u0444\u043E\u0442\u043E: ",E,l,u)}function m(E,l={},u={}){return createCheckboxFilterControl("\u041F\u0440\u043E\u0433\u0440\u0443\u0437\u043A\u0430: ",E,l,u)}function O(E,l={},u={}){return(0,y.Hw)("\u0412\u043A\u043B: ",E,l,u)}},5213:(x,a,t)=>{t.d(a,{b:()=>b});var y=t(9928),v=t(573);function b(d,g,o=!1,e="customFiltersContainer"){let r=(0,v.Fi)(`#${e}`,d);if(r)if(o)r.remove();else return;r=(0,y.Sw)(),r.id=e,g(r,d)}},8200:(x,a,t)=>{t.d(a,{s:()=>y});function y(v){const{target:b}=v,{type:d}=b;switch(d){case"text":return`"${b.value}"`;case"number":return b.value;case"checkbox":return b.checked;default:return console.log(`Unknown input type: ${d}`),null}}},157:(x,a,t)=>{t.d(a,{Fg:()=>y,vx:()=>b});const y=window.GM_setValue,v=window.GM.setValue,b=window.GM_getValue,d=window.GM_addValueChangeListener},1870:(x,a,t)=>{t.d(a,{j:()=>y});class y{constructor(b,d){this.value=b,this.onChange=d}onChangeIfDefined=()=>{this.onChange&&this.onChange()}}},3048:(x,a,t)=>{t.d(a,{V:()=>g});var y=t(1870),v=t(8200),b=t(3976),d=t(157);class g extends y.j{constructor(e,r=null,s=null){super((0,d.vx)(e,r),s),this.storageKey=e,this.defaultValue=r}static create(e,r=null,s=null){return new g(e,r,s)}static createWithCompositeKey(e,r,s=null,w=null){const T=`${e}-${r}`;return new g(T,s,w)}updateValueFromEvent=e=>{const r=(0,v.s)(e),s=(0,b.$)(r);this.updateValue(s)};updateValue(e,r=!0){this.value!==e&&((0,d.Fg)(this.storageKey,e),this.value=e,r&&this.onChangeIfDefined())}clearValue(e=!1){this.updateValue(null,e)}resetValue(e=!1){this.updateValue(this.defaultValue,e)}}},3976:(x,a,t)=>{t.d(a,{$:()=>y});function y(v){return v===""?null:JSON.parse(v)}},6213:(x,a,t)=>{t.a(x,async(y,v)=>{try{let N=function(u,S){(0,b.ZM)(u,e.r.FILTERS_CONTAINER);const I=(0,g.aW)(i,e.r.CONTROL,e.r.NUMBER_INPUT),M=(0,g.pW)(h,e.r.CONTROL,e.r.CHECKBOX_INPUT);u.append(I,M),S.append(u)},m=function(){(0,d.fI)(o.Z.COMMENTS).forEach(O)},O=function(u){if(!h.value){l(u);return}let S=C.commentsCache.get(u);if(!S){const M=(0,d.Fi)(o.Z.RATING_WRAP,u);if(!M)return;const _=M.innerText.trim();if(_==="")return;S={rating:+_},C.commentsCache.set(u,S)}(0,w.JE)(S.rating,i)?E(u):l(u)},E=function(u){(0,b.Bt)(u);const S=u.parentElement;S&&[...S.children].every(I=>I.style.display==="none")&&E(S)},l=function(u){(0,b.kl)(u);const S=u.parentElement;S&&S.style.display==="none"&&l(S)};var b=t(5539),d=t(573),g=t(7877),o=t(1719),e=t(9175),r=t(4521),s=t(5213),w=t(3829),T=t(4921);const{createGlobalFilter:F}=(0,r.z)(m),i=F("min-rating-filter",4),h=F("filter-enabled",!0),C={commentsCache:new WeakMap};await c();async function c(){const u=await(0,T.xk)(document,o.Z.COMMENTS_TREE);new MutationObserver(f).observe(u,{childList:!0,subtree:!0})}async function f(){const u=await(0,T.xk)(document,o.Z.COMMENTS_HEADER);(0,s.b)(u,N),m()}v()}catch(F){v(F)}},1)},1719:(x,a,t)=>{t.d(a,{Z:()=>y});const y={COMMENTS_TREE:".tm-comments__tree",COMMENTS_HEADER:".tm-comments-wrapper__header",COMMENTS:".tm-comment-thread__comment:not(.process-passed)",RATING_WRAP:".tm-votes-lever__score-counter"}},9175:(x,a,t)=>{t.d(a,{r:()=>v});const v={FILTERS_CONTAINER:{display:"flex",gridGap:"12px",marginLeft:"28px"},CONTROL:{display:"flex",alignItems:"center",fontSize:"15px"},NUMBER_INPUT:{...{INPUT:{marginLeft:"6px",border:"1px solid #d9d9d9",borderRadius:"8px",padding:"7px 14px",fontSize:"15px"}}.INPUT,width:"35px"},CHECKBOX_INPUT:{marginLeft:"6px",width:"21px",height:"21px"}}}},P={};function L(x){var a=P[x];if(a!==void 0)return a.exports;var t=P[x]={exports:{}};return V[x](t,t.exports,L),t.exports}(()=>{var x=typeof Symbol=="function"?Symbol("webpack queues"):"__webpack_queues__",a=typeof Symbol=="function"?Symbol("webpack exports"):"__webpack_exports__",t=typeof Symbol=="function"?Symbol("webpack error"):"__webpack_error__",y=b=>{b&&b.d<1&&(b.d=1,b.forEach(d=>d.r--),b.forEach(d=>d.r--?d.r++:d()))},v=b=>b.map(d=>{if(d!==null&&typeof d=="object"){if(d[x])return d;if(d.then){var g=[];g.d=0,d.then(r=>{o[a]=r,y(g)},r=>{o[t]=r,y(g)});var o={};return o[x]=r=>r(g),o}}var e={};return e[x]=r=>{},e[a]=d,e});L.a=(b,d,g)=>{var o;g&&((o=[]).d=-1);var e=new Set,r=b.exports,s,w,T,F=new Promise((i,h)=>{T=h,w=i});F[a]=r,F[x]=i=>(o&&i(o),e.forEach(i),F.catch(h=>{})),b.exports=F,d(i=>{s=v(i);var h,C=()=>s.map(f=>{if(f[t])throw f[t];return f[a]}),c=new Promise(f=>{h=()=>f(C),h.r=0;var N=m=>m!==o&&!e.has(m)&&(e.add(m),m&&!m.d&&(h.r++,m.push(h)));s.map(m=>m[x](N))});return h.r?c:C()},i=>(i?T(F[t]=i):w(r),y(o))),o&&o.d<0&&(o.d=0)}})(),L.d=(x,a)=>{for(var t in a)L.o(a,t)&&!L.o(x,t)&&Object.defineProperty(x,t,{enumerable:!0,get:a[t]})},L.o=(x,a)=>Object.prototype.hasOwnProperty.call(x,a);var $=L(6213)})();})();
