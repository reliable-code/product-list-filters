// ==UserScript==
// @name         WB List Clean
// @description  Remove product cards by filter
// @match        https://www.wildberries.ru/*
// @namespace    https://github.com/reliable-code/product-list-filters
// @version      0.5.69653513
// @icon         https://www.google.com/s2/favicons?sz=64&domain=wildberries.ru
// @author       reliable-code
// ==/UserScript==

(()=>{"use strict";var __webpack_modules__={33:(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{
/* harmony export */__webpack_require__.d(__webpack_exports__,{
/* harmony export */HV:()=>/* binding */createFilterControlNumber,
/* harmony export */br:()=>/* binding */waitForElement,
/* harmony export */g1:()=>/* binding */getFirstElementInnerNumber,
/* harmony export */wC:()=>/* binding */createDiv,
/* harmony export */yM:()=>/* binding */updateInput});
/* unused harmony exports getFirstElement, getAllElements, insertAfter, createFilterControlCheckbox, getElementInnerNumber, getArrayElementInnerNumber */
function getFirstElement(parentNode,selector,logNotFound=false){const element=parentNode.querySelector(selector);logNotFound&&!element&&console.log(`No element found for selector: ${selector}`);return element}function updateInput(keyName,e){const{target}=e;const{type}=target;type==="number"?localStorage.setItem(keyName,target.value):type==="checkbox"&&localStorage.setItem(keyName,target.checked);window.location.reload()}function createFilterControlNumber(titleText,inputValue,inputStep,inputMinValue,inputMaxValue,inputOnChange,controlStyle="",inputStyle=""){const filterControl=createDiv(titleText,controlStyle);const input=createBaseInput(inputOnChange,inputStyle);input.type="number";input.value=inputValue;input.step=inputStep;input.min=inputMinValue;input.max=inputMaxValue;filterControl.append(input);return filterControl}function createBaseInput(inputOnChange,style){const input=document.createElement("input");input.addEventListener("change",inputOnChange);input.style=style;return input}function createDiv(textContent,style=""){const div=document.createElement("div");div.textContent=textContent;div.style=style;return div}function getFirstElementInnerNumber(parentNode,selector,cleanText){const element=getFirstElement(parentNode,selector,true);const elementNumber=getElementInnerNumber(element,cleanText);return elementNumber}function getElementInnerNumber(element,cleanText=false){let elementText=element.innerText;cleanText&&(elementText=elementText.replace(/\D/g,""));const elementNumber=+elementText;return elementNumber}function waitForElement(parentNode,selector,timeout=null){return new Promise((resolve=>{const observer=new MutationObserver(mutationCallback);observer.observe(parentNode,{childList:true,subtree:true});let timeoutId=null;timeout&&(timeoutId=setTimeout((()=>{observer.disconnect();console.log(`No element found for selector: ${selector}`);resolve(null)}),timeout));function mutationCallback(){if(parentNode.querySelector(selector)){timeoutId&&clearTimeout(timeoutId);observer.disconnect();resolve(parentNode.querySelector(selector))}}}))}},823:(module,__unused_webpack___webpack_exports__,__webpack_require__)=>{__webpack_require__.a(module,(async(__webpack_handle_async_dependencies__,__webpack_async_result__)=>{try{
/* harmony import */var _common_dom__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(33);const MIN_REVIEWS=50;const MIN_RATING=4.8;const CATEGORY_NAME=getCategoryName();const MIN_REVIEWS_LOCAL_STORAGE_KEY=`${CATEGORY_NAME}-min-reviews-filter`;const MIN_RATING_LOCAL_STORAGE_KEY=`${CATEGORY_NAME}-min-rating-filter`;const FILTERS_BLOCK_WRAP_SELECTOR=".filters-block__wrap";const PRODUCT_CARD_SELECTOR=".product-card";const PRODUCT_CARD_REVIEWS_SELECTOR=".product-card__count";const PRODUCT_CARD_RATING_SELECTOR=".address-rate-mini";const PRODUCT_CARD_PRICE_SELECTOR=".price__lower-price";const PRICE_FILTER_URL_PARAMS_NAME="priceU";const minReviewsValue=+(localStorage.getItem(MIN_REVIEWS_LOCAL_STORAGE_KEY)??MIN_REVIEWS);const minRatingValue=+(localStorage.getItem(MIN_RATING_LOCAL_STORAGE_KEY)??MIN_RATING);const minPriceValue=getMinPriceValueFromURL();function getCategoryName(){const{pathname}=window.location;const pathElements=pathname.split("/");const lastPathElement=pathElements.pop();const categoryName=lastPathElement||"common";return categoryName}function getMinPriceValueFromURL(){const params=new URLSearchParams(window.location.search);if(!params.has(PRICE_FILTER_URL_PARAMS_NAME))return 0;const priceFilterParams=params.get(PRICE_FILTER_URL_PARAMS_NAME);const priceFilterParamsArray=priceFilterParams.split(";");const minPriceFilterParam=priceFilterParamsArray[0];const minPriceFilterValue=minPriceFilterParam/100;return minPriceFilterValue}const filtersBlockWrap=await(0,_common_dom__WEBPACK_IMPORTED_MODULE_0__.br)(document,FILTERS_BLOCK_WRAP_SELECTOR,1500);if(filtersBlockWrap){removeRecentItemsBlock();appendFilterControls();setInterval(cleanList,500)}function removeRecentItemsBlock(){const recentItems=document.querySelector(".j-recent-items");if(recentItems){const{parentNode}=recentItems;parentNode.remove()}}function appendFilterControls(){const filtersBlockContainer=document.createElement("div");filtersBlockContainer.classList.add("filters-block__container");filtersBlockContainer.style="display: flex;";filtersBlockWrap.append(filtersBlockContainer);const controlStyle="padding-left: 7px; margin-top: 14px;";const minReviewsDiv=(0,_common_dom__WEBPACK_IMPORTED_MODULE_0__.HV)("Минимально отзывов: ",minReviewsValue,"1","1","999999",updateMinReviewsInput,controlStyle);const minRatingDiv=(0,_common_dom__WEBPACK_IMPORTED_MODULE_0__.HV)("Минимальный рейтинг: ",minRatingValue,"0.1","4.0","5.0",updateMinRatingInput,controlStyle);const minPriceDiv=(0,_common_dom__WEBPACK_IMPORTED_MODULE_0__.wC)(`Минимальная цена: ${minPriceValue}`,controlStyle);setInterval(checkMinPrice,1500);filtersBlockContainer.append(minReviewsDiv,minRatingDiv,minPriceDiv)}function updateMinReviewsInput(e){(0,_common_dom__WEBPACK_IMPORTED_MODULE_0__.yM)(MIN_REVIEWS_LOCAL_STORAGE_KEY,e)}function updateMinRatingInput(e){(0,_common_dom__WEBPACK_IMPORTED_MODULE_0__.yM)(MIN_RATING_LOCAL_STORAGE_KEY,e)}function checkMinPrice(){const currentMinPriceValue=getMinPriceValueFromURL();minPriceValue!==currentMinPriceValue&&window.location.reload()}function cleanList(){const productCards=document.querySelectorAll(PRODUCT_CARD_SELECTOR);productCards.forEach((productCard=>{const productCardReviewsNumber=(0,_common_dom__WEBPACK_IMPORTED_MODULE_0__.g1)(productCard,PRODUCT_CARD_REVIEWS_SELECTOR,true);const productCardRatingNumber=(0,_common_dom__WEBPACK_IMPORTED_MODULE_0__.g1)(productCard,PRODUCT_CARD_RATING_SELECTOR);const productCardPriceNumber=(0,_common_dom__WEBPACK_IMPORTED_MODULE_0__.g1)(productCard,PRODUCT_CARD_PRICE_SELECTOR,true);(productCardReviewsNumber<minReviewsValue||productCardRatingNumber<minRatingValue||productCardPriceNumber<minPriceValue)&&productCard.remove()}))}__webpack_async_result__()}catch(e){__webpack_async_result__(e)}}),1)}};
// The module cache
var __webpack_module_cache__={};
// The require function
function __webpack_require__(moduleId){
// Check if module is in cache
var cachedModule=__webpack_module_cache__[moduleId];if(cachedModule!==void 0)return cachedModule.exports;
// Create a new module (and put it into the cache)
var module=__webpack_module_cache__[moduleId]={
// no module.id needed
// no module.loaded needed
exports:{}};
// Execute the module function
__webpack_modules__[moduleId](module,module.exports,__webpack_require__);
// Return the exports of the module
return module.exports}
/* webpack/runtime/async module */
(()=>{var webpackQueues=typeof Symbol==="function"?Symbol("webpack queues"):"__webpack_queues__";var webpackExports=typeof Symbol==="function"?Symbol("webpack exports"):"__webpack_exports__";var webpackError=typeof Symbol==="function"?Symbol("webpack error"):"__webpack_error__";var resolveQueue=queue=>{if(queue&&queue.d<1){queue.d=1;queue.forEach((fn=>fn.r--));queue.forEach((fn=>fn.r--?fn.r++:fn()))}};var wrapDeps=deps=>deps.map((dep=>{if(dep!==null&&typeof dep==="object"){if(dep[webpackQueues])return dep;if(dep.then){var queue=[];queue.d=0;dep.then((r=>{obj[webpackExports]=r;resolveQueue(queue)}),(e=>{obj[webpackError]=e;resolveQueue(queue)}));var obj={};obj[webpackQueues]=fn=>fn(queue);return obj}}var ret={};ret[webpackQueues]=x=>{};ret[webpackExports]=dep;return ret}));__webpack_require__.a=(module,body,hasAwait)=>{var queue;hasAwait&&((queue=[]).d=-1);var depQueues=new Set;var exports=module.exports;var currentDeps;var outerResolve;var reject;var promise=new Promise(((resolve,rej)=>{reject=rej;outerResolve=resolve}));promise[webpackExports]=exports;promise[webpackQueues]=fn=>(queue&&fn(queue),depQueues.forEach(fn),promise["catch"]((x=>{})));module.exports=promise;body((deps=>{currentDeps=wrapDeps(deps);var fn;var getResult=()=>currentDeps.map((d=>{if(d[webpackError])throw d[webpackError];return d[webpackExports]}));var promise=new Promise((resolve=>{fn=()=>resolve(getResult);fn.r=0;var fnQueue=q=>q!==queue&&!depQueues.has(q)&&(depQueues.add(q),q&&!q.d&&(fn.r++,q.push(fn)));currentDeps.map((dep=>dep[webpackQueues](fnQueue)))}));return fn.r?promise:getResult()}),(err=>(err?reject(promise[webpackError]=err):outerResolve(exports),resolveQueue(queue))));queue&&queue.d<0&&(queue.d=0)}})();
/* webpack/runtime/define property getters */
(()=>{
// define getter functions for harmony exports
__webpack_require__.d=(exports,definition)=>{for(var key in definition)__webpack_require__.o(definition,key)&&!__webpack_require__.o(exports,key)&&Object.defineProperty(exports,key,{enumerable:true,get:definition[key]})}})();
/* webpack/runtime/hasOwnProperty shorthand */
(()=>{__webpack_require__.o=(obj,prop)=>Object.prototype.hasOwnProperty.call(obj,prop)})();
// startup
// Load entry module and return exports
// This entry module used 'module' so it can't be inlined
__webpack_require__(823)})();